import{x as e,y as t,j as r,B as a,C as i,T as n,h as s,r as o,s as l,G as c,z as d,P as p,E as m,H as h,J as g,K as x,N as u,O as f,Q as y,b,V as j,W as w,Y as k,Z as v,_ as S,$ as C,a as z,a0 as W}from"./vendor-mui-C1GmDdcn.js";import{r as I}from"./vendor-react-EzoxUMNY.js";import{a7 as T}from"./vendor-utils-QXd9EeNt.js";import"./vendor-antd-BB3a0mYC.js";const A="/api";l(z)(({theme:e,cardType:t})=>({borderRadius:16,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"pointer",border:"1px solid",borderColor:"department"===t?e.palette.warning.main:"role"===t?e.palette.primary.main:e.palette.grey[300],backgroundColor:e.palette.background.paper,"&:hover":{transform:"translateY(-4px)",boxShadow:e.shadows[8],borderColor:"department"===t?e.palette.warning.dark:"role"===t?e.palette.primary.dark:e.palette.grey[400]},"&.expanded":{backgroundColor:y("department"===t?e.palette.warning.main:"role"===t?e.palette.primary.main:e.palette.grey[100],.05)}}));const R=l(W)(({theme:e,chipType:t})=>({borderRadius:20,fontWeight:600,backgroundColor:y("users"===t?e.palette.success.main:"roles"===t?e.palette.info.main:e.palette.grey[500],.1),color:"users"===t?e.palette.success.main:"roles"===t?e.palette.info.main:e.palette.grey[700],"& .MuiChip-icon":{color:"inherit"}})),$=l(a)(({theme:e})=>({minHeight:"100vh",height:"100vh",width:"100%",backgroundColor:"#000000",paddingTop:e.spacing(2),paddingBottom:e.spacing(2),paddingLeft:e.spacing(2),paddingRight:e.spacing(2),overflow:"hidden",display:"flex",flexDirection:"column",[e.breakpoints.down("sm")]:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1)}})),D=l(p)(({theme:e})=>({background:`linear-gradient(135deg, ${e.palette.primary.main} 0%, ${e.palette.primary.dark} 100%)`,color:"white",padding:e.spacing(2),borderRadius:16,marginBottom:e.spacing(2),flexShrink:0,[e.breakpoints.down("sm")]:{padding:e.spacing(1.5)}})),B=l(a)(({theme:e})=>({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",gap:e.spacing(1.8),position:"relative",padding:e.spacing(.9),height:"100%",width:"100%",overflow:"auto",transform:"scale(1)",transformOrigin:"center top","&::-webkit-scrollbar":{width:6,height:6},"&::-webkit-scrollbar-track":{background:y(e.palette.grey[300],.2),borderRadius:3},"&::-webkit-scrollbar-thumb":{background:y(e.palette.primary.main,.3),borderRadius:3,"&:hover":{background:y(e.palette.primary.main,.5)}},[e.breakpoints.down("md")]:{transform:"scale(0.9)",gap:e.spacing(1.35),padding:e.spacing(.9)},[e.breakpoints.down("sm")]:{transform:"scale(0.8)",gap:e.spacing(1.08),padding:e.spacing(.45)}})),_=l(a)(({theme:e})=>({display:"flex",justifyContent:"center",alignItems:"flex-start",gap:e.spacing(1.35),width:"100%",minWidth:"max-content",position:"relative",flexWrap:"nowrap",[e.breakpoints.down("md")]:{gap:e.spacing(1.08),flexWrap:"wrap"},[e.breakpoints.down("sm")]:{gap:e.spacing(.9),justifyContent:"center",flexWrap:"wrap"}})),P=l(a)(({theme:e})=>({display:"flex",flexDirection:"column",alignItems:"center",position:"relative",minWidth:"max-content","&::before":{content:'""',position:"absolute",top:-24,left:"50%",transform:"translateX(-50%)",width:2,height:24,background:`linear-gradient(180deg, ${y(e.palette.primary.main,.4)} 0%, ${y(e.palette.primary.main,.6)} 100%)`,borderRadius:1,zIndex:1},"&:first-of-type::before":{display:"none"}})),H=l(a)(({theme:e})=>({position:"absolute",top:-12,left:"0%",right:"0%",height:2,background:`linear-gradient(90deg, ${y(e.palette.primary.main,.4)} 0%, ${y(e.palette.primary.main,.6)} 50%, ${y(e.palette.primary.main,.4)} 100%)`,borderRadius:1,zIndex:0,"&::before":{content:'""',position:"absolute",top:-11,left:"50%",transform:"translateX(-50%)",width:2,height:12,background:`linear-gradient(180deg, ${y(e.palette.primary.main,.6)} 0%, ${y(e.palette.primary.main,.4)} 100%)`,borderRadius:1,zIndex:1}})),E=l(a)(({theme:e,isRoot:t=!1})=>({display:"flex",flexDirection:"column",alignItems:"center",position:"relative",marginBottom:e.spacing(1.5),minWidth:t?162:144,maxWidth:t?198:180,[e.breakpoints.down("md")]:{minWidth:t?144:126,maxWidth:t?180:162},[e.breakpoints.down("sm")]:{minWidth:t?126:108,maxWidth:t?162:144}})),N=l(z)(({theme:e,nodeType:t,isExpanded:r,isRoot:a=!1})=>({borderRadius:6,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"pointer",border:"2px solid",borderColor:"department"===t?e.palette.warning.main:"role"===t?e.palette.primary.main:"user"===t?e.palette.success.main:e.palette.grey[300],backgroundColor:r?y("department"===t?e.palette.warning.main:"role"===t?e.palette.primary.main:"user"===t?e.palette.success.main:e.palette.grey[100],.08):e.palette.background.paper,boxShadow:r?e.shadows[4]:e.shadows[1],width:"100%",minHeight:a?75:65,"&:hover":{transform:"translateY(-1px) scale(1.02)",boxShadow:e.shadows[6],borderColor:"department"===t?e.palette.warning.dark:"role"===t?e.palette.primary.dark:"user"===t?e.palette.success.dark:e.palette.grey[400]},zIndex:3,position:"relative",...a&&{"&::before":{content:'""',position:"absolute",top:-1,left:-1,right:-1,bottom:-1,borderRadius:8,background:`linear-gradient(45deg, ${y("department"===t?e.palette.warning.main:e.palette.primary.main,.2)}, ${y("department"===t?e.palette.warning.main:e.palette.primary.main,.1)})`,zIndex:-1,opacity:r?1:.5,transition:"opacity 0.3s ease"}}})),F=l(a)(({theme:e})=>({display:"flex",flexWrap:"wrap",justifyContent:"center",gap:e.spacing(1.35),marginTop:e.spacing(1.8),marginBottom:e.spacing(1.8),padding:e.spacing(2.25),borderRadius:12,backgroundColor:y(e.palette.grey[100],.7),border:`2px dashed ${y(e.palette.grey[400],.8)}`,[e.breakpoints.down("sm")]:{gap:e.spacing(1.08),padding:e.spacing(1.8)}})),M=()=>{const l=e(),z=t(l.breakpoints.down("sm"));t(l.breakpoints.down("md"));const[W,M]=I.useState(2),[O,Y]=I.useState(!0),[L,U]=I.useState([]),[q,G]=I.useState([]),[J,X]=I.useState([]),[K,Q]=I.useState({}),[V,Z]=I.useState(null),[ee,te]=I.useState({}),[re,ae]=I.useState({}),[ie,ne]=I.useState(!0),[se,oe]=I.useState(null),le=localStorage.getItem("userId"),ce=()=>{if(!re)return!1;if("*"===re.pages&&"*"===re.actions)return!0;if("*"===re.Global||"*"===re.global||"*"===re["*"])return!0;if(Array.isArray(re))for(const s of re)if(s&&s.page){if("Charts"===s.page||"charts"===s.page){if("*"===s.actions)return!0;if(Array.isArray(s.actions)&&(s.actions.includes("*")||s.actions.includes("show")))return!0;if("show"===s.actions)return!0}if(("*"===s.page||"any"===s.page||"Global"===s.page)&&("*"===s.actions||Array.isArray(s.actions)&&(s.actions.includes("*")||s.actions.includes("show"))))return!0}const e=re.Charts,t=re.charts;if("*"===e||"*"===t)return!0;const r=Array.isArray(e)&&e.includes("show"),a=Array.isArray(t)&&t.includes("show"),i="object"==typeof e&&!Array.isArray(e)&&!0===e?.show,n="object"==typeof t&&!Array.isArray(t)&&!0===t?.show;return r||a||i||n},de=async()=>{ne(!0),oe(null);try{if(!le)throw new Error("User ID is required to load permissions");const t=localStorage.getItem("userPermissions");if(t)try{const e=JSON.parse(t);return ae(e),void ne(!1)}catch(e){localStorage.removeItem("userPermissions")}const r=await T.get(`${A}/users/permissions/${le}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});let a;Array.isArray(r.data)?a=r.data:Array.isArray(r.data.permissions)||r.data.permissions&&"object"==typeof r.data.permissions?a=r.data.permissions:r.data.role&&r.data.role.permissions?a=r.data.role.permissions:r.data.message&&!r.data.permissions?(a=[],oe(`Permission issue: ${r.data.message}`)):a=r.data,localStorage.setItem("userPermissions",JSON.stringify(a)),ae(a)}catch(t){oe(t.message||"Failed to load permissions. Please try again.")}finally{ne(!1)}};I.useEffect(()=>{de()},[le]),I.useEffect(()=>{!ie&&ce()?pe():ie||ce()||Y(!1)},[W,ie,re]);const pe=async()=>{Y(!0),Z(null);try{switch(W){case 0:await me();break;case 1:await he();break;default:await ge()}}catch(e){401===e.response?.status||403===e.response?.status?Z("You don't have permission to access this data. Please contact your administrator."):404===e.response?.status?Z("The requested data could not be found. You may need to create sample data first."):"string"==typeof e.message&&e.message.includes("Network")?Z("Network error. Please check your internet connection and try again."):Z(e.response?.data?.message||e.message||"Failed to load organization data. Please try again.")}finally{Y(!1)}},me=async()=>{try{const e=await T.get(`${A}/charts/department-hierarchy?user_id=${le}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(!e.data)throw new Error("No data received from server");U(e.data.departments||[]),te(e.data.summary||{})}catch(e){throw new Error(e.response?.data?.message||e.response?.data?.detail||"Failed to load department hierarchy. Please check your connection.")}},he=async()=>{try{const e=await T.get(`${A}/charts/role-hierarchy?user_id=${le}&include_users=true`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(!e.data)throw new Error("No data received from server");G(e.data.roles||[]),te(e.data.summary||{})}catch(e){throw new Error(e.response?.data?.message||e.response?.data?.detail||"Failed to load role hierarchy. Please check your connection.")}},ge=async()=>{try{const e=await T.get(`${A}/charts/organization-structure?user_id=${le}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(!e.data)throw new Error("No data received from server");X(e.data.organization||[]),te(e.data.summary||{})}catch(e){throw new Error(e.response?.data?.message||e.response?.data?.detail||"Failed to load organization structure. Please check your connection.")}},xe=async()=>{try{if(Y(!0),Z(null),!le)throw new Error("User ID is required to create sample data. Please log in again.");const e=await T.post(`${A}/charts/create-sample-data?user_id=${le}`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(!e.data.success)throw new Error(e.data.message||"Unknown error creating sample data");await pe()}catch(e){401===e.response?.status||403===e.response?.status?Z("Permission denied. You need admin privileges to create sample data."):"string"==typeof e.message&&e.message.includes("Network")?Z("Network error while creating sample data. Please check your internet connection."):Z(e.response?.data?.message||e.message||"Failed to create sample data. You may need admin permissions.")}finally{Y(!1)}},ue=e=>{Q(t=>({...t,[e]:!t[e]}))},fe=(e,t=!1)=>{const i=K[e._id],s=e.children?.filter(e=>"user"===e.type)||[],o=e.children?.filter(e=>"role"===e.type)||[],c=s.length>0||o.length>0;return r.jsx(P,{children:r.jsxs(a,{sx:{minWidth:t?240:220,maxWidth:t?300:280,display:"flex",flexDirection:"column",alignItems:"center",position:"relative",marginBottom:1.5},children:[r.jsx(N,{nodeType:"role",isExpanded:i,isRoot:t,onClick:()=>c&&ue(e._id),sx:{cursor:c?"pointer":"default",width:"100%",minHeight:t?75:65},children:r.jsx(b,{sx:{p:t?2:1.5},children:r.jsxs(a,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[r.jsxs(a,{display:"flex",alignItems:"center",gap:1.5,flex:1,minWidth:0,children:[r.jsx(j,{sx:{bgcolor:l.palette.primary.main,width:t?36:32,height:t?36:32,fontWeight:"bold"},children:r.jsx(x,{fontSize:t?"medium":"small"})}),r.jsxs(a,{flex:1,minWidth:0,children:[r.jsx(n,{variant:"caption",fontWeight:"800",sx:{lineHeight:1.4,fontSize:t?"0.95rem":"0.85rem",display:"block",mb:.4,color:"text.primary",wordBreak:"break-word"},children:e.name}),e.description&&r.jsx(n,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem",lineHeight:1.3,display:"block",mb:.3,fontWeight:500,wordBreak:"break-word",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"normal"},children:e.description}),t&&r.jsx(n,{variant:"caption",color:"primary",sx:{fontWeight:700,fontSize:"0.75rem",lineHeight:1.3,display:"block",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Root Role"})]})]}),r.jsxs(d,{direction:"row",spacing:1,alignItems:"center",children:[s.length>0&&r.jsx(R,{chipType:"users",icon:r.jsx(w,{fontSize:"small"}),label:s.length,size:"small",sx:{height:20,fontSize:"0.7rem",fontWeight:600,"& .MuiChip-label":{px:1}}}),o.length>0&&r.jsx(R,{chipType:"roles",icon:r.jsx(x,{fontSize:"small"}),label:o.length,size:"small",sx:{height:20,fontSize:"0.7rem",fontWeight:600,"& .MuiChip-label":{px:1}}}),c&&r.jsx(k,{size:"small",sx:{p:.3},children:i?r.jsx(v,{fontSize:"small"}):r.jsx(S,{fontSize:"small"})})]})]})})}),r.jsx(C,{in:i,children:r.jsxs(a,{sx:{mt:2,width:"100%"},children:[s.length>0&&r.jsxs(a,{sx:{mb:2},children:[r.jsxs(n,{variant:"caption",color:"text.secondary",sx:{mb:2,textAlign:"center",fontWeight:700,fontSize:"0.75rem",display:"block",textTransform:"uppercase",letterSpacing:"0.5px",borderBottom:"1px solid",borderColor:"divider",pb:.5},children:["Team Members (",s.length,")"]}),r.jsx(F,{children:s.map(e=>(e=>r.jsx(a,{sx:{minWidth:126,maxWidth:144,mb:.8},children:r.jsx(N,{nodeType:"user",isExpanded:!1,sx:{cursor:"default"},children:r.jsx(b,{sx:{p:1.5,"&:last-child":{pb:1.5}},children:r.jsxs(a,{display:"flex",alignItems:"center",gap:1.5,children:[r.jsx(j,{sx:{bgcolor:l.palette.success.main,width:32,height:32,fontSize:"0.9rem",fontWeight:"bold"},children:e.name?e.name.charAt(0).toUpperCase():r.jsx(w,{fontSize:"small"})}),r.jsxs(a,{flex:1,minWidth:0,children:[r.jsx(n,{variant:"caption",fontWeight:"700",noWrap:!0,color:"text.primary",sx:{fontSize:"0.8rem",lineHeight:1.2,display:"block",mb:.3},children:e.name||"Unnamed User"}),e.email&&r.jsx(n,{variant:"caption",color:"text.secondary",noWrap:!0,sx:{fontSize:"0.65rem",display:"block",lineHeight:1.1,mb:.2,fontWeight:500},children:e.email}),e.job_title&&r.jsx(n,{variant:"caption",color:"text.secondary",noWrap:!0,sx:{fontSize:"0.65rem",display:"block",lineHeight:1.1,fontStyle:"italic",fontWeight:400},children:e.job_title})]})]})})})},e._id))(e))})]}),o.length>0&&r.jsxs(a,{children:[r.jsxs(n,{variant:"caption",color:"text.secondary",sx:{mb:2,textAlign:"center",fontWeight:700,fontSize:"0.75rem",display:"block",textTransform:"uppercase",letterSpacing:"0.5px",borderBottom:"1px solid",borderColor:"divider",pb:.5},children:["Sub-Roles (",o.length,")"]}),r.jsxs(_,{children:[o.length>1&&r.jsx(H,{}),o.map(e=>fe(e,!1))]})]})]})})]})},e._id)},ye=(e,t=!1)=>{const i=K[e._id],s=e.children?.filter(e=>"department"===e.type)||[],o=e.children?.filter(e=>"role"===e.type)||[],c=s.length>0||o.length>0;return r.jsx(P,{children:r.jsxs(E,{isRoot:t,children:[r.jsx(N,{nodeType:"department",isExpanded:i,isRoot:t,onClick:()=>c&&ue(e._id),sx:{cursor:c?"pointer":"default"},children:r.jsx(b,{sx:{p:t?2:1.5},children:r.jsxs(a,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[r.jsxs(a,{display:"flex",alignItems:"center",gap:1.5,flex:1,minWidth:0,children:[r.jsx(j,{sx:{bgcolor:l.palette.warning.main,width:t?36:32,height:t?36:32,fontWeight:"bold"},children:r.jsx(g,{fontSize:t?"medium":"small"})}),r.jsxs(a,{flex:1,minWidth:0,children:[r.jsx(n,{variant:"caption",fontWeight:"800",noWrap:!0,sx:{lineHeight:1.3,fontSize:t?"0.9rem":"0.8rem",display:"block",mb:.3,color:"text.primary"},children:e.name}),e.description&&r.jsx(n,{variant:"caption",color:"text.secondary",noWrap:!0,sx:{fontSize:"0.7rem",lineHeight:1.2,display:"block",mb:.2,fontWeight:500},children:e.description}),r.jsx(n,{variant:"caption",color:"warning.main",sx:{fontWeight:700,fontSize:"0.7rem",lineHeight:1.2,display:"block",textTransform:"uppercase",letterSpacing:"0.5px"},children:t?"Root Department":"Sub-Department"})]})]}),r.jsxs(d,{direction:"row",spacing:1,alignItems:"center",children:[e.user_count>0&&r.jsx(R,{chipType:"users",icon:r.jsx(w,{fontSize:"small"}),label:`${e.user_count}`,size:"small",sx:{height:20,fontSize:"0.7rem",fontWeight:600,"& .MuiChip-label":{px:1}}}),e.role_count>0&&r.jsx(R,{chipType:"roles",icon:r.jsx(x,{fontSize:"small"}),label:`${e.role_count}`,size:"small",sx:{height:20,fontSize:"0.7rem",fontWeight:600,"& .MuiChip-label":{px:1}}}),s.length>0&&r.jsx(R,{chipType:"departments",icon:r.jsx(g,{fontSize:"small"}),label:`${s.length}`,size:"small",sx:{backgroundColor:y(l.palette.warning.main,.1),color:l.palette.warning.main,height:20,fontSize:"0.7rem",fontWeight:600,"& .MuiChip-label":{px:1}}}),c&&r.jsx(k,{size:"small",sx:{p:.3},children:i?r.jsx(v,{fontSize:"small"}):r.jsx(S,{fontSize:"small"})})]})]})})}),r.jsx(C,{in:i,children:r.jsxs(a,{sx:{mt:2,width:"100%"},children:[o.length>0&&r.jsxs(a,{sx:{mb:2},children:[r.jsxs(n,{variant:"caption",color:"text.secondary",sx:{mb:2,textAlign:"center",fontWeight:700,fontSize:"0.75rem",display:"block",textTransform:"uppercase",letterSpacing:"0.5px",borderBottom:"1px solid",borderColor:"divider",pb:.5},children:["Department Roles (",o.length,")"]}),r.jsxs(_,{children:[o.length>1&&r.jsx(H,{}),o.map(e=>fe(e,!1))]})]}),s.length>0&&r.jsxs(a,{children:[r.jsxs(n,{variant:"caption",color:"text.secondary",sx:{mb:2,textAlign:"center",fontWeight:700,fontSize:"0.75rem",display:"block",textTransform:"uppercase",letterSpacing:"0.5px",borderBottom:"1px solid",borderColor:"divider",pb:.5},children:["Sub-Departments (",s.length,")"]}),r.jsxs(_,{children:[s.length>1&&r.jsx(H,{}),s.map(e=>ye(e,!1))]})]})]})})]})},e._id)};return ie?r.jsxs(a,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",sx:{backgroundColor:"#000000"},children:[r.jsx(i,{size:60,sx:{mb:2,color:"white"}}),r.jsx(n,{variant:"h6",color:"white",children:"Loading permissions..."})]}):se?r.jsxs(a,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",sx:{backgroundColor:"#000000"},children:[r.jsx(n,{variant:"h4",color:"white",gutterBottom:!0,children:"Permission Error"}),r.jsx(n,{variant:"body1",color:"grey.300",sx:{mb:3,maxWidth:"600px",textAlign:"center"},children:se}),r.jsx(s,{variant:"contained",color:"primary",onClick:()=>de(),startIcon:r.jsx(o,{}),children:"Retry Loading Permissions"})]}):ce()?r.jsxs($,{children:[r.jsx(D,{elevation:0,children:r.jsxs(c,{container:!0,alignItems:"center",justifyContent:"space-between",spacing:2,children:[r.jsxs(c,{item:!0,xs:12,md:8,children:[r.jsx(n,{variant:z?"h5":"h4",fontWeight:"700",gutterBottom:!0,children:"Organization Family Tree"}),r.jsx(n,{variant:"body1",sx:{opacity:.9},children:"Interactive family tree view of departments, roles, and team members with expandable hierarchy"})]}),r.jsx(c,{item:!0,xs:12,md:4,display:"flex",justifyContent:z?"flex-start":"flex-end",children:r.jsx(d,{direction:"row",spacing:2,alignItems:"center",children:Object.keys(ee).length>0&&r.jsxs(a,{textAlign:"center",children:[r.jsx(n,{variant:"h6",fontWeight:"700",children:ee.total_departments||ee.total_roles||ee.total_users||0}),r.jsx(n,{variant:"caption",sx:{opacity:.8},children:0===W?"Departments":1===W?"Roles":"Total Nodes"})]})})})]})}),r.jsx(p,{elevation:1,sx:{borderRadius:2,mb:2,bgcolor:"#000000",border:"1px solid #333",flexShrink:0},children:r.jsx(a,{sx:{borderBottom:1,borderColor:"#333"},children:r.jsxs(m,{value:W,onChange:(e,t)=>{M(t),Q({})},variant:z?"fullWidth":"standard",centered:!z,sx:{"& .MuiTab-root":{minHeight:40,textTransform:"none",fontWeight:600,fontSize:"0.85rem",color:"white","&.Mui-selected":{color:"#1976d2"}},"& .MuiTabs-indicator":{backgroundColor:"#1976d2"}},children:[r.jsx(h,{icon:r.jsx(g,{}),label:"Department Tree",iconPosition:"start"}),r.jsx(h,{icon:r.jsx(x,{}),label:"Role Tree",iconPosition:"start"}),r.jsx(h,{icon:r.jsx(u,{}),label:"Organization Tree",iconPosition:"start"})]})})}),V&&r.jsx(p,{sx:{p:2,mb:2,bgcolor:"error.light",color:"error.contrastText",borderRadius:2,flexShrink:0},children:r.jsxs(a,{display:"flex",flexDirection:z?"column":"row",alignItems:"center",justifyContent:"space-between",children:[r.jsxs(a,{children:[r.jsx(n,{variant:"h6",sx:{mb:1,fontWeight:500},children:"Error Loading Chart Data"}),r.jsx(n,{variant:"body1",sx:{mb:2},children:V})]}),r.jsxs(d,{direction:z?"column":"row",spacing:2,children:[r.jsx(s,{variant:"contained",color:"primary",onClick:pe,startIcon:r.jsx(o,{}),sx:{mt:z?2:0},children:"Try Again"}),r.jsx(s,{variant:"outlined",color:"secondary",onClick:xe,startIcon:r.jsx(f,{}),sx:{mt:z?1:0},children:"Create Sample Data"})]})]})}),r.jsx(p,{elevation:1,sx:{borderRadius:2,overflow:"hidden",bgcolor:"#000000",border:"1px solid #333",flex:1,minHeight:0},children:r.jsx(a,{sx:{p:1,height:"100%",display:"flex",flexDirection:"column"},children:O?r.jsxs(a,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1,children:[r.jsx(i,{size:60,sx:{mb:2,color:"white"}}),r.jsx(n,{variant:"h6",color:"white",children:"Loading organization data..."})]}):r.jsxs(a,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[r.jsxs(a,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,sx:{flexShrink:0},children:[r.jsx(n,{variant:"subtitle1",color:"white",children:0===W?"Department Family Tree":1===W?"Role Family Tree":"Complete Organization Family Tree"}),r.jsx(s,{variant:"outlined",onClick:pe,startIcon:r.jsx(o,{}),size:"small",sx:{borderColor:"white",color:"white","&:hover":{borderColor:"#ccc",backgroundColor:"rgba(255,255,255,0.1)"}},children:"Refresh"})]}),r.jsx(a,{sx:{flex:1,minHeight:0},children:(()=>{const e=(()=>{switch(W){case 0:return L;case 1:return q;case 2:return J;default:return[]}})();if(!e||0===e.length){const e=()=>{switch(W){case 0:return{title:"No Department Data Found",message:"There are no departments defined in the system yet. Create sample data or ask your administrator to add departments."};case 1:return{title:"No Role Data Found",message:"There are no roles defined in the system yet. Create sample data or ask your administrator to add roles."};case 2:return{title:"No Organization Structure Found",message:"The organization structure hasn't been defined yet. Create sample data to see how it works."};default:return{title:"No Data Available",message:"No chart data is available for this view."}}},{title:t,message:i}=e();return r.jsxs(a,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"400px",textAlign:"center",px:3,children:[r.jsx(f,{sx:{fontSize:64,color:"white",mb:2,opacity:.8}}),r.jsx(n,{variant:"h5",color:"white",fontWeight:"500",gutterBottom:!0,children:t}),r.jsx(n,{variant:"body1",color:"rgba(255,255,255,0.7)",mb:4,maxWidth:"600px",children:i}),r.jsxs(d,{direction:z?"column":"row",spacing:2,children:[r.jsx(s,{variant:"contained",onClick:pe,startIcon:r.jsx(o,{}),size:"large",children:"Refresh Data"}),r.jsx(s,{variant:"outlined",onClick:xe,startIcon:r.jsx(f,{}),color:"warning",size:"large",sx:{mt:z?1:0},children:"Create Sample Data"})]})]})}return r.jsx(B,{children:r.jsxs(_,{children:[e.length>1&&r.jsx(H,{}),0===W&&e.map(e=>ye(e,!0)),1===W&&e.map(e=>fe(e,!0)),2===W&&e.map(e=>ye(e,!0))]})})})()})]})})})]}):r.jsxs(a,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",sx:{backgroundColor:"#000000"},children:[r.jsx(n,{variant:"h4",color:"white",gutterBottom:!0,children:"Access Denied"}),r.jsx(n,{variant:"body1",color:"grey.300",sx:{mb:3},children:"You don't have permission to view charts."}),r.jsx(s,{variant:"outlined",color:"primary",onClick:()=>de(),startIcon:r.jsx(o,{}),children:"Refresh Permissions"})]})};export{M as default};
