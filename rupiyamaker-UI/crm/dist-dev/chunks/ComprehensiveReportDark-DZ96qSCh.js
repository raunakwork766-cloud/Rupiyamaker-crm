import{j as e}from"./vendor-mui-C1GmDdcn.js";import{r as t}from"./vendor-react-EzoxUMNY.js";import{u as a,w as n}from"./vendor-office-CbbGW2MO.js";import{s,d as o,E as r,G as i,w as l,x as d,H as c,J as p,K as m,L as h,N as u,e as g,I as y,y as x,B as _,O as b,P as f,Q as j,U as k,S as w,o as v,g as S,V as A,W as I,M as C,k as D,X as $,u as L,r as T,Y as z,Z as R,$ as N,a0 as E,z as Y,v as O,a1 as P}from"./vendor-antd-BB3a0mYC.js";import{c as W,d as B,h as M}from"./employee-components-B8JBcnzi.js";import{a7 as F}from"./vendor-utils-QXd9EeNt.js";import"./lead-components-DjdRUJ-t.js";const H=()=>{const e=localStorage.getItem("userId")||localStorage.getItem("user_id")||(()=>{try{return JSON.parse(localStorage.getItem("userData")||"{}").user_id}catch{return null}})();if(!e)throw new Error("User not authenticated");return e},U=async e=>{const t=H();try{return{data:await W(`/leads/${e}?user_id=${t}`,{method:"GET"}),success:!0}}catch(a){return{data:null,success:!1,error:a.message}}},{RangePicker:G}=u,{Option:K}=g,{Search:V}=y,J="https://156.67.111.95:8049",Q=()=>{const u=[{key:"leads",label:"PLOD Leads",icon:e.jsx(D,{})},{key:"login-leads",label:"Login Leads",icon:e.jsx(p,{})},{key:"tasks",label:"Tasks",icon:e.jsx(m,{})},{key:"tickets",label:"Tickets",icon:e.jsx($,{})},{key:"attendance",label:"Attendance",icon:e.jsx(L,{})},{key:"employees",label:"Employees",icon:e.jsx(T,{})},{key:"leaves",label:"Leaves",icon:e.jsx(h,{})}],[y,B]=t.useState("leads"),[Q,Z]=t.useState(!1),[X,q]=t.useState([]),[ee,te]=t.useState([]),[ae,ne]=t.useState([]),[se,oe]=t.useState([]),[re,ie]=t.useState([]),[le,de]=t.useState(!1),[ce,pe]=t.useState(null),[me,he]=t.useState("about"),[ue,ge]=t.useState(!1),[ye,xe]=t.useState({dateRange:null,searchText:"",status:null}),[_e,be]=t.useState({total:0,active:0,completed:0,pending:0});t.useEffect(()=>{je()},[]),t.useEffect(()=>{ae.length>0&&ke()},[y,ae]),t.useEffect(()=>{we()},[ye,X]),t.useEffect(()=>{ve()},[ee]);const fe=e=>{if(!e||!ae||0===ae.length)return"Unknown";const t=ae.find(t=>t._id&&t._id===e||t.id&&t.id===e||t._id&&t._id.$oid===e);return t&&(`${t.first_name||""} ${t.last_name||""}`.trim()||t.name||t.username)||"Unknown"},je=async()=>{try{const e=await M.getAllEmployees();e.success&&e.data&&ne(Array.isArray(e.data)?e.data:[])}catch(e){s.error("Failed to fetch users")}},ke=async()=>{Z(!0);try{let t=[];switch(y){case"leads":{const e=await(async(e={})=>{const t=H();try{const a=new URLSearchParams;return a.append("user_id",t),e.status&&a.append("status",e.status),e.department_id&&a.append("department_id",e.department_id),e.assigned_to&&a.append("assigned_to",e.assigned_to),e.loan_type_id&&a.append("loan_type_id",e.loan_type_id),e.priority&&a.append("priority",e.priority),e.date_from&&a.append("date_from",e.date_from),e.date_to&&a.append("date_to",e.date_to),{data:await W(`/leads?${a.toString()}`,{method:"GET"}),success:!0}}catch(a){return{data:[],success:!1,error:a.message}}})();e.success&&(t=Array.isArray(e.data)?e.data:e.data.items?e.data.items:[]);break}case"login-leads":{const a=localStorage.getItem("userId"),n=localStorage.getItem("token");try{const e=await F.get("/api/lead-login/login-department-leads",{headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},params:{user_id:a}});t=e.data?.leads||[]}catch(e){t=[]}break}case"employees":{const e=await M.getAllEmployees();t=e.success&&Array.isArray(e.data)?e.data:[];break}case"tasks":t=(await F.get(`${J}/api/tasks`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).data.data||[];break;case"tickets":t=(await F.get(`${J}/api/tickets`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).data.data||[];break;case"attendance":t=(await F.get(`${J}/api/attendance`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).data.data||[];break;case"leaves":t=(await F.get(`${J}/api/leaves`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).data.data||[];break;default:t=[]}q(t),te(t)}catch(t){s.error(`Failed to fetch ${y} data`),q([]),te([])}finally{Z(!1)}},we=()=>{if(!Array.isArray(X))return void te([]);let e=[...X];if(ye.dateRange&&2===ye.dateRange.length){const[t,a]=ye.dateRange;e=e.filter(e=>{const n=o(e.created_date||e.created_at||e.date);return n.isAfter(t.startOf("day"))&&n.isBefore(a.endOf("day"))})}if(ye.status&&(e=e.filter(e=>{const t=(e.status||"").toLowerCase();return t===ye.status.toLowerCase()||t.includes(ye.status.toLowerCase())})),ye.searchText){const t=ye.searchText.toLowerCase();e=e.filter(e=>Object.values(e).some(e=>e&&e.toString().toLowerCase().includes(t)))}te(e)},ve=()=>{if(!Array.isArray(ee))return void be({total:0,active:0,completed:0,pending:0});const e=ee.length;let t=0,a=0,n=0;ee.forEach(e=>{const s=(e.status||"").toLowerCase();s.includes("active")||s.includes("approved")||s.includes("won")?t++:s.includes("completed")||s.includes("closed")||s.includes("disbursed")?a++:(s.includes("pending")||s.includes("progress"))&&n++}),be({total:e,active:t,completed:a,pending:n})},Se=e=>{"leads"!==y&&"login-leads"!==y||(pe(e),de(!0),he("about"),Ae(e._id?.$oid||e._id))},Ae=async e=>{ge(!0);try{const t=await U(e);t.success&&pe(t.data)}catch(t){s.error("Failed to fetch lead details")}finally{ge(!1)}},Ie=e=>e.replace(/_/g," ").replace(/([A-Z])/g," $1").trim(),Ce=()=>{xe({dateRange:null,searchText:"",status:null}),oe([]),ie([])},De=e=>{if(!e)return"default";const t=e.toLowerCase();return t.includes("active")||t.includes("new")?"blue":t.includes("pending")||t.includes("progress")?"orange":t.includes("completed")||t.includes("closed")?"green":t.includes("rejected")||t.includes("failed")?"red":"default"},$e={selectedRowKeys:re,onChange:(e,t)=>{ie(e),oe(t)},getCheckboxProps:e=>({disabled:!1})},Le=e.jsx(r,{selectedKeys:[y],onClick:({key:e})=>{B(e),Ce()},style:{background:"#1f2937",border:"1px solid #374151"},children:u.map(t=>e.jsx(r.Item,{icon:t.icon,style:{color:"#e5e7eb"},children:t.label},t.key))});return e.jsxs("div",{style:{padding:"12px",backgroundColor:"#0f0f14",minHeight:"100vh",color:"#e5e7eb"},children:[e.jsx("style",{children:"\n                .ant-table-thead > tr > th { background: #1f2937 !important; color: #e5e7eb !important; border-bottom:1px solid #374151 !important; padding: 5px 6px !important; font-size: 11px !important; }\n                .ant-table-tbody > tr > td { background: #0f0f14 !important; color: #cbd5e1 !important; border-bottom:1px solid #1f2937 !important; padding: 5px 6px !important; font-size: 11px !important; }\n                .ant-table-tbody > tr:hover > td { background: #1f2937 !important; cursor: pointer; }\n                .ant-card { background: #111827 !important; border: 1px solid #1f2937 !important; }\n                .ant-card-head { background: #1f2937 !important; border-bottom: 1px solid #374151 !important; padding: 10px 12px !important; }\n                .ant-card-body { padding: 12px !important; }\n                .ant-card-head-title { font-size: 13px !important; }\n                .ant-statistic-title { font-size: 11px !important; }\n                .ant-statistic-content { font-size: 18px !important; }\n                .ant-descriptions-item-label { background: #1f2937 !important; color: #9ca3af !important; padding: 4px !important; font-size: 11px !important; }\n                .ant-descriptions-item-content { background: #0f0f14 !important; color: #e5e7eb !important; padding: 4px !important; font-size: 11px !important; }\n                .ant-modal-content { background: #111827 !important; }\n                .ant-modal-header { background: #1f2937 !important; border-bottom: 1px solid #374151 !important; padding: 10px 12px !important; }\n                .ant-modal-title { font-size: 13px !important; }\n                .ant-modal-body { padding: 12px !important; }\n                .ant-tabs-tab { color: #9ca3af !important; font-size: 11px !important; padding: 6px 10px !important; }\n                .ant-tabs-tab-active { color: #667eea !important; }\n                .ant-tabs-ink-bar { background: #667eea !important; }\n                .ant-btn { font-size: 11px !important; padding: 3px 10px !important; height: 26px !important; }\n                .ant-btn-sm { font-size: 10px !important; padding: 2px 8px !important; height: 24px !important; }\n                .ant-input { font-size: 11px !important; padding: 3px 6px !important; }\n                .ant-select { font-size: 11px !important; }\n                .ant-tag { font-size: 10px !important; padding: 2px 5px !important; }\n                ::-webkit-scrollbar { width: 6px; height: 6px; }\n                ::-webkit-scrollbar-track { background: #0f0f14; }\n                ::-webkit-scrollbar-thumb { background: #374151; border-radius: 3px; }\n            "}),e.jsxs(i,{title:e.jsxs("span",{style:{fontSize:"14px",fontWeight:600,color:"#f3f4f6"},children:[e.jsx(p,{style:{marginRight:6,color:"#667eea",fontSize:"13px"}}),"Comprehensive Reports"]}),extra:e.jsxs(S,{size:"small",children:[e.jsx(A,{overlay:Le,trigger:["click"],children:e.jsx(_,{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderColor:"#667eea",color:"white",fontWeight:500},children:e.jsxs(S,{size:"small",children:[u.find(e=>e.key===y)?.icon," ",u.find(e=>e.key===y)?.label," ",e.jsx(I,{})]})})}),e.jsx(_,{icon:e.jsx(b,{}),onClick:ke,loading:Q,style:{background:"rgba(16, 185, 129, 0.2)",borderColor:"#10b981",color:"#10b981"},children:"Refresh"})]}),style:{borderRadius:"6px",boxShadow:"0 6px 24px rgba(0, 0, 0, 0.4)",border:"1px solid #1f2937"},children:[e.jsxs(l,{gutter:[8,8],style:{marginBottom:12},children:[e.jsx(d,{xs:24,sm:12,lg:6,children:e.jsx(i,{bordered:!1,style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"8px"},children:e.jsx(c,{title:e.jsx("span",{style:{color:"rgba(255,255,255,0.9)"},children:"Total Records"}),value:_e.total,prefix:e.jsx(p,{}),valueStyle:{color:"white",fontWeight:"bold"}})})}),e.jsx(d,{xs:24,sm:12,lg:6,children:e.jsx(i,{bordered:!1,style:{background:"linear-gradient(135deg, #667eea 0%, #1d4ed8 100%)",borderRadius:"8px"},children:e.jsx(c,{title:e.jsx("span",{style:{color:"rgba(255,255,255,0.9)"},children:"Active/Approved"}),value:_e.active,prefix:e.jsx(m,{}),valueStyle:{color:"white",fontWeight:"bold"}})})}),e.jsx(d,{xs:24,sm:12,lg:6,children:e.jsx(i,{bordered:!1,style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",borderRadius:"8px"},children:e.jsx(c,{title:e.jsx("span",{style:{color:"rgba(255,255,255,0.9)"},children:"Completed"}),value:_e.completed,prefix:e.jsx(m,{}),valueStyle:{color:"white",fontWeight:"bold"}})})}),e.jsx(d,{xs:24,sm:12,lg:6,children:e.jsx(i,{bordered:!1,style:{background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",borderRadius:"8px"},children:e.jsx(c,{title:e.jsx("span",{style:{color:"rgba(255,255,255,0.9)"},children:"Pending"}),value:_e.pending,prefix:e.jsx(h,{}),valueStyle:{color:"white",fontWeight:"bold"}})})})]}),e.jsx(i,{title:e.jsxs("span",{style:{fontWeight:600,color:"#e5e7eb",fontSize:"13px"},children:[e.jsx(k,{})," Filters & Export"]}),style:{marginBottom:12,border:"1px solid #1f2937"},children:e.jsxs(l,{gutter:[8,8],children:[e.jsx(d,{xs:24,sm:12,md:8,lg:6,children:e.jsx(G,{style:{width:"100%"},value:ye.dateRange,onChange:e=>xe(t=>({...t,dateRange:e})),placeholder:["Start Date","End Date"]})}),e.jsx(d,{xs:24,sm:12,md:8,lg:6,children:e.jsxs(g,{placeholder:"Filter by Status",style:{width:"100%"},value:ye.status,onChange:e=>xe(t=>({...t,status:e})),allowClear:!0,children:[e.jsx(K,{value:"active",children:"Active"}),e.jsx(K,{value:"pending",children:"Pending"}),e.jsx(K,{value:"completed",children:"Completed"}),e.jsx(K,{value:"approved",children:"Approved"}),e.jsx(K,{value:"rejected",children:"Rejected"})]})}),e.jsx(d,{xs:24,sm:12,md:8,lg:6,children:e.jsx(V,{placeholder:"Search...",allowClear:!0,enterButton:!0,prefix:e.jsx(x,{}),onSearch:e=>xe(t=>({...t,searchText:e})),onChange:e=>!e.target.value&&xe(e=>({...e,searchText:""})),style:{width:"100%"}})}),e.jsx(d,{xs:24,sm:12,md:8,lg:6,children:e.jsx(_,{onClick:Ce,style:{width:"100%"},icon:e.jsx(b,{}),children:"Reset Filters"})}),e.jsx(d,{xs:24,sm:12,md:4,children:e.jsxs(_,{type:"primary",icon:e.jsx(f,{}),onClick:async()=>{try{if(!se||0===se.length)return void s.warning("Please select rows to export");Z(!0);const t=a.book_new();if("leads"===y||"login-leads"===y)for(const n of se){const s=n._id?.$oid||n._id;let o=n;try{const e=await U(s);o=e.success?e.data:n}catch(e){}const r=`Lead_${n.custom_lead_id||s}`.slice(0,31),i=[{"Lead ID":o.custom_lead_id||"","First Name":o.first_name||"","Last Name":o.last_name||"","Full Name":`${o.first_name||""} ${o.last_name||""}`.trim(),Email:o.email||"",Phone:o.phone||"",Status:o.status||"","Loan Amount":o.loan_amount||"","Processing Bank":o.processing_bank||"","Assigned To":fe(o.assigned_to),"Created Date":o.created_date||""}],l=o.dynamic_fields?.obligations||[];l.length>0&&(i[0]["Total Obligations"]=l.length,l.forEach((e,t)=>{i[0][`Obligation ${t+1} - Type`]=e.type||"",i[0][`Obligation ${t+1} - Bank`]=e.bank_name||"",i[0][`Obligation ${t+1} - EMI`]=e.emi_amount||"",i[0][`Obligation ${t+1} - Outstanding`]=e.outstanding_amount||""})),i[0].Remarks=o.remarks||"";const d=a.json_to_sheet(i);a.book_append_sheet(t,d,r)}else{const e=se.map(e=>{const t={};return Object.keys(e).forEach(a=>{a.startsWith("_")||(t[Ie(a)]=e[a])}),t}),n=a.json_to_sheet(e);a.book_append_sheet(t,n,y)}const r=`${y}_bulk_${o().format("YYYY-MM-DD_HH-mm")}.xlsx`;n(t,r),s.success(`${se.length} records exported successfully!`)}catch(e){s.error("Failed to export bulk data")}finally{Z(!1)}},disabled:0===se.length,style:{width:"100%",background:se.length>0?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":void 0},children:["Export (",se.length,")"]})}),e.jsx(d,{xs:24,sm:12,md:4,children:e.jsx(_,{icon:e.jsx(j,{}),onClick:()=>{try{if(!ee||0===ee.length)return void s.warning("No data to export");const e=a.book_new();if("leads"===y||"login-leads"===y){const t=ee.map(e=>({"Lead ID":e.custom_lead_id||"","First Name":e.first_name||"","Last Name":e.last_name||"","Full Name":`${e.first_name||""} ${e.last_name||""}`.trim(),Email:e.email||"",Phone:e.phone||"",Status:e.status||"","Loan Amount":e.loan_amount||"","Loan Type":e.loan_type||e.loan_type_name||"","Processing Bank":e.processing_bank||"","Assigned To":fe(e.assigned_to),"Created Date":e.created_date||e.created_at||"",Department:e.department_name||"",Source:e.source||"",Priority:e.priority||""})),n=a.json_to_sheet(t);a.book_append_sheet(e,n,"Leads")}else{const t=ee.map(e=>{const t={};return Object.keys(e).forEach(a=>{a.startsWith("_")||(t[Ie(a)]=e[a])}),t}),n=a.json_to_sheet(t);a.book_append_sheet(e,n,y)}const t=`${y}_all_${o().format("YYYY-MM-DD_HH-mm")}.xlsx`;n(e,t),s.success(`${ee.length} records exported successfully!`)}catch(e){s.error("Failed to export data")}},disabled:0===ee.length,style:{width:"100%",background:ee.length>0?"rgba(16, 185, 129, 0.2)":void 0},children:"Export All"})})]})}),e.jsx(w,{spinning:Q,tip:"Loading data...",size:"large",children:e.jsx("div",{style:{background:"#111827",borderRadius:"4px",padding:"8px",border:"1px solid #1f2937"},children:e.jsx(v,{rowSelection:$e,columns:(()=>{const t=[{title:"Action",key:"action",width:120,fixed:"left",render:(t,r)=>e.jsxs(S,{size:"small",children:[e.jsx(O,{title:"View Details",children:e.jsx(_,{type:"primary",size:"small",icon:e.jsx(P,{}),onClick:e=>{e.stopPropagation(),Se(r)},style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",color:"white"}})}),e.jsx(O,{title:"Export",children:e.jsx(_,{size:"small",icon:e.jsx(j,{}),onClick:e=>{e.stopPropagation(),(async e=>{try{Z(!0);let r={};if("leads"===y||"login-leads"===y){const a=e._id?.$oid||e._id;try{const t=await U(a);r=t.success?t.data:e}catch(t){s.warning("Could not fetch complete details, exporting available data"),r=e}}else r=e;const i=a.book_new();if("leads"===y||"login-leads"===y){const e=r,t=[{"Lead ID":e.custom_lead_id||"","First Name":e.first_name||"","Last Name":e.last_name||"",Email:e.email||"",Phone:e.phone||"",Status:e.status||"","Sub Status":e.sub_status||"",Priority:e.priority||"","Loan Type":e.loan_type||e.loan_type_name||"","Loan Amount":e.loan_amount||"","Loan Eligibility":e.loan_eligibility||"","Processing Bank":e.processing_bank||"",Department:e.department_name||"",Source:e.source||"",Campaign:e.campaign_name||"","Data Code":e.data_code||"",Reference:e.reference||"","Assigned To":fe(e.assigned_to),"Reported To":e.assign_report_to&&e.assign_report_to.length>0?e.assign_report_to.map(e=>fe(e)).join(", "):"","Created By":e.created_by_name||fe(e.created_by),"Created Date":e.created_date||e.created_at||"","Updated Date":e.updated_date||e.updated_at||"","Pincode & City":e.pincode_city||"","Company Name":e.company_name||"","Company Category":e.company_category?.name||e.company_category||"",Salary:e.salary||"","Salary Type":e.salary_type||"","File Sent to Login":e.file_sent_to_login?"Yes":"No","Login Sent Date":e.login_department_sent_date||"","PAN Card":e.pan_card||"","Aadhar Card":e.aadhar_card||"",DOB:e.dob||"",Gender:e.gender||"","Marital Status":e.marital_status||""}],n=a.json_to_sheet(t);a.book_append_sheet(i,n,"About");const s=e.dynamic_fields?.obligations||[];if(s.length>0){const e=s.map((e,t)=>({"#":t+1,Type:e.type||e.obligation_type||"","Bank/NBFC":e.bank_name||e.lender_name||"",Product:e.product||"","Loan Type":e.loan_type||"",EMI:e.emi||"","EMI Amount":e.emi_amount||"","Outstanding Amount":e.outstanding||e.outstanding_amount||"","Total Loan Amount":e.total_loan||"","Tenure (Months)":e.tenure||"","Tenure Left (Months)":e.tenure_left||e.remaining_tenure||"","ROI (%)":e.roi||"","Account Number":e.account_number||"",Action:e.action||"","Bureau Status":e.bureau_status||""})),t=a.json_to_sheet(e);a.book_append_sheet(i,t,"Obligations")}else if(e.dynamic_fields?.obligation_data&&"object"==typeof e.dynamic_fields.obligation_data){const t=Object.entries(e.dynamic_fields.obligation_data).map(([e,t])=>({Field:Ie(e),Value:"number"==typeof t?`₹${t.toLocaleString()}`:t||""})),n=a.json_to_sheet(t);a.book_append_sheet(i,n,"Obligations")}else a.book_append_sheet(i,a.json_to_sheet([{Note:"No obligations data available"}]),"Obligations");const o=[{"Remark Type":"General Remarks",Content:e.remarks||e.notes||""},{"Remark Type":"Internal Notes",Content:e.internal_notes||""},{"Remark Type":"Login Remarks",Content:e.login_remarks||""},{"Remark Type":"Operations Remarks",Content:e.operations_remarks||""},{"Remark Type":"Credit Remarks",Content:e.credit_remarks||""},{"Remark Type":"Sales Remarks",Content:e.sales_remarks||""}],l=a.json_to_sheet(o);a.book_append_sheet(i,l,"Remarks");const d=e.dynamic_fields?.tasks||[];if(d.length>0){const e=d.map((e,t)=>({"#":t+1,Title:e.title||"",Description:e.description||"",Status:e.status||"",Priority:e.priority||"","Due Date":e.due_date||"","Assigned To":e.assigned_to?fe(e.assigned_to):"","Created At":e.created_at||"","Completed At":e.completed_at||""})),t=a.json_to_sheet(e);a.book_append_sheet(i,t,"Tasks")}else a.book_append_sheet(i,a.json_to_sheet([{Note:"No tasks data available"}]),"Tasks");const c=e.documents||[];if(c.length>0){const e=c.map((e,t)=>({"#":t+1,"Document Type":e.document_type||e.type||"","Document Name":e.document_name||e.name||e.file_name||"","File Path":e.file_path||"","Uploaded Date":e.uploaded_date||e.created_at||"","Uploaded By":e.uploaded_by?fe(e.uploaded_by):"",Status:e.status||""})),t=a.json_to_sheet(e);a.book_append_sheet(i,t,"Attachments")}else a.book_append_sheet(i,a.json_to_sheet([{Note:"No attachments available"}]),"Attachments");const p=e.activity||[];if(p.length>0){const e=p.map((e,t)=>({"#":t+1,"Date & Time":e.timestamp||e.created_at||e.date||"",User:e.user||e.user_name||e.created_by||"",Action:e.action||e.activity_type||e.type||"",Description:e.description||e.message||"",Section:e.section||e.module||"","Field Changed":e.field_changed||e.field||"","Old Value":e.old_value||e.previous_value||"","New Value":e.new_value||e.current_value||""})),t=a.json_to_sheet(e);a.book_append_sheet(i,t,"Lead Activity")}else a.book_append_sheet(i,a.json_to_sheet([{Note:"No activity history available"}]),"Lead Activity")}else{const e=[];if(Array.isArray(r))r.forEach(t=>{const a={};Object.keys(t).forEach(e=>{e.startsWith("_")||(a[Ie(e)]=t[e])}),e.push(a)});else{const t={};Object.keys(r).forEach(e=>{e.startsWith("_")||(t[Ie(e)]=r[e])}),e.push(t)}const t=a.json_to_sheet(e);a.book_append_sheet(i,t,"Details")}const l=`${y}_${e.custom_lead_id||e._id||"record"}_${o().format("YYYY-MM-DD")}.xlsx`;n(i,l),s.success("Export successful!")}catch(r){s.error(`Failed to export data: ${r.message}`)}finally{Z(!1)}})(r)},style:{background:"rgba(245, 158, 11, 0.2)",border:"1px solid #f59e0b",color:"#f59e0b"}})})]})}];switch(y){case"leads":case"login-leads":return[...t,{title:"Lead ID",dataIndex:"custom_lead_id",key:"custom_lead_id",width:140,sorter:!0,render:t=>e.jsx("span",{style:{color:"#a78bfa",fontWeight:500},children:t||"-"})},{title:"Name",key:"name",width:180,sorter:!0,render:(t,a)=>e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600,color:"#f3f4f6"},children:[a.first_name||""," ",a.last_name||""]}),e.jsx("div",{style:{fontSize:"12px",color:"#9ca3af"},children:a.email||""})]})},{title:"Phone",dataIndex:"phone",key:"phone",width:140,render:t=>e.jsx("span",{style:{color:"#cbd5e1"},children:t||"-"})},{title:"Status",dataIndex:"status",key:"status",width:130,sorter:!0,render:t=>e.jsx(z,{color:De(t),style:{fontWeight:500},children:t})},{title:"Loan Amount",dataIndex:"loan_amount",key:"loan_amount",width:140,sorter:!0,render:t=>e.jsx("span",{style:{color:"#34d399",fontWeight:600},children:t?`₹${t.toLocaleString()}`:"-"})},{title:"Assigned To",key:"assigned_to",width:160,render:(t,a)=>e.jsx("span",{style:{color:"#cbd5e1"},children:fe(a.assigned_to)||"-"})},{title:"Created Date",dataIndex:"created_date",key:"created_date",width:170,sorter:!0,render:t=>e.jsx("span",{style:{color:"#9ca3af"},children:t?o(t).format("YYYY-MM-DD HH:mm"):"-"})}];case"employees":return[...t,{title:"Employee ID",dataIndex:"employee_id",key:"employee_id",width:140,render:t=>e.jsx("span",{style:{color:"#a78bfa"},children:t||"-"})},{title:"Name",key:"name",width:180,render:(t,a)=>e.jsx("div",{children:e.jsxs("div",{style:{fontWeight:600,color:"#f3f4f6"},children:[a.first_name||""," ",a.last_name||""]})})},{title:"Email",dataIndex:"email",key:"email",width:220,render:t=>e.jsx("span",{style:{color:"#cbd5e1"},children:t||"-"})},{title:"Department",dataIndex:"department_name",key:"department_name",width:160,render:t=>e.jsx("span",{style:{color:"#cbd5e1"},children:t||"-"})},{title:"Designation",dataIndex:"designation_name",key:"designation_name",width:160,render:t=>e.jsx("span",{style:{color:"#cbd5e1"},children:t||"-"})},{title:"Status",dataIndex:"is_active",key:"is_active",width:100,render:t=>e.jsx(z,{color:t?"green":"red",children:t?"Active":"Inactive"})}];case"tasks":return[...t,{title:"Task Title",dataIndex:"title",key:"title",width:250,render:t=>e.jsx("span",{style:{color:"#f3f4f6",fontWeight:500},children:t||"-"})},{title:"Assigned To",key:"assigned_to",width:160,render:(t,a)=>e.jsx("span",{style:{color:"#cbd5e1"},children:fe(a.assigned_to)||"-"})},{title:"Status",dataIndex:"status",key:"status",width:120,render:t=>e.jsx(z,{color:"completed"===t?"green":"orange",children:t})},{title:"Priority",dataIndex:"priority",key:"priority",width:100,render:t=>e.jsx(z,{color:"high"===t?"red":"medium"===t?"orange":"blue",children:t})},{title:"Due Date",dataIndex:"due_date",key:"due_date",width:150,render:t=>e.jsx("span",{style:{color:"#9ca3af"},children:t?o(t).format("YYYY-MM-DD"):"-"})}];default:const a=ee[0]||{},n=Object.keys(a).filter(e=>!e.startsWith("_")&&"id"!==e);return[...t,...n.slice(0,6).map(t=>({title:t.replace(/_/g," ").toUpperCase(),dataIndex:t,key:t,width:150,render:t=>"object"==typeof t?e.jsx("span",{style:{color:"#6b7280"},children:JSON.stringify(t)}):"boolean"==typeof t?t?"Yes":"No":e.jsx("span",{style:{color:"#cbd5e1"},children:t||"-"})}))]}})(),dataSource:ee,rowKey:e=>e._id?.$oid||e._id||e.id||Math.random(),scroll:{x:"max-content",y:320},pagination:{total:ee.length,pageSize:50,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>`${t[0]}-${t[1]} of ${e} records`,pageSizeOptions:["10","25","50","100","200"]},bordered:!0,size:"small",onRow:e=>({onClick:()=>Se(e),style:{cursor:"pointer"}})})})})]}),e.jsx(C,{title:e.jsxs("span",{style:{color:"#f3f4f6",fontWeight:600,fontSize:"13px"},children:[e.jsx(D,{})," Lead Details"]}),open:le,onCancel:()=>{de(!1),pe(null)},footer:null,width:600,style:{top:25},children:e.jsx(w,{spinning:ue,tip:"Loading lead details...",children:(()=>{if(!ce)return null;const t=[{key:"about",label:e.jsxs("span",{children:[e.jsx(D,{})," About"]}),children:e.jsx("div",{style:{maxHeight:"600px",overflowY:"auto"},children:e.jsxs(R,{bordered:!0,column:2,size:"small",style:{background:"#1f2937"},children:[e.jsx(R.Item,{label:"Lead ID",labelStyle:{color:"#9ca3af"},children:e.jsx("span",{style:{color:"#e5e7eb"},children:ce.custom_lead_id||"-"})}),e.jsx(R.Item,{label:"Name",labelStyle:{color:"#9ca3af"},children:e.jsxs("span",{style:{color:"#e5e7eb",fontWeight:600},children:[ce.first_name||""," ",ce.last_name||""," ",ce.customer_name?`(${ce.customer_name})`:""]})}),e.jsx(R.Item,{label:"Email",labelStyle:{color:"#9ca3af"},children:e.jsx("span",{style:{color:"#cbd5e1"},children:ce.email||"-"})}),e.jsx(R.Item,{label:"Phone",labelStyle:{color:"#9ca3af"},children:e.jsx("span",{style:{color:"#cbd5e1"},children:ce.phone||"-"})}),e.jsx(R.Item,{label:"Status",labelStyle:{color:"#9ca3af"},children:e.jsx(z,{color:De(ce.status),children:ce.status||"-"})}),e.jsx(R.Item,{label:"Loan Amount",labelStyle:{color:"#9ca3af"},children:e.jsx("span",{style:{color:"#34d399",fontWeight:600},children:ce.loan_amount?`₹${ce.loan_amount.toLocaleString()}`:"-"})}),e.jsx(R.Item,{label:"Assigned To",labelStyle:{color:"#9ca3af"},children:e.jsx("span",{style:{color:"#cbd5e1"},children:fe(ce.assigned_to)||"-"})}),e.jsx(R.Item,{label:"Created Date",labelStyle:{color:"#9ca3af"},children:e.jsx("span",{style:{color:"#9ca3af"},children:ce.created_date||ce.created_at?o(ce.created_date||ce.created_at).format("YYYY-MM-DD HH:mm"):"-"})})]})})},{key:"obligations",label:e.jsxs("span",{children:[e.jsx(N,{})," Obligations"]}),children:e.jsx("div",{style:{maxHeight:"600px",overflowY:"auto"},children:ce.dynamic_fields?.obligations&&Array.isArray(ce.dynamic_fields.obligations)&&ce.dynamic_fields.obligations.length>0?e.jsx(v,{dataSource:ce.dynamic_fields.obligations.map((e,t)=>({...e,key:t})),columns:[{title:"#",key:"idx",width:50,render:(t,a,n)=>e.jsx("span",{style:{color:"#9ca3af"},children:n+1})},{title:"Type",dataIndex:"type",key:"type",width:120,render:t=>e.jsx("span",{style:{color:"#e5e7eb"},children:t||"-"})},{title:"Bank",dataIndex:"bank_name",key:"bank_name",width:150,render:t=>e.jsx("span",{style:{color:"#cbd5e1"},children:t||"-"})},{title:"EMI Amount",dataIndex:"emi_amount",key:"emi_amount",width:120,render:t=>e.jsx("span",{style:{color:"#f59e0b",fontWeight:600},children:t?`₹${Number(t).toLocaleString()}`:"-"})},{title:"Outstanding",dataIndex:"outstanding_amount",key:"outstanding_amount",width:120,render:t=>e.jsx("span",{style:{color:"#34d399",fontWeight:600},children:t?`₹${Number(t).toLocaleString()}`:"-"})}],pagination:!1,size:"small",scroll:{x:1200},style:{background:"#1f2937"}}):e.jsx("div",{style:{textAlign:"center",color:"#9ca3af",padding:"40px"},children:"No obligations data available"})})},{key:"remarks",label:e.jsxs("span",{children:[e.jsx(p,{})," Remarks"]}),children:e.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:e.jsxs(R,{bordered:!0,column:1,size:"small",style:{background:"#1f2937"},children:[e.jsx(R.Item,{label:"General Remarks",labelStyle:{color:"#9ca3af"},children:e.jsx("span",{style:{color:"#cbd5e1",whiteSpace:"pre-wrap"},children:ce.remarks||ce.notes||"-"})}),e.jsx(R.Item,{label:"Login Remarks",labelStyle:{color:"#9ca3af"},children:e.jsx("span",{style:{color:"#cbd5e1",whiteSpace:"pre-wrap"},children:ce.login_remarks||"-"})})]})})},{key:"tasks",label:e.jsxs("span",{children:[e.jsx(m,{})," Tasks"]}),children:e.jsx("div",{children:ce.dynamic_fields?.tasks&&ce.dynamic_fields.tasks.length>0?e.jsx(v,{dataSource:ce.dynamic_fields.tasks,columns:[{title:"Title",dataIndex:"title",key:"title",render:t=>e.jsx("span",{style:{color:"#e5e7eb"},children:t})},{title:"Status",dataIndex:"status",key:"status",render:t=>e.jsx(z,{color:"completed"===t?"green":"orange",children:t})},{title:"Priority",dataIndex:"priority",key:"priority",render:t=>e.jsx(z,{color:"high"===t?"red":"blue",children:t})}],pagination:!1,size:"small",style:{background:"#1f2937"}}):e.jsx("div",{style:{textAlign:"center",color:"#9ca3af",padding:"20px"},children:"No tasks data available"})})},{key:"attachments",label:e.jsxs("span",{children:[e.jsx(f,{})," Attachments"]}),children:e.jsx("div",{children:ce.documents&&ce.documents.length>0?e.jsx(v,{dataSource:ce.documents,columns:[{title:"Document Name",dataIndex:"document_name",key:"document_name",render:t=>e.jsx("span",{style:{color:"#e5e7eb"},children:t})},{title:"Type",dataIndex:"document_type",key:"document_type",render:t=>e.jsx("span",{style:{color:"#cbd5e1"},children:t})}],pagination:!1,size:"small",style:{background:"#1f2937"}}):e.jsx("div",{style:{textAlign:"center",color:"#9ca3af",padding:"20px"},children:"No attachments available"})})},{key:"activity",label:e.jsxs("span",{children:[e.jsx(E,{})," Activity History"]}),children:e.jsx("div",{style:{maxHeight:"500px",overflowY:"auto"},children:ce.activity&&ce.activity.length>0?e.jsx(v,{dataSource:ce.activity,columns:[{title:"Date",dataIndex:"timestamp",key:"timestamp",width:150,render:t=>e.jsx("span",{style:{color:"#9ca3af",fontSize:"12px"},children:t?o(t).format("YYYY-MM-DD HH:mm"):"-"})},{title:"User",dataIndex:"user",key:"user",width:120,render:t=>e.jsx("span",{style:{color:"#a78bfa"},children:t||"-"})},{title:"Action",dataIndex:"action",key:"action",render:t=>e.jsx("span",{style:{color:"#e5e7eb"},children:t})}],pagination:!1,size:"small",style:{background:"#1f2937"}}):e.jsx("div",{style:{textAlign:"center",color:"#9ca3af",padding:"20px"},children:"No activity history available"})})}];return e.jsx(Y,{activeKey:me,onChange:he,items:t,style:{background:"#111827",color:"#e5e7eb"},tabBarStyle:{background:"#1f2937",borderBottom:"1px solid #374151",color:"#9ca3af"}})})()})})]})};export{Q as default};
