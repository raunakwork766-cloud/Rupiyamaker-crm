const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["chunks/ObligationSection-DVwUqVmJ.js","chunks/vendor-mui-C1GmDdcn.js","chunks/vendor-react-EzoxUMNY.js","chunks/vendor-utils-QXd9EeNt.js","chunks/vendor-antd-BB3a0mYC.js","chunks/lead-components-CxEP6yWP.js","chunks/task-components-BODc7Jo4.js","chunks/employee-components-CPwJv_R0.js","chunks/vendor-office-CbbGW2MO.js","styles/employee-components-CAryrO_Y.css","styles/task-components-DguWJUkH.css","chunks/html2canvas.esm-CPDoSj43.js"])))=>i.map(i=>d[i]);
import{S as e,aR as t,aU as a,f as s,ab as l,A as i,F as n,U as r,aO as d,r as o,V as c,_ as m}from"./lead-components-CxEP6yWP.js";import{j as u}from"./vendor-mui-C1GmDdcn.js";import{r as x}from"./vendor-react-EzoxUMNY.js";import{b as p,A as b}from"./task-components-BODc7Jo4.js";import h from"./AboutSection-vB8wL4MY.js";import f from"./HowToProcessSection-B4y7S0l5.js";import{L as g}from"../assets/main-BrdTTOGy.js";import y from"./Attachments-TdmPbAxk.js";import _ from"./TaskSectionInLead-BCSSxcdI.js";import j from"./ImportantQuestionsSection-CwtW7f0A.js";import v from"./OperationsSection-D--DhXoY.js";import N from"./RequestReassignmentButton-C823zcq9.js";import"./vendor-antd-BB3a0mYC.js";import"./vendor-utils-QXd9EeNt.js";import"./employee-components-CPwJv_R0.js";import"./vendor-office-CbbGW2MO.js";import"./leadApiHelper-Bq4A4HGf.js";const w="/api";function k({leadId:i,userId:n,formatDate:r,canEdit:d=!0}){const[o,c]=x.useState([]),[m,p]=x.useState(!1),[b,h]=x.useState(""),[f,g]=x.useState(""),[y,_]=x.useState(""),[j,v]=x.useState("general"),[N,k]=x.useState(!1),S=x.useRef(null),I=[{value:"general",label:"General Note"},{value:"call",label:"Call Log"},{value:"meeting",label:"Meeting Note"},{value:"followup",label:"Follow-up"}];x.useEffect(()=>{$()},[i]),x.useEffect(()=>{S.current&&(S.current.style.height="60px")},[]);const $=async()=>{try{p(!0);const e=await fetch(`${w}/leads/${i}/notes?user_id=${n}`);if(e.ok){const t=await e.json();c(t||[])}}catch(e){h("Failed to load notes")}finally{p(!1)}},A=()=>{S.current&&(S.current.style.height="auto",S.current.style.height=`${Math.min(S.current.scrollHeight,300)}px`)},T=e=>{switch(e){case"call":return"bg-blue-600";case"meeting":return"bg-cyan-600";case"followup":return"bg-yellow-600";default:return"bg-gray-600"}};return m?u.jsx("div",{className:"flex items-center justify-center h-32",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):u.jsxs("div",{className:"space-y-4",children:[b&&u.jsx("div",{className:"bg-red-900/50 border border-red-500 text-red-200 px-4 py-3 rounded-lg",children:b}),f&&u.jsx("div",{className:"bg-green-900/50 border border-green-500 text-green-200 px-4 py-3 rounded-lg",children:f}),u.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-700",children:[u.jsxs("div",{className:"mb-3 flex items-center space-x-2",children:[u.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Note Type:"}),u.jsx("select",{value:j,onChange:e=>v(e.target.value),className:"text-black bg-white border border-gray-600 rounded px-2 py-1 text-sm",children:I.map(e=>u.jsx("option",{value:e.value,children:e.label},e.value))})]}),u.jsxs("div",{className:"flex space-x-3",children:[u.jsx("textarea",{ref:S,value:y,onChange:d?e=>{_(e.target.value),A()}:void 0,onKeyDown:d?e=>{"Enter"!==e.key||e.shiftKey?"Enter"===e.key&&e.shiftKey&&setTimeout(A,0):e.preventDefault()}:void 0,disabled:!d,placeholder:"Enter note content... (Press Shift+Enter for new line, click Send to submit)",className:"flex-1 bg-white border border-gray-600 rounded-lg px-3 py-2 text-black placeholder-gray-400 focus:outline-none focus:border-blue-500 resize-none text-base",rows:1,style:{minHeight:"60px",maxHeight:"300px",lineHeight:"1.5",overflow:"auto"}}),u.jsx("button",{onClick:async()=>{if(y.trim())try{if(k(!0),h(""),!(await fetch(`${w}/leads/${i}/notes?user_id=${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lead_id:i,content:y.toUpperCase(),note_type:j,created_by:n})})).ok)throw new Error("Failed to add note");$(),_(""),v("general"),g("Note added successfully"),setTimeout(()=>g(""),3e3),S.current&&(S.current.style.height="60px")}catch(e){h("Failed to add note")}finally{k(!1)}},disabled:!y.trim()||N,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue disabled:cursor-not-allowed text-white px-4 py-2 rounded-lg flex items-center",children:u.jsx(e,{})})]})]}),u.jsx("div",{className:"space-y-3",children:0===o.length?u.jsxs("div",{className:"text-center py-8 bg-white text-gray-400",children:[u.jsx(t,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),u.jsx("p",{children:"No notes yet. Add your first note above."})]}):o.map(e=>u.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-700",children:[u.jsxs("div",{className:"flex justify-between items-start ",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("span",{className:`px-2 py-1 rounded-full text-md font-medium text-black ${T(e.note_type)}`,children:I.find(t=>t.value===e.note_type)?.label||e.note_type}),u.jsx("span",{className:"text-blue-400 font-medium",children:e.creator_name||"Unknown User"}),u.jsxs("span",{className:"text-black text-md flex items-center",children:[u.jsx(s,{className:"w-3 h-3 mr-1"}),r?r(e.created_at):a(e.created_at)]})]}),u.jsx("div",{className:"flex space-x-2",children:e.can_delete&&u.jsx("button",{onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this note?"))try{if(!(await fetch(`${w}/leads/${i}/notes/${e}?user_id=${n}`,{method:"DELETE"})).ok)throw new Error("Failed to delete note");c(t=>t.filter(t=>t._id!==e)),g("Note deleted successfully"),setTimeout(()=>g(""),3e3)}catch(t){h("Failed to delete note")}})(e._id),className:"text-red-400 hover:text-red-300 p-1",title:"Delete note",children:u.jsx(l,{className:"w-4 h-4"})})})]}),u.jsx("p",{className:"text-black whitespace-pre-wrap break-words leading-relaxed mt-3 uppercase text-base bg-gray-50 p-3 rounded border-l-4 border-blue-400",children:e.content})]},e._id))})]})}function S({leadId:e,userId:t,formatDate:a}){const[s,l]=x.useState([]),[d,o]=x.useState(!1),[c,m]=x.useState(""),[b,h]=x.useState("all");x.useEffect(()=>{e&&t&&f()},[e,t]);const f=async()=>{if(e&&t)try{o(!0),m("");const a=p(`leads/${e}/activities?user_id=${t}`),s=localStorage.getItem("token"),i=await fetch(a,{method:"GET",headers:{"Content-Type":"application/json",...s&&{Authorization:`Bearer ${s}`}}});if(i.ok){const e=await i.json();l(Array.isArray(e)?e:[])}else await i.text(),m(`Failed to load activities: ${i.status} - ${i.statusText}`)}catch(a){m("Failed to load activities")}finally{o(!1)}else m("Missing lead ID or user ID")},g=e=>{switch(e){case"created":return"border-green-500 bg-green-900/20";case"updated":case"field_update":return"border-blue-500 bg-blue-900/20";case"status_changed":return"border-purple-500 bg-purple-900/20";case"assigned":return"border-yellow-500 bg-yellow-900/20";case"transferred":return"border-orange-500 bg-orange-900/20";case"note":case"remark_added":return"border-cyan-500 bg-cyan-900/20";case"document":case"attachment_uploaded":return"border-indigo-500 bg-indigo-900/20";default:return"border-gray-500 bg-gray-900/20"}},y=[{value:"all",label:"All Activities"},{value:"created",label:"Created"},{value:"updated",label:"Updated"},{value:"status_changed",label:"Status Changes"},{value:"assigned",label:"Assignments"},{value:"note",label:"Notes"},{value:"document",label:"Documents"},{value:"task_added",label:"Tasks"},{value:"transferred",label:"Transfers"}],_=(e=>e.reduce((e,t)=>{const a=new Date(t.created_at).toLocaleDateString("en-IN",{day:"2-digit",month:"long",year:"numeric"});e[a]||(e[a]={});const s=new Date(t.created_at).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0});return e[a][s]||(e[a][s]=[]),e[a][s].push(t),e},{}))(s.filter(e=>"all"===b||(e.action||e.activity_type)===b));return d?u.jsx("div",{className:"flex items-center justify-center h-32",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):u.jsxs("div",{className:"space-y-4 bg-white p-4 rounded-lg",children:[u.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-2 rounded text-xs",children:[u.jsx("strong",{children:"Debug:"})," LeadId: ",e||"MISSING"," | UserId: ",t||"MISSING"," | Activities: ",s.length," | Loading: ",d?"YES":"NO"," | Error: ",c||"NONE"]}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("h3",{className:"text-xl font-semibold text-black flex items-center",children:[u.jsx(i,{className:"w-6 h-6 mr-2"}),"Activities Timeline (",s.length,")"]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(n,{className:"w-4 h-4 text-gray-600"}),u.jsx("select",{value:b,onChange:e=>h(e.target.value),className:"bg-gray-100 border border-gray-300 rounded-lg px-3 py-1 text-black text-sm focus:outline-none focus:border-blue-500",children:y.map(e=>u.jsx("option",{value:e.value,children:e.label},e.value))})]})]}),c&&u.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg",children:c}),u.jsx("div",{className:"space-y-6",children:0===Object.keys(_).length?u.jsxs("div",{className:"text-center py-8 text-gray-600",children:[u.jsx(i,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),u.jsx("p",{children:"all"===b?"No activities yet.":`No ${y.find(e=>e.value===b)?.label.toLowerCase()||b} activities.`})]}):Object.entries(_).sort((e,t)=>new Date(t[0])-new Date(e[0])).map(([e,t])=>u.jsxs("div",{className:"space-y-4",children:[u.jsx("h4",{className:"text-lg font-medium text-black border-b border-gray-300 pb-2",children:e}),u.jsx("div",{className:"relative",children:Object.entries(t).sort((e,t)=>new Date(t[1][0].created_at)-new Date(e[1][0].created_at)).map(([e,t],a,s)=>{const l=t[0].action||t[0].activity_type;return u.jsxs("div",{className:"relative flex items-start space-x-4 pb-4",children:[u.jsxs("div",{className:"w-24 flex-shrink-0 text-right",children:[u.jsx("div",{className:"text-sm text-gray-600",children:e}),u.jsxs("div",{className:"relative flex justify-end",children:[u.jsx("div",{className:`z-10 w-6 h-6 rounded-full border-2 ${g(l)} flex items-center justify-center mt-2`}),a!==s.length-1&&u.jsx("div",{className:"absolute top-8 right-2.5 w-0.5 h-full bg-gray-300"})]})]}),u.jsx("div",{className:"flex-1 space-y-2",children:t.map((e,t)=>{const a=(e=>{const t=e.action||e.activity_type;switch(t){case"created":return"Lead created";case"updated":return"Lead details updated";case"field_update":return{isFieldUpdate:!0,fieldName:e.details?.field_display_name||"Field updated",oldValue:e.details?.old_value||"",newValue:e.details?.new_value||""};case"status_changed":return`Status: "${e.details?.old_status||"N/A"}" → "${e.details?.new_status||"N/A"}"`;case"assigned":return`Lead assigned to ${e.details?.assigned_to_name||"Unknown"}`;case"note":case"remark_added":return"Note added";case"document":case"attachment_uploaded":return`Document "${e.details?.filename||e.description||"Unknown"}" uploaded`;case"task_added":return`Task "${e.details?.task_title||"Unknown"}" added`;case"task_completed":return`Task "${e.details?.task_title||"Unknown"}" completed`;case"login_form_updated":return"Login form updated";case"transferred":return`Lead transferred to ${e.details?.department||"Unknown Department"}`;default:return e.description||t}})(e),s=a&&"object"==typeof a&&a.isFieldUpdate;return u.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("span",{className:"text-sm font-medium text-black",children:s?a.fieldName:a}),u.jsxs("div",{className:"text-sm text-gray-600 flex items-center",children:[u.jsx(r,{className:"w-3 h-3 mr-1"}),e.user_name||"System"]})]}),s&&u.jsxs("div",{className:"text-sm",children:[u.jsx("span",{className:"font-medium text-blue-600",children:"FROM:"}),u.jsx("span",{className:"ml-2 "+(a.oldValue?"text-red-600":"text-gray-400"),children:a.oldValue||"Empty"}),u.jsx("span",{className:"mx-2",children:"→"}),u.jsx("span",{className:"font-medium text-blue-600",children:"TO:"}),u.jsx("span",{className:"ml-2 text-green-600",children:a.newValue})]}),!s&&e.details?.comment&&u.jsx("div",{className:"text-sm text-gray-600",children:u.jsxs("p",{className:"italic",children:['"',e.details.comment,'"']})})]},e._id||t)})})]},e)})})]},e))})]})}const I=x.lazy(()=>m(()=>import("./ObligationSection-DVwUqVmJ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])));function $({lead:e,user:t,onBack:a,onLeadUpdate:s}){const[l,i]=x.useState("details"),[n,r]=x.useState(e),[m,w]=x.useState(!1),[$,A]=x.useState(!1),[T,C]=x.useState(""),[D,E]=x.useState(""),[F,L]=x.useState([]),[O,U]=x.useState(!1),[B,R]=x.useState("");x.useEffect(()=>{(async()=>{try{const e=localStorage.getItem("userId")||"",t=await fetch(p(`users/assignable?user_id=${e}`));if(t.ok){const e=await t.json();L(e)}}catch(e){}})()},[]);const q=async e=>{"dynamic_fields"in e&&e.dynamic_fields;try{if(!e||0===Object.keys(e).length)return!0;const a=["updated_by","updated_at","created_at","created_by"];if(0===Object.keys(e).filter(e=>!a.includes(e)).length)return!0;A(!0);const l=localStorage.getItem("userId")||"",i=localStorage.getItem("token")||"",d={...{...e}};if(d.dynamic_fields?.personal_details&&(void 0!==d.dynamic_fields.personal_details.company_type&&null!==d.dynamic_fields.personal_details.company_type&&"string"!=typeof d.dynamic_fields.personal_details.company_type&&(d.dynamic_fields.personal_details.company_type=String(d.dynamic_fields.personal_details.company_type)),void 0!==d.dynamic_fields.personal_details.company_category&&null!==d.dynamic_fields.personal_details.company_category&&"string"!=typeof d.dynamic_fields.personal_details.company_category&&(d.dynamic_fields.personal_details.company_category=String(d.dynamic_fields.personal_details.company_category))),d.dynamic_fields?.address&&Object.keys(d.dynamic_fields.address).forEach(e=>{const t=d.dynamic_fields.address[e];null!=t&&"string"!=typeof t&&(d.dynamic_fields.address[e]=String(t))}),["first_name","last_name","phone","email","data_code","loan_type","loan_type_name","city","postal_code","alternative_phone"].forEach(e=>{void 0!==d[e]&&null!==d[e]&&"string"!=typeof d[e]&&(d[e]=String(d[e]))}),d.dynamic_fields&&n?.dynamic_fields)try{d.dynamic_fields={...n.dynamic_fields,...d.dynamic_fields}}catch(t){}d.updated_by=l,d.updated_at=(new Date).toISOString();const o=await fetch(`${b}/leads/${n._id}?user_id=${l}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify(d)});if(!o.ok){const e=await o.text();try{const t=JSON.parse(e);C(`Failed to update lead: ${t.detail||e}`)}catch(t){C(`Failed to update lead: ${o.status} ${e}`)}return A(!1),setTimeout(()=>C(""),5e3),!1}if(o.ok){await o.json();const e=await fetch(`${b}/leads/${n._id}?user_id=${l}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`}});if(e.ok){const t=await e.json();return r(t),s&&s(t),E("Lead updated successfully and data refreshed"),setTimeout(()=>E(""),2e3),!0}return r(d),s&&s(d),E("Lead updated successfully (optimistic update)"),setTimeout(()=>E(""),2e3),!0}{const e=await o.text();let a=e,s=e;try{const t=JSON.parse(e);a=t.message||t.error||e,s=t.detail||t.message||t.error||e}catch(t){}throw new Error(`Failed to update lead: ${o.status} - ${a}`)}}catch(a){return C("Failed to update lead: "+a.message),setTimeout(()=>C(""),5e3),!1}finally{A(!1)}},H=localStorage.getItem("userId")||"",M=t?.department||localStorage.getItem("userDepartment")||"sales";x.useEffect(()=>{n.dynamic_fields?.co_applicant_form&&"object"==typeof n.dynamic_fields.co_applicant_form&&!O&&U(!0)},[n,O]),x.useEffect(()=>{(async()=>{try{A(!0);const t=localStorage.getItem("userId")||"",a=await fetch(`${b}/leads/${e._id}?user_id=${t}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(a.ok){const e=await a.json();r(e)}}catch(t){}finally{A(!1)}})()},[e._id]);const P=e=>new Date(e).toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});return u.jsx("div",{className:"min-h-screen bg-black text-white p-6",children:u.jsxs("div",{className:"max-w-7xl mx-auto",children:[u.jsx("div",{className:" rounded-lg p-6 mb-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("button",{onClick:a,className:"mr-4 p-2 text-gray-400 hover:text-white rounded-lg hover:bg-gray-800 transition-colors",children:u.jsx(d,{className:"w-5 h-5"})}),u.jsxs("div",{children:[u.jsxs("h1",{className:"text-2xl font-bold text-white",children:[n.first_name," ",n.last_name]}),u.jsxs("p",{className:"text-gray-400",children:["Lead ID: ",n.custom_lead_id||n._id?.slice(-8)," | ",n.phone," | ",n.email]})]})]}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx(N,{leadId:n._id,buttonClassName:"bg-amber-600 hover:bg-amber-700 px-4 py-2 rounded-lg font-medium transition-colors flex items-center mr-2",assignableUsers:F,onRequestSubmitted:()=>{E("Lead reassignment requested successfully"),setTimeout(()=>E(""),3e3)}}),u.jsxs("button",{className:"bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg font-medium transition-colors flex items-center",onClick:async()=>{const e=!O;if(U(e),e&&!n.dynamic_fields?.co_applicant_form){const e={dynamic_fields:{...n.dynamic_fields||{},co_applicant_form:{}}};await q(e)}},children:[u.jsx(o,{className:"w-4 h-4 mr-2"}),O?"Hide Co-Applicant Form":"Show Co-Applicant Form"]}),!1===n?.form_share?u.jsxs("div",{className:"flex items-center bg-gray-500 px-4 py-2 rounded-lg font-medium text-white",children:[u.jsx(c,{className:"w-4 h-4 mr-2"}),"Form Submitted"]}):u.jsxs("button",{onClick:async()=>{try{const t={lead_id:e._id,expires_in_days:7,purpose:"public_form",base_url:"https://raunakcrm.bhoomitechzone.us:4521",allow_update:!0,one_time_use:!1},a=await fetch(`${b}/share-links/create?user_id=${H}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(a.ok){const e=await a.json();R(e.url),E("Shareable link generated successfully")}}catch(t){C("Failed to generate shareable link")}},className:"bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg font-medium transition-colors flex items-center",children:[u.jsx(c,{className:"w-4 h-4 mr-2"}),"Share"]}),u.jsxs("div",{className:"text-right",children:[u.jsx("div",{className:"text-sm text-gray-400",children:"Status"}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("div",{className:"text-white font-semibold",children:n.status||("sales"===M?"ACTIVE LEAD":"ACTIVE LOGIN")}),n.sub_status&&u.jsx("div",{className:"text-xs bg-gray-700 text-gray-300 px-2 py-1 rounded-full border border-gray-600",children:n.sub_status})]})]})]})]})}),T&&u.jsxs("div",{className:"bg-red-900 border border-red-600 text-red-200 px-4 py-3 rounded-lg mb-6",children:[T,u.jsx("button",{onClick:()=>C(""),className:"ml-4 text-red-400 hover:text-red-200",children:"×"})]}),D&&u.jsxs("div",{className:"bg-green-900 border border-green-600 text-green-200 px-4 py-3 rounded-lg mb-6",children:[D,u.jsx("button",{onClick:()=>E(""),className:"ml-4 text-green-400 hover:text-green-200",children:"×"})]}),u.jsx("div",{className:"flex flex-wrap items-center gap-2 px-2 sm:px-4 lg:px-7 py-3 bg-black border-b border-[#232c3a] w-full overflow-x-auto",children:[{id:"details",label:"LEAD DETAILS",icon:null},{id:"obligations",label:"OBLIGATION",icon:null},{id:"remarks",label:"REMARK",icon:null},{id:"attachments",label:"ATTACHEMENT",icon:null},{id:"tasks",label:"TASK",icon:null},{id:"activities",label:"LEADS ACTIVITY",icon:null}].map(e=>n.can_view_all_tabs||"details"===e.id||"remarks"===e.id&&(n.can_add_notes||n.can_edit)||"attachments"===e.id&&(n.can_upload_attachments||n.can_edit)||"tasks"===e.id&&(n.can_add_tasks||n.can_edit)||"activities"===e.id&&(n.can_view_all_tabs||n.can_edit||n.can_view)||"obligations"===e.id&&n.can_view_all_tabs?u.jsxs("button",{onClick:()=>i(e.id),className:`\n                                    flex items-center px-3 sm:px-4 lg:px-6 py-2 sm:py-3 rounded-3xl font-extrabold border shadow-md text-sm sm:text-base lg:text-[1.05rem] transition whitespace-nowrap\n                                    ${l===e.id?"bg-[#03B0F5] via-blue-700 to-cyan-500 text-white border-cyan-400 shadow-lg scale-105":"bg-white text-[#03B0F5] border-[#2D3C56] hover:bg-cyan-400/10 hover:text-cyan-400"}\n                                    focus:outline-none\n                                `,style:{boxShadow:l===e.id?"0 4px 16px 0 #1cb5e080":void 0,cursor:"pointer",letterSpacing:"0.01em"},children:[e.icon&&u.jsx("span",{className:"mr-1",children:e.icon}),e.label]},e.id):null)}),u.jsx("div",{className:"px-2 sm:px-4 lg:px-6 py-6 w-full",children:u.jsxs("div",{className:"w-full",children:["details"===l&&u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"text-lg font-bold text-[#03B0F5] mb-4",children:"About"}),u.jsx(h,{lead:n,onSave:q},`about-${n._id}`)]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"text-lg font-bold text-[#03B0F5] mb-4",children:"How to Process"}),u.jsx(f,{lead:n,process:n.process,onSave:q})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"text-lg font-bold text-[#03B0F5] mb-4",children:"APPLICANT FORM"}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h4",{className:"text-md font-semibold text-[#03B0F5]",children:"Primary Applicant"}),!O&&u.jsx("button",{className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-bold text-lg",onClick:()=>U(!0),children:"+ Add Co-Applicant"})]}),u.jsx(g,{data:n.dynamic_fields?.applicant_form||n.loginForm||{},onSave:e=>q({dynamic_fields:{...n.dynamic_fields,applicant_form:e}}),bankOptions:[],mobileNumber:n.mobile_number,bankName:n.salaryAccountBank||n.bank_name,isReadOnlyMobile:!0,leadId:n._id,leadCustomerName:`${n.first_name||""} ${n.last_name||""}`.trim()||n.customerName||n.name||"",leadData:n}),O&&u.jsxs("div",{className:"mt-8 pt-6 border-t-2 border-cyan-400",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h4",{className:"text-md font-semibold text-[#03B0F5]",children:"Co-Applicant"}),u.jsx("button",{className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition font-bold text-lg",onClick:()=>{q({dynamic_fields:{...n.dynamic_fields,co_applicant_form:null}}),U(!1)},children:"Remove Co-Applicant"})]}),u.jsx(g,{data:n.dynamic_fields?.co_applicant_form||n.coApplicantForm||{},onSave:e=>q({dynamic_fields:{...n.dynamic_fields,co_applicant_form:e}}),bankOptions:[],mobileNumber:"",bankName:"",isCoApplicant:!0,leadId:n._id,leadCustomerName:`${n.first_name||""} ${n.last_name||""}`.trim()+" - Co-Applicant",leadData:n})]})]})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"text-lg font-bold text-[#03B0F5] mb-4",children:"Important Questions"}),u.jsx(j,{leadData:n,onUpdate:e=>{q(e),e.question_responses&&q({question_responses:e.question_responses}),void 0!==e.important_questions_validated&&q({important_questions_validated:e.important_questions_validated})},currentUserRole:{permissions:[],_id:localStorage.getItem("userId"),department:localStorage.getItem("userDepartment")||"sales"}})]}),("login"===M||n.file_sent_to_login)&&u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"text-lg font-bold text-[#03B0F5] mb-4",children:"Operations"}),u.jsx(v,{lead:n,onUpdate:q})]}),u.jsx("div",{className:"mt-6",children:u.jsx(N,{leadId:e._id,assignableUsers:F,onRequestSubmitted:()=>{E("Lead reassignment requested successfully"),setTimeout(()=>E(""),3e3)}})})]}),"obligations"===l&&u.jsx("div",{children:u.jsx(x.Suspense,{fallback:u.jsx("div",{className:"text-center p-4",children:"Loading..."}),children:u.jsx(I,{leadData:{...n,obligations:n.obligations||[],dynamic_fields:{...n.dynamic_fields,obligations:n.dynamic_fields?.obligations||[]}},handleChangeFunc:(e,t)=>{q({[e]:t})},onDataUpdate:async()=>{if(s){const t=localStorage.getItem("userId")||"",a=localStorage.getItem("token")||"";try{const e=await fetch(p(`lead-login/login-leads/${n._id}?user_id=${t}`),{headers:{Authorization:`Bearer ${a}`}});if(e.ok){const t=await e.json();r(t),s(t)}}catch(e){}}}})})}),"remarks"===l&&u.jsx("div",{className:"p-6 bg-white rounded-xl shadow-2xl text-[1rem] text-gray-100 border-l-4 border-cyan-500/60",children:u.jsx(k,{leadId:e._id,userId:H,formatDate:P})}),"attachments"===l&&u.jsx("div",{children:u.jsx(y,{leadId:e._id,userId:H})}),"tasks"===l&&u.jsx("div",{className:"p-4 bg-gradient-to-r from-[#1b2736] to-[#23243a] rounded-xl shadow text-[1rem] text-[#03b0f5] border-l-4 border-cyan-400/40",children:u.jsx("div",{className:"font-bold text-cyan-400 mb-2",children:u.jsx(_,{leadId:e._id,userId:H,formatDate:P})})}),"activities"===l&&u.jsx("div",{className:"p-4 bg-white rounded-xl shadow text-[1rem] text-[#03b0f5] border-l-4 border-cyan-400/40",children:u.jsx("div",{className:"font-bold text-cyan-400 mb-2",children:u.jsx(S,{leadId:e._id,userId:H,formatDate:P})})})]})})]})})}export{$ as default};
