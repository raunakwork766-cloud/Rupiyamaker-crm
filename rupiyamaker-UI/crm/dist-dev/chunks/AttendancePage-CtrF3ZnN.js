import{j as e}from"./vendor-mui-C1GmDdcn.js";import{r as s}from"./vendor-react-EzoxUMNY.js";import{a7 as a}from"./vendor-utils-QXd9EeNt.js";import{f as t}from"./employee-components-DNbf1mGd.js";import{j as r,k as l,n,o as d,h as i,p as c,Y as o,l as x,X as m,aJ as h,U as g,S as p,s as y,ab as b}from"./lead-components-CRPAALZm.js";import"./vendor-antd-BB3a0mYC.js";import"./vendor-office-CbbGW2MO.js";const u="/api",j=()=>{const e=(()=>{const e=localStorage.getItem("userData");return e?JSON.parse(e):null})();return{"Content-Type":"application/json",...e?.token&&{Authorization:`Bearer ${e.token}`}}},N=async(e,s,t)=>{try{return(await a.get(`${u}/attendance/calendar`,{params:{year:e,month:s,user_id:t},headers:j()})).data}catch(r){throw r}},f=async(e,s,t)=>{try{return(await a.get(`${u}/attendance/detail/${e}/${s}`,{params:{requester_id:t},headers:j()})).data}catch(r){throw r}},v=async(e,s,t)=>{try{return(await a.get(`${u}/attendance/comments/${e}/${s}`,{params:{requester_id:t},headers:j()})).data}catch(r){throw r}},_=async(e,s,t)=>{try{return(await a.get(`${u}/attendance/history/${e}/${s}`,{params:{requester_id:t},headers:j()})).data}catch(r){throw r}},w=async(e=null,s=null,t)=>{try{const r={user_id:t};return e&&(r.year=e),s&&(r.month=s),(await a.get(`${u}/attendance/holidays`,{params:r,headers:j()})).data}catch(r){throw r}},k=s=>{switch(s){case"P":return e.jsx("div",{className:"w-8 h-8 bg-green-500 text-white rounded flex items-center justify-center text-xs font-bold",title:"Present",children:"P"});case"L":return e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-yellow-500 to-orange-500 text-white rounded flex items-center justify-center text-xs font-bold",title:"Late",children:"L"});case"LV":return e.jsx("div",{className:"w-8 h-8 bg-orange-500 text-white rounded flex items-center justify-center text-xs font-bold",title:"Leave Approved",children:"LV"});case"PL":return e.jsx("div",{className:"w-8 h-8 bg-white text-black border-2 border-gray-400 rounded flex items-center justify-center text-xs font-bold",title:"Pending Leave",children:"PL"});case"H":return e.jsx("div",{className:"w-8 h-8 bg-blue-500 text-white rounded flex items-center justify-center text-xs font-bold",title:"Holiday",children:"H"});case"HD":return e.jsx("div",{className:"w-8 h-8 bg-yellow-500 text-white rounded flex items-center justify-center text-xs font-bold",title:"Half Day",children:"HD"});case"AB":return e.jsx("div",{className:"w-8 h-8 bg-red-500 text-white rounded flex items-center justify-center text-xs font-bold",title:"Absconding",children:"AB"});case"ISS":case"ISSUE":return e.jsx("div",{className:"w-8 h-8 bg-black text-white rounded flex items-center justify-center text-xs font-bold",title:"Issue - Missing Punch In/Out",children:"ISS"});case"Z":case"ZERO":return e.jsx("div",{className:"w-8 h-8 bg-black text-white rounded flex items-center justify-center text-xs font-bold",title:"Zero - Insufficient Hours",children:"0"});default:return e.jsx("div",{className:"w-8 h-8 bg-gray-700 rounded flex items-center justify-center text-xs text-gray-400",title:"Not Marked",children:"-"})}},S=e=>{switch(e){case"P":return"PRESENT";case"L":return"LATE";case"LV":return"LEAVE APPROVED";case"PL":return"PENDING LEAVE";case"H":return"HOLIDAY";case"HD":return"HALF DAY";case"AB":return"ABSCONDING";case"ISS":case"ISSUE":return"ISSUE - MISSING PUNCH";case"Z":case"ZERO":return"ZERO - INSUFFICIENT HOURS";default:return"NOT MARKED"}},A=e=>{switch(e){case"P":case"L":return 1;case"HD":return.5;case"AB":return-1;default:return 0}},E=(e,s,a)=>["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][new Date(e,s-1,a).getDay()],D=["January","February","March","April","May","June","July","August","September","October","November","December"],C=({isOpen:r,onClose:l,holidays:n,onUpdateHolidays:d,selectedYear:i,selectedMonth:c})=>{const[o,x]=s.useState(""),[h,g]=s.useState(""),[p,N]=s.useState(""),[f,v]=s.useState(!1),[_,k]=s.useState(null),[S,A]=s.useState([]),[E,C]=s.useState("");s.useEffect(()=>{const e=localStorage.getItem("userData");e&&k(JSON.parse(e))},[]),s.useEffect(()=>{r&&_?.user_id&&L()},[r,_,i,c]);const L=async()=>{if(_?.user_id){v(!0),C("");try{const e=await w(i,c,_.user_id);e.success?A(e.holidays||[]):C("Failed to load holidays")}catch(e){C("Failed to load holidays. Please try again."),A([])}finally{v(!1)}}};if(!r)return null;const P=S.filter(e=>{const s=new Date(e.date);return s.getFullYear()===i&&s.getMonth()+1===c}),T=async e=>{if(_?.user_id){v(!0),C("");try{const s=await(async(e,s)=>{try{return(await a.delete(`${u}/attendance/holidays/${e}`,{params:{user_id:s},headers:j()})).data}catch(E){throw E}})(e,_.user_id);s.success?(await L(),d(S.filter(s=>s._id!==e))):C(s.message||"Failed to delete holiday")}catch(s){C(s.response?.data?.detail||"Failed to delete holiday. Please try again.")}finally{v(!1)}}},I=e=>t(e);return e.jsx("div",{className:"fixed inset-0 bg-transparent bg-opacity-70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto shadow-2xl",children:[e.jsxs("div",{className:"bg-gradient-to-r from-cyan-600 to-blue-600 text-white p-4 rounded-t-lg relative",children:[e.jsx("button",{onClick:l,className:"absolute top-4 right-4 text-white hover:text-gray-200 transition-colors",children:e.jsx(m,{className:"h-6 w-6"})}),e.jsx("h2",{className:"text-xl font-bold",children:"Holiday Management"}),e.jsxs("p",{className:"text-cyan-100 text-sm mt-1",children:["Manage company holidays for ",D[c-1]," ",i]})]}),e.jsxs("div",{className:"p-6 bg-gray-900",children:[E&&e.jsx("div",{className:"mb-4 p-3 bg-red-900/50 border border-red-700 rounded-lg",children:e.jsx("p",{className:"text-red-200 text-sm",children:E})}),f&&e.jsxs("div",{className:"mb-4 flex items-center justify-center py-4",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-cyan-500"}),e.jsx("span",{className:"text-gray-300 ml-2",children:"Processing..."})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-200 mb-4",children:"Add New Holiday"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Holiday Date *"}),e.jsx("input",{type:"date",value:o,onChange:e=>x(e.target.value),className:"w-full p-3 border border-gray-600 rounded-lg bg-gray-800 text-gray-200 focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500",disabled:f})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Holiday Name *"}),e.jsx("input",{type:"text",value:h,onChange:e=>g(e.target.value),placeholder:"e.g., Independence Day",className:"w-full p-3 border border-gray-600 rounded-lg bg-gray-800 text-gray-200 placeholder-gray-500 focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500",disabled:f})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Description (Optional)"}),e.jsx("input",{type:"text",value:p,onChange:e=>N(e.target.value),placeholder:"Additional details about the holiday",className:"w-full p-3 border border-gray-600 rounded-lg bg-gray-800 text-gray-200 placeholder-gray-500 focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500",disabled:f})]})]}),e.jsxs("button",{onClick:async()=>{if(o&&h&&_?.user_id){v(!0),C("");try{const e=await(async(e,s,t,r)=>{try{const l={name:e,date:s,user_id:r};return t&&(l.description=t),(await a.post(`${u}/attendance/holidays/add`,null,{params:l,headers:j()})).data}catch(E){throw E}})(h,o,p,_.user_id);e.success?(await L(),x(""),g(""),N(""),d(S)):C(e.message||"Failed to add holiday")}catch(e){C(e.response?.data?.detail||"Failed to add holiday. Please try again.")}finally{v(!1)}}else C("Please fill in all required fields")},disabled:f||!o||!h,className:"mt-4 bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 disabled:from-gray-600 disabled:to-gray-700 text-white px-6 py-2 flex items-center gap-2 rounded-md transition-colors",children:[e.jsx(y,{className:"h-4 w-4"}),f?"Adding...":"Add Holiday"]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-200 mb-4",children:["Holidays for ",D[c-1]," ",i]}),0===P.length?e.jsx("div",{className:"text-center py-8 bg-gray-800 rounded-lg border border-gray-700",children:e.jsx("p",{className:"text-gray-400",children:"No holidays set for this month"})}):e.jsx("div",{className:"space-y-3",children:P.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-800 border border-gray-700 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-200",children:s.name}),e.jsx("div",{className:"text-sm text-gray-400",children:I(s.date)}),s.description&&e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:s.description})]}),e.jsx("button",{onClick:()=>T(s._id),disabled:f,className:"text-red-400 border border-red-700 hover:bg-red-900/50 disabled:opacity-50 px-3 py-1 rounded-md text-sm transition-colors flex items-center gap-1",children:e.jsx(b,{className:"h-4 w-4"})})]},s._id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-200 mb-4",children:"All Company Holidays"}),0===S.length?e.jsx("div",{className:"text-center py-8 bg-gray-800 rounded-lg border border-gray-700",children:e.jsx("p",{className:"text-gray-400",children:"No holidays configured"})}):e.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 bg-gray-800 rounded-lg border border-gray-700 p-4",children:S.sort((e,s)=>new Date(e.date)-new Date(s.date)).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-700 rounded border border-gray-600 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-200",children:s.name}),e.jsx("span",{className:"text-gray-400 ml-2",children:I(s.date)}),s.description&&e.jsx("div",{className:"text-gray-500 text-xs mt-1",children:s.description})]}),e.jsx("button",{onClick:()=>T(s._id),disabled:f,className:"text-red-400 border border-red-700 hover:bg-red-900/50 disabled:opacity-50 px-2 py-1 rounded-md text-sm transition-colors",children:e.jsx(b,{className:"h-3 w-3"})})]},s._id))})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:l,className:"bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white px-6 py-2 rounded-md transition-colors",children:"Close"})})]})]})})},L=({employee:l,selectedDate:n,isOpen:d,onClose:i,onUpdate:c,selectedYear:o,selectedMonth:y,canUserEdit:b})=>{const[N,w]=s.useState(""),[E,D]=s.useState(!1),[C,L]=s.useState([]),[P,T]=s.useState(""),[I,$]=s.useState([]),[H,M]=s.useState(null),[O,U]=s.useState(!1),[R,F]=s.useState(null);s.useEffect(()=>{const e=localStorage.getItem("userData");e&&F(JSON.parse(e))},[]),s.useEffect(()=>{d&&l&&n&&R?.user_id&&B()},[d,l,n,R]);const Y=()=>!!l?.id&&("own"!==r("attendance")&&(b&&"function"==typeof b?b(l.id):x("attendance",l.id))),B=async()=>{if(l&&n&&R?.user_id){U(!0);try{const s=`${o}-${String(y).padStart(2,"0")}-${String(n).padStart(2,"0")}`,a=await f(l.id,s,R.user_id);M(a);try{const e=await v(l.id,s,R.user_id);L(e.comments||[])}catch(e){L([])}try{const e=await _(l.id,s,R.user_id);$(e.history||[])}catch(e){$([])}}catch(e){}finally{U(!1)}}};if(!d||!l)return null;const V=l[`day${n}`]||"A",G=S(V),W=(e,s,a)=>`${e}-${String(s).padStart(2,"0")}-${String(a).padStart(2,"0")}`,z=async()=>{if(N)if(P.trim())if(R?.user_id){U(!0);try{let e=A(N);const s=`${o}-${String(y).padStart(2,"0")}-${String(n).padStart(2,"0")}`;if(H?.id){const s={status:e,status_code:N,comments:P.trim(),is_manual_override:!0,override_by:R.user_id,override_by_name:R.name||R.userName,override_date:(new Date).toISOString(),old_status:V};await(async(e,s,t)=>{try{return(await a.put(`${u}/attendance/edit/${e}?admin_id=${t}`,{...s},{headers:j()})).data}catch(r){throw r}})(H.id,s,R.user_id)}else{const t={employee_id:l.id,date:s,status:e,status_code:N,comments:P.trim(),is_manual_override:!0,override_by:R.user_id,override_by_name:R.name||R.userName,check_in_time:null,check_out_time:null,is_holiday:"H"===N};await(async(e,s)=>{try{return(await a.post(`${u}/attendance/mark?user_id=${s}`,{employee_id:e.employee_id,date:e.date,status:e.status,comments:e.comments||"",check_in_time:e.check_in_time||null,check_out_time:e.check_out_time||null,is_holiday:e.is_holiday||!1},{headers:j()})).data}catch(t){throw t}})(t,R.user_id)}c&&c(l.id,n,N),w(""),T(""),await B(),alert(`‚úÖ Attendance updated successfully!\n\nOld Status: ${S(V)}\nNew Status: ${S(N)}\n\nComment: ${P.trim()}`)}catch(e){alert("‚ùå Failed to update attendance. Please try again.\n\nError: "+(e.response?.data?.detail||e.message))}finally{U(!1)}}else alert("User information not found. Please login again.");else alert("Comment is mandatory for manual override. Please provide a reason.");else alert("Please select a new attendance status.")},Z=async()=>{if(P.trim()&&R?.user_id&&l&&n){U(!0);try{const e=`${o}-${String(y).padStart(2,"0")}-${String(n).padStart(2,"0")}`;await(async(e,s,t,r)=>{try{return(await a.post(`${u}/attendance/comments/add?user_id=${e}&date=${s}&content=${encodeURIComponent(t)}&requester_id=${r}`,{},{headers:j()})).data}catch(l){throw l}})(l.id,e,P.trim(),R.user_id);const s=await v(l.id,e,R.user_id);L(s.comments||[]),T("")}catch(e){alert("Failed to add comment. Please try again.")}finally{U(!1)}}};return e.jsx("div",{className:"fixed inset-0 bg-transparent bg-opacity-70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl",children:[e.jsxs("div",{className:"bg-gradient-to-r from-cyan-600 to-blue-600 text-white p-4 rounded-t-lg relative",children:[e.jsx("button",{onClick:i,className:"absolute top-4 right-4 text-white hover:text-gray-200 transition-colors",children:e.jsx(m,{className:"h-6 w-6"})}),e.jsx("h2",{className:"text-xl font-bold",children:"ADMIN PANEL"})]}),e.jsx("div",{className:" bg-gray-800 border-b border border-gray-700",children:e.jsxs("div",{className:"text-gray-200 space-y-2",children:[e.jsxs("p",{className:"font-semibold text-cyan-400",children:[l.department.toUpperCase()," | ADMIN"]}),e.jsxs("p",{className:"text-gray-300",children:["EMP-ID: ",l.employee_code||l.employee_number||l.empId||`EMP-${l.id?.slice(-6)||"UNKNOWN"}`]}),e.jsxs("p",{className:"text-gray-300",children:["ATTENDANCE: ",e.jsx("span",{className:"text-cyan-400 font-semibold",children:G})]}),H&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-gray-300",children:["EMPLOYEE NAME: ",e.jsx("span",{className:"text-cyan-400",children:H.employee?.employee_name||H.employee_name})]}),e.jsxs("p",{className:"text-gray-300",children:["DATE: ",e.jsx("span",{className:"text-cyan-400",children:H.date})]}),e.jsxs("p",{className:"text-gray-300",children:["STATUS: ",e.jsx("span",{className:"text-cyan-400",children:H.status_text})]}),"leave"===H.type&&H.leave_details&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-gray-300",children:["LEAVE TYPE: ",e.jsx("span",{className:"text-orange-400",children:H.leave_details.leave_type_display})]}),e.jsxs("p",{className:"text-gray-300",children:["REASON: ",e.jsx("span",{className:"text-yellow-400",children:H.leave_details.reason})]}),e.jsxs("p",{className:"text-gray-300",children:["DURATION: ",e.jsxs("span",{className:"text-green-400",children:[H.leave_details.duration_days," day(s)"]})]}),e.jsxs("p",{className:"text-gray-300",children:["APPROVED BY: ",e.jsx("span",{className:"text-purple-400",children:H.leave_details.approved_by_name})]}),H.leave_details.approval_comments&&e.jsxs("p",{className:"text-gray-300",children:["APPROVAL COMMENTS: ",e.jsx("span",{className:"text-blue-400",children:H.leave_details.approval_comments})]})]}),"attendance"===H.type&&e.jsxs(e.Fragment,{children:[H.attendance_details?.total_working_hours&&e.jsxs("p",{className:"text-gray-300",children:["TOTAL HOURS: ",e.jsxs("span",{className:"text-green-400",children:[H.attendance_details.total_working_hours," hours"]})]}),H.working_hours&&e.jsxs("p",{className:"text-gray-300",children:["TOTAL HOURS: ",e.jsxs("span",{className:"text-green-400",children:[H.working_hours," hours"]})]}),H.is_late&&e.jsxs("p",{className:"text-gray-300",children:["LATE: ",e.jsx("span",{className:"text-yellow-400",children:"Yes"})]})]})]})]})}),e.jsxs("div",{className:"p-6 bg-gray-900",children:[O?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-500"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Loading attendance details..."})]}):e.jsxs(e.Fragment,{children:["leave"!==H?.type&&e.jsxs("div",{className:"mb-6 space-y-4",children:[H?.is_late&&e.jsx("div",{className:"bg-gradient-to-r from-yellow-700/20 to-orange-700/20 border-2 border-yellow-500 rounded-lg p-5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-yellow-400 text-3xl",children:"‚è∞"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-yellow-400 text-lg mb-2",children:"LATE PUNCH IN DETECTED"}),e.jsx("p",{className:"text-gray-200 mb-3",children:H.late_message||"You punched in late today."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gray-800 border border-yellow-500 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-yellow-300 font-semibold mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"üïê"}),e.jsx("span",{children:"Shift Timing"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Shift Start:"}),e.jsx("span",{className:"text-white font-semibold",children:"10:00 AM"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Deadline:"}),e.jsx("span",{className:"text-orange-400 font-semibold",children:"10:15 AM"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Grace Window:"}),e.jsx("span",{className:"text-teal-400 font-semibold",children:"30 mins"})]})]})]}),e.jsxs("div",{className:"bg-gray-800 border border-yellow-500 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-yellow-300 font-semibold mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"üìç"}),e.jsx("span",{children:"Your Timing"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Punch In:"}),e.jsx("span",{className:"text-cyan-400 font-bold",children:H.check_in_time||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Late By:"}),e.jsxs("span",{className:"text-red-400 font-bold",children:[H.minutes_late||0," mins"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Grace Used?"}),e.jsx("span",{className:"font-bold "+(H.grace_applied_today?"text-yellow-400":"text-gray-400"),children:H.grace_applied_today?"Yes ‚úì":"No"})]})]})]}),e.jsxs("div",{className:"bg-gray-800 border border-yellow-500 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-yellow-300 font-semibold mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"‚ö†Ô∏è"}),e.jsx("span",{children:"Impact"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Status:"}),e.jsx("span",{className:"text-yellow-400 font-bold",children:"Late (L)"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Final Count:"}),e.jsx("span",{className:"font-bold "+(H.grace_applied_today?"text-green-400":"text-orange-400"),children:H.grace_applied_today?"Full (1)":"Based on Hours"})]}),!H.grace_applied_today&&e.jsx("div",{className:"text-xs text-orange-300 mt-2",children:"‚ö†Ô∏è Grace limit exhausted! Final status depends on working hours."})]})]})]}),e.jsxs("div",{className:"mt-3 bg-yellow-900/40 border border-yellow-600 rounded p-3",children:[e.jsx("h4",{className:"text-yellow-300 font-bold mb-2",children:"üí° What This Means:"}),e.jsxs("ul",{className:"text-gray-200 text-sm space-y-1 list-disc list-inside",children:[e.jsxs("li",{children:["Shift starts at ",e.jsx("strong",{children:"10:00 AM"}),", reporting deadline is ",e.jsx("strong",{children:"10:15 AM"})]}),e.jsxs("li",{children:["You have a ",e.jsx("strong",{children:"30-minute grace window"})," (10:15 - 10:45 AM)"]}),e.jsxs("li",{children:["Grace period can be used ",e.jsx("strong",{children:"maximum 2 times per month"})]}),e.jsxs("li",{children:["After grace limit, late punch = ",e.jsx("strong",{children:"Half Day or based on working hours"})]}),void 0!==H.remaining_hours_possible&&e.jsxs("li",{children:["Remaining possible hours: ",e.jsxs("strong",{className:"text-cyan-400",children:[H.remaining_hours_possible," hrs"]})]})]})]})]})]})}),H?.has_missing_punch&&e.jsx("div",{className:"bg-gradient-to-r from-red-700/20 to-pink-700/20 border-2 border-red-500 rounded-lg p-5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-red-400 text-3xl",children:"‚ùå"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-red-400 text-lg mb-2",children:"ISSUE: MISSING PUNCH"}),e.jsx("p",{className:"text-gray-200 mb-3",children:H.missing_punch_message||"You have missing punch in/out records."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-800 border border-red-500 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-red-300 font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"üîç"}),e.jsx("span",{children:"Missing Records"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl "+(H.check_in_time?"‚úÖ":"‚ùå")}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Check In"}),e.jsx("div",{className:"font-semibold "+(H.check_in_time?"text-green-400":"text-red-400"),children:H.check_in_time||"MISSING"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl "+(H.check_out_time?"‚úÖ":"‚ùå")}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Check Out"}),e.jsx("div",{className:"font-semibold "+(H.check_out_time?"text-green-400":"text-red-400"),children:H.check_out_time||"MISSING"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-800 border border-red-500 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-red-300 font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"‚úèÔ∏è"}),e.jsx("span",{children:"How to Fix"})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-200",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-cyan-400 font-bold",children:"1."}),e.jsxs("span",{children:["Contact your ",e.jsx("strong",{children:"Team Leader"})," or ",e.jsx("strong",{children:"HR"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-cyan-400 font-bold",children:"2."}),e.jsx("span",{children:"Provide valid reason for missing punch"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-cyan-400 font-bold",children:"3."}),e.jsx("span",{children:"HR will manually correct the record"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-cyan-400 font-bold",children:"4."}),e.jsxs("span",{children:["Until fixed, this day is marked as ",e.jsx("strong",{className:"text-red-400",children:"Issue (ISS)"})]})]})]})]})]}),e.jsxs("div",{className:"mt-3 bg-red-900/40 border border-red-600 rounded p-3",children:[e.jsx("h4",{className:"text-red-300 font-bold mb-2",children:"‚ö†Ô∏è Important:"}),e.jsxs("p",{className:"text-gray-200 text-sm",children:["Days with missing punch are marked as ",e.jsx("strong",{className:"text-red-400",children:"Issue (ISS = 0 count)"}),". If you forgot to punch in/out, apply for ",e.jsx("strong",{children:"retroactive attendance correction"})," through your manager. HR can manually add/correct the punch records if valid reason is provided."]})]})]})]})}),!H?.is_late&&!H?.has_missing_punch&&H?.check_in_time&&e.jsx("div",{className:"bg-gradient-to-r from-green-700/20 to-emerald-700/20 border-2 border-green-500 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-green-400 text-2xl",children:"‚úÖ"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-green-400",children:"On-Time & Complete"}),e.jsxs("p",{className:"text-gray-300 text-sm",children:["Punched in on time at ",e.jsx("strong",{className:"text-cyan-400",children:H.check_in_time}),". No issues detected."]})]})]})})]}),"leave"===H?.type?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-orange-600 to-yellow-600 text-white p-4 rounded-lg",children:[e.jsx("h3",{className:"text-xl font-bold mb-2",children:"üèñÔ∏è LEAVE DETAILS"}),e.jsx("p",{className:"text-orange-100",children:"Employee is on approved leave for this date"})]}),H.leave_details&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"border border-gray-600 rounded-lg bg-gray-800",children:[e.jsx("div",{className:"bg-gray-700 p-3 border-b border-gray-600",children:e.jsx("h3",{className:"font-semibold text-gray-200",children:"LEAVE INFORMATION"})}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Leave Type:"}),e.jsx("span",{className:"text-orange-400 font-semibold",children:H.leave_details.leave_type_display})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Duration:"}),e.jsxs("span",{className:"text-green-400 font-semibold",children:[H.leave_details.duration_days," day(s)"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Status:"}),e.jsx("span",{className:"text-green-400 font-semibold uppercase",children:H.leave_details.status_display||H.leave_details.status})]}),H.leave_details.from_date&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"From Date:"}),e.jsx("span",{className:"text-cyan-400",children:t(H.leave_details.from_date)})]}),H.leave_details.to_date&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"To Date:"}),e.jsx("span",{className:"text-cyan-400",children:t(H.leave_details.to_date)})]})]})]}),e.jsxs("div",{className:"border border-gray-600 rounded-lg bg-gray-800",children:[e.jsx("div",{className:"bg-gray-700 p-3 border-b border-gray-600",children:e.jsx("h3",{className:"font-semibold text-gray-200",children:"REASON & APPROVAL"})}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 block mb-1",children:"Reason:"}),e.jsx("div",{className:"bg-gray-700 p-3 rounded border text-yellow-400",children:H.leave_details.reason||"No reason provided"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Approved By:"}),e.jsx("span",{className:"text-purple-400 font-semibold",children:H.leave_details.approved_by_name||"Unknown"})]}),H.leave_details.approved_at&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Approved At:"}),e.jsx("span",{className:"text-cyan-400",children:t(H.leave_details.approved_at)})]}),H.leave_details.approval_comments&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 block mb-1",children:"Approval Comments:"}),e.jsx("div",{className:"bg-gray-700 p-3 rounded border text-blue-400",children:H.leave_details.approval_comments})]})]})]})]}),H.leave_details?.leave_summary&&e.jsx("div",{className:"border border-orange-500 rounded-lg bg-gradient-to-r from-orange-900/20 to-yellow-900/20",children:e.jsxs("div",{className:"p-4",children:[e.jsx("h4",{className:"font-semibold text-orange-400 mb-2",children:"üìã Leave Summary"}),e.jsx("p",{className:"text-gray-200",children:H.leave_details.leave_summary})]})}),H.leave_details?.attachments&&H.leave_details.attachments.length>0&&e.jsxs("div",{className:"border border-gray-600 rounded-lg bg-gray-800",children:[e.jsx("div",{className:"bg-gray-700 p-3 border-b border-gray-600",children:e.jsx("h3",{className:"font-semibold text-gray-200",children:"üìé ATTACHMENTS"})}),e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"space-y-2",children:H.leave_details.attachments.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-700 p-3 rounded",children:[e.jsx("span",{className:"text-gray-200",children:s.filename||`Attachment ${a+1}`}),e.jsx("button",{onClick:()=>window.open(`${u}/media/${s.relative_path||s.file_path}`,"_blank"),className:"text-cyan-400 hover:text-cyan-300 underline",children:"View"})]},a))})})]})]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"border border-gray-600 rounded-lg bg-gray-800",children:[e.jsx("div",{className:"bg-gray-700 p-3 border-b border-gray-600",children:e.jsx("h3",{className:"font-semibold text-gray-200",children:"CHECK IN"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4 text-center mb-4",children:[H?.check_in_photo||H?.attendance_details?.check_in_photo_path?e.jsx("img",{src:`${u}/${H.check_in_photo||H.attendance_details.check_in_photo_path}`,alt:"Check-in photo",className:"w-full h-32 object-cover rounded-lg mx-auto mb-2",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="block"}}):null,e.jsxs("div",{className:H?.check_in_photo||H?.attendance_details?.check_in_photo_path?"hidden":"block",children:[e.jsx(h,{className:"h-16 w-16 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-400",children:"not found"})]})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-400",children:[e.jsxs("p",{className:"text-gray-300",children:["PUNCH IN DATE: ",W(o,y,n)]}),e.jsxs("p",{className:"text-gray-300",children:["PUNCH IN TIME: ",H?.check_in_time||H?.attendance_details?.check_in_time||"N/A"]}),H?.check_in_geolocation?.address&&"Unknown"!==H.check_in_geolocation.address&&e.jsxs("p",{className:"text-gray-300",children:["LOCATION: ",H.check_in_geolocation.address]}),H?.attendance_details?.check_in_geolocation?.address&&"Unknown"!==H.attendance_details.check_in_geolocation.address&&e.jsxs("p",{className:"text-gray-300",children:["LOCATION: ",H.attendance_details.check_in_geolocation.address]})]})]})]}),e.jsxs("div",{className:"border border-gray-600 rounded-lg bg-gray-800",children:[e.jsx("div",{className:"bg-gray-700 p-3 border-b border-gray-600",children:e.jsx("h3",{className:"font-semibold text-gray-200",children:"CHECK OUT"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4 text-center mb-4",children:[H?.check_out_photo||H?.attendance_details?.check_out_photo_path?e.jsx("img",{src:`${u}/${H.check_out_photo||H.attendance_details.check_out_photo_path}`,alt:"Check-out photo",className:"w-full h-32 object-cover rounded-lg mx-auto mb-2",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="block"}}):null,e.jsxs("div",{className:H?.check_out_photo||H?.attendance_details?.check_out_photo_path?"hidden":"block",children:[e.jsx(h,{className:"h-16 w-16 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-400",children:"not found"})]})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-400",children:[e.jsxs("p",{className:"text-gray-300",children:["PUNCH OUT DATE: ",W(o,y,n)]}),e.jsxs("p",{className:"text-gray-300",children:["PUNCH OUT TIME: ",H?.check_out_time||H?.attendance_details?.check_out_time||"N/A"]}),H?.check_out_geolocation?.address&&"Unknown"!==H.check_out_geolocation.address&&e.jsxs("p",{className:"text-gray-300",children:["LOCATION: ",H.check_out_geolocation.address]}),H?.attendance_details?.check_out_geolocation?.address&&"Unknown"!==H.attendance_details.check_out_geolocation.address&&e.jsxs("p",{className:"text-gray-300",children:["LOCATION: ",H.attendance_details.check_out_geolocation.address]})]})]})]})]})]}),"leave"!==H?.type&&e.jsxs("div",{className:"mt-6 bg-gradient-to-r from-teal-700/20 to-green-700/20 border-2 border-teal-500 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"text-teal-400 text-2xl",children:"‚è∞"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-teal-400 text-lg",children:"GRACE PERIOD TRACKING"}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Monitor late punch-in grace period usage"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-gray-200 font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"‚öôÔ∏è"}),e.jsx("span",{children:"Grace Period Settings"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Grace Window:"}),e.jsx("span",{className:"text-teal-400 font-semibold",children:"30 minutes"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Monthly Limit:"}),e.jsx("span",{className:"text-teal-400 font-semibold",children:"2 times"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Deadline:"}),e.jsx("span",{className:"text-orange-400 font-semibold",children:"10:15 AM"})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-700",children:e.jsx("p",{className:"text-xs text-gray-400",children:"üí° If you punch in within 30 minutes after the deadline (10:00 AM), it's considered grace period. After using 2 grace periods in a month, late punch = Half Day."})})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-gray-200 font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"üìä"}),e.jsx("span",{children:"This Month's Usage"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Grace Used:"}),e.jsxs("span",{className:"text-yellow-400 font-bold text-xl",children:[H?.grace_used_this_month||0," / 2"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-400",children:[e.jsx("span",{children:"Usage Progress"}),e.jsxs("span",{children:[Math.round((H?.grace_used_this_month||0)/2*100),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-300 "+((H?.grace_used_this_month||0)>=2?"bg-red-500":(H?.grace_used_this_month||0)>=1?"bg-yellow-500":"bg-green-500"),style:{width:`${Math.min((H?.grace_used_this_month||0)/2*100,100)}%`}})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Remaining:"}),e.jsx("span",{className:"font-bold text-xl "+(2-(H?.grace_used_this_month||0)>0?"text-green-400":"text-red-400"),children:Math.max(0,2-(H?.grace_used_this_month||0))})]}),(H?.grace_used_this_month||0)>=2&&e.jsx("div",{className:"bg-red-900/30 border border-red-500 rounded p-2 mt-2",children:e.jsx("p",{className:"text-red-400 text-xs font-semibold",children:"‚ö†Ô∏è Grace limit exhausted! Next late punch will be Half Day."})})]})]})]}),H?.grace_applied_today&&e.jsx("div",{className:"mt-4 bg-yellow-900/20 border-2 border-yellow-500 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-yellow-400 text-xl",children:"‚úÖ"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-yellow-400 font-bold mb-1",children:"Grace Period Used Today"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Punch In Time:"}),e.jsx("span",{className:"text-white font-semibold ml-2",children:H.check_in_time})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Minutes Late:"}),e.jsxs("span",{className:"text-orange-400 font-semibold ml-2",children:[H.minutes_late||0," mins"]})]})]}),e.jsx("p",{className:"text-gray-300 text-xs mt-2",children:"üí° This counts as one grace period usage for this month."})]})]})}),H?.grace_history&&H.grace_history.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"text-gray-200 font-semibold mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"üìú"}),e.jsx("span",{children:"Grace Usage History (This Month)"})]}),e.jsx("div",{className:"bg-gray-800 border border-gray-600 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-gray-300",children:"Date"}),e.jsx("th",{className:"px-3 py-2 text-left text-gray-300",children:"Punch In"}),e.jsx("th",{className:"px-3 py-2 text-left text-gray-300",children:"Minutes Late"}),e.jsx("th",{className:"px-3 py-2 text-left text-gray-300",children:"Status"})]})}),e.jsx("tbody",{children:H.grace_history.map((s,a)=>e.jsxs("tr",{className:"border-t border-gray-700 hover:bg-gray-750",children:[e.jsx("td",{className:"px-3 py-2 text-gray-200",children:s.date}),e.jsx("td",{className:"px-3 py-2 text-cyan-400",children:s.punch_in_time}),e.jsxs("td",{className:"px-3 py-2 text-orange-400",children:[s.minutes_late," mins"]}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("span",{className:"text-xs bg-yellow-600 text-white px-2 py-1 rounded",children:"Grace Applied"})})]},a))})]})})]})]}),"leave"!==H?.type&&e.jsxs("div",{className:"mt-6 space-y-4",children:[H?.sunday_sandwich_warning&&e.jsx("div",{className:"bg-gradient-to-r from-red-700/20 to-orange-700/20 border-2 border-red-500 rounded-lg p-5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-red-400 text-3xl",children:"‚ö†Ô∏è"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-red-400 text-lg mb-2",children:"SUNDAY SANDWICH RULE ALERT"}),e.jsx("p",{className:"text-gray-200 mb-3",children:H.sunday_sandwich_warning}),e.jsxs("div",{className:"bg-gray-800 border border-red-500 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-red-300 font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"üìä"}),e.jsx("span",{children:"Week Summary (Current Week)"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Total Days"}),e.jsx("div",{className:"text-white text-2xl font-bold",children:H.week_working_days?.total||6})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Present"}),e.jsx("div",{className:"text-green-400 text-2xl font-bold",children:H.week_working_days?.present||0})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Absent"}),e.jsx("div",{className:"text-red-400 text-2xl font-bold",children:H.week_working_days?.absent||0})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Required"}),e.jsx("div",{className:"text-yellow-400 text-2xl font-bold",children:"5"})]})]}),e.jsx("div",{className:"flex justify-between items-center gap-2",children:["Mon","Tue","Wed","Thu","Fri","Sat"].map((s,a)=>{const t=H.week_status?.[a]||"unknown";return e.jsx("div",{className:"flex-1 text-center",children:e.jsxs("div",{className:"rounded-lg p-2 "+("present"===t?"bg-green-600":"absent"===t?"bg-red-600":"leave"===t?"bg-blue-600":"bg-gray-700"),children:[e.jsx("div",{className:"text-xs text-white font-semibold",children:s}),e.jsx("div",{className:"text-xl mt-1",children:"present"===t?"‚úÖ":"absent"===t?"‚ùå":"leave"===t?"üèñÔ∏è":"‚ùì"})]})},s)})})]}),e.jsxs("div",{className:"mt-3 bg-red-900/40 border border-red-600 rounded p-3",children:[e.jsx("h4",{className:"text-red-300 font-bold mb-2",children:"üìã Rule Explanation:"}),e.jsxs("ul",{className:"text-gray-200 text-sm space-y-1 list-disc list-inside",children:[e.jsxs("li",{children:["If you work less than ",e.jsx("strong",{children:"5 days"})," in a week (Mon-Sat)"]}),e.jsxs("li",{children:["Then the ",e.jsx("strong",{children:"Sunday between that week"})," will be marked as ",e.jsx("strong",{children:"Absent (-1)"})]}),e.jsxs("li",{children:["This is called the ",e.jsx("strong",{children:'"Sunday Sandwich Rule"'})]}),e.jsx("li",{children:"Make sure to work at least 5 days to keep Sunday as a holiday!"})]})]})]})]})}),H?.pending_leave_alert&&e.jsx("div",{className:"bg-gradient-to-r from-orange-700/20 to-red-700/20 border-2 border-orange-500 rounded-lg p-5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-orange-400 text-3xl",children:"‚è≥"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-orange-400 text-lg mb-2",children:"PENDING LEAVE AUTO-CONVERSION ALERT"}),e.jsx("p",{className:"text-gray-200 mb-3",children:H.pending_leave_alert}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-800 border border-orange-500 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-orange-300 font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"üìù"}),e.jsx("span",{children:"Pending Leave Details"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Leave Type:"}),e.jsx("span",{className:"text-orange-400 font-semibold",children:H.pending_leave_type||"Sick Leave"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Applied On:"}),e.jsx("span",{className:"text-cyan-400",children:H.pending_leave_date||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Pending Since:"}),e.jsxs("span",{className:"text-yellow-400 font-bold",children:[H.pending_days||0," days"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Auto-convert After:"}),e.jsx("span",{className:"text-red-400 font-bold",children:"3 days"})]})]})]}),e.jsxs("div",{className:"bg-gray-800 border border-red-500 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-red-300 font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"‚è∞"}),e.jsx("span",{children:"Time Remaining"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-5xl font-bold text-red-400 mb-2",children:Math.max(0,3-(H.pending_days||0))}),e.jsx("div",{className:"text-gray-400 text-sm mb-3",children:"Days until auto-convert to Absconding"}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-4 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-yellow-500 to-red-500 transition-all duration-300",style:{width:`${Math.min((H.pending_days||0)/3*100,100)}%`}})}),(H.pending_days||0)>=3&&e.jsx("div",{className:"mt-3 text-red-400 font-bold text-sm",children:"‚ö†Ô∏è Will be auto-converted soon!"})]})]})]}),e.jsxs("div",{className:"mt-3 bg-orange-900/40 border border-orange-600 rounded p-3",children:[e.jsx("h4",{className:"text-orange-300 font-bold mb-2",children:"‚ö° Action Required:"}),e.jsxs("p",{className:"text-gray-200 text-sm",children:["If your pending leave is ",e.jsx("strong",{children:"not approved within 3 days"}),", it will be",e.jsx("strong",{className:"text-red-400",children:" automatically converted to Absconding (AB = -1)"}),". Please contact your reporting manager to approve the leave immediately."]})]})]})]})}),!H?.sunday_sandwich_warning&&!H?.pending_leave_alert&&e.jsx("div",{className:"bg-gradient-to-r from-green-700/20 to-teal-700/20 border-2 border-green-500 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-green-400 text-2xl",children:"‚úÖ"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-green-400",children:"All Clear!"}),e.jsx("p",{className:"text-gray-300 text-sm",children:"No pending alerts or warnings for this date."})]})]})})]}),"leave"!==H?.type&&Y()&&e.jsxs("div",{className:"mt-6 bg-gradient-to-r from-purple-700/20 to-pink-700/20 border-2 border-purple-500 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"text-purple-400 text-2xl",children:"‚úèÔ∏è"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-purple-400 text-lg",children:"MANUAL OVERRIDE BY HR/ADMIN"}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Manually update attendance status. Comment is mandatory."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Current Status:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[k(V),e.jsx("span",{className:"text-gray-200 font-semibold",children:S(V)})]})]}),H?.working_hours&&e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsx("span",{className:"text-gray-400",children:"Working Hours:"}),e.jsxs("span",{className:"text-cyan-400 font-semibold",children:[H.working_hours," hrs"]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-200 font-semibold mb-2",children:["SELECT NEW STATUS: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{value:N,onChange:e=>w(e.target.value),className:"w-full p-3 border-2 border-gray-600 rounded-lg bg-gray-800 text-gray-200 focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[e.jsx("option",{value:"",children:"-- Select New Attendance Status --"}),e.jsxs("optgroup",{label:"‚úÖ Positive Status",children:[e.jsx("option",{value:"P",children:"P - Present (Full Day = 1)"}),e.jsx("option",{value:"HD",children:"HD - Half Day (0.5)"})]}),e.jsxs("optgroup",{label:"‚ö†Ô∏è Late / Leave",children:[e.jsx("option",{value:"L",children:"L - Late (Check working hours)"}),e.jsx("option",{value:"LV",children:"LV - Leave Approved (0)"}),e.jsx("option",{value:"PL",children:"PL - Pending Leave (0)"})]}),e.jsxs("optgroup",{label:"üî¥ Negative Status",children:[e.jsx("option",{value:"AB",children:"AB - Absconding (-1)"}),e.jsx("option",{value:"ISS",children:"ISS - Issue (Missing Punch)"}),e.jsx("option",{value:"Z",children:"Z - Zero (Insufficient Hours)"})]}),e.jsx("optgroup",{label:"üîµ Holiday",children:e.jsx("option",{value:"H",children:"H - Holiday (0)"})})]}),N&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Attendance Count: "}),e.jsx("span",{className:"font-bold "+(A(N)>=1?"text-green-400":.5===A(N)?"text-yellow-400":A(N)<0?"text-red-400":"text-gray-400"),children:A(N)})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-200 font-semibold mb-2",children:["REASON / COMMENT: ",e.jsx("span",{className:"text-red-400",children:"* (Mandatory)"})]}),e.jsx("textarea",{value:P,onChange:e=>T(e.target.value),placeholder:"Enter reason for manual override (mandatory)...",rows:3,className:"w-full p-3 border-2 border-gray-600 rounded-lg bg-gray-800 text-gray-200 placeholder-gray-400 focus:ring-2 focus:ring-purple-500 focus:border-purple-500"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"‚ö†Ô∏è This comment will be saved in history with your name and timestamp."})]}),N&&!P.trim()&&e.jsx("div",{className:"bg-red-900/30 border border-red-500 rounded-lg p-3",children:e.jsx("p",{className:"text-red-400 text-sm font-semibold",children:"‚ö†Ô∏è Comment is mandatory for manual override!"})}),e.jsx("button",{onClick:z,disabled:!N||!P.trim()||O,className:"w-full py-3 rounded-lg font-bold text-white transition-all duration-200 "+(N&&P.trim()&&!O?"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 shadow-lg hover:shadow-xl":"bg-gray-600 cursor-not-allowed"),children:O?"‚è≥ UPDATING...":"‚úÖ UPDATE ATTENDANCE (MANUAL OVERRIDE)"})]})]}),"leave"===H?.type&&e.jsx("div",{className:"mt-6 bg-gradient-to-r from-orange-700/20 to-yellow-700/20 border border-orange-500 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-orange-400 text-2xl",children:"üèñÔ∏è"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-orange-400",children:"Employee is on Leave"}),e.jsx("p",{className:"text-gray-300 text-sm",children:"This is an approved leave record. Attendance cannot be modified for leave days."})]})]})}),"leave"!==H?.type&&!Y()&&e.jsx("div",{className:"mt-6 bg-gradient-to-r from-red-700/20 to-pink-700/20 border border-red-500 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-red-400 text-2xl",children:"üö´"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-red-400",children:"No Edit Permission"}),e.jsx("p",{className:"text-gray-300 text-sm",children:"own"===r("attendance")?"Regular employees cannot edit attendance records. Only managers and administrators can modify attendance data.":"You don't have permission to edit this attendance record. Contact your administrator for access."})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6",children:["leave"!==H?.type&&Y()&&e.jsx("button",{onClick:z,className:"bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 text-white px-6 py-2 w-full rounded-md transition-all duration-200 font-semibold",children:"UPDATE ATTENDANCE"}),e.jsx("button",{onClick:i,className:"bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white px-6 py-2 w-full rounded-md transition-all duration-200 font-semibold "+("leave"!==H?.type&&Y()?"":"col-span-2"),children:"CLOSE"})]}),e.jsxs("div",{className:"flex gap-4 mt-4",children:[e.jsx("button",{className:"bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white px-6 py-2 rounded-md transition-all duration-200 font-semibold",children:"leave"===H?.type?"üí¨ ADD COMMENTS":"üè† ADD COMMENTS"}),e.jsx("button",{onClick:()=>{D(!E)},className:"border border-gray-500 text-gray-300 px-6 py-2 bg-gray-800 rounded-md hover:bg-gray-700 transition-all duration-200 font-semibold",children:"üë§ HISTORY"})]}),e.jsxs("div",{className:"mt-6 border-t border-gray-700 pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-200 mb-4",children:"Comments"}),e.jsx("div",{className:"bg-gray-800 border border-gray-600 p-4 rounded-lg mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-600 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(g,{className:"h-6 w-6 text-gray-300"})}),e.jsxs("div",{className:"flex-1 flex gap-2",children:[e.jsx("input",{type:"text",value:P,onChange:e=>T(e.target.value),placeholder:"Add your comment here...",className:"flex-1 p-3 border border-gray-600 rounded-lg bg-gray-700 text-gray-200 placeholder-gray-400 focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500",onKeyPress:e=>"Enter"===e.key&&Z()}),e.jsxs("button",{onClick:Z,disabled:O,className:"bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 disabled:from-gray-600 disabled:to-gray-700 text-white px-4 py-3 flex items-center gap-2 flex-shrink-0 rounded-md transition-all duration-200 font-semibold",children:[e.jsx(p,{className:"h-4 w-4"}),O?"Sending...":"Send"]})]})]})}),e.jsx("div",{className:"space-y-4 max-h-60 overflow-y-auto",children:C.length>0?C.map((s,a)=>e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-gray-800 border border-gray-600 rounded-lg",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-600 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(g,{className:"h-6 w-6 text-gray-300"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-semibold text-cyan-400",children:s.user_name||s.user||"Unknown User"}),e.jsx("span",{className:"text-sm text-gray-400",children:s.created_at?t(s.created_at):s.timestamp})]}),e.jsx("p",{className:"text-gray-200",children:s.content||s.message})]})]},s._id||a)):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-400",children:"No comments yet. Be the first to add one!"})})})]}),E&&e.jsxs("div",{className:"mt-6 border-t border-gray-700 pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-200 mb-4",children:"History"}),e.jsx("div",{className:"overflow-x-auto bg-gray-800 rounded-lg border border-gray-600",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-700 text-cyan-400",children:[e.jsx("th",{className:"border border-gray-600 px-4 py-3 text-left font-semibold",children:"#"}),e.jsx("th",{className:"border border-gray-600 px-4 py-3 text-left font-semibold",children:"DATE"}),e.jsx("th",{className:"border border-gray-600 px-4 py-3 text-left font-semibold",children:"CREATED BY"}),e.jsx("th",{className:"border border-gray-600 px-4 py-3 text-left font-semibold",children:"CHANGES"})]})}),e.jsxs("tbody",{children:[I.map((s,a)=>e.jsxs("tr",{className:a%2==0?"bg-gray-800":"bg-gray-750",children:[e.jsx("td",{className:"border border-gray-600 px-4 py-3 text-gray-200",children:a+1}),e.jsx("td",{className:"border border-gray-600 px-4 py-3 text-gray-200",children:t(s.changed_at)}),e.jsx("td",{className:"border border-gray-600 px-4 py-3 text-gray-200",children:s.changed_by_name||"Unknown"}),e.jsxs("td",{className:"border border-gray-600 px-4 py-3 text-gray-200",children:[s.action," - ",void 0!==s.old_value?`${s.old_value} ‚Üí ${s.new_value}`:s.new_value]})]},s._id||a)),0===I.length&&e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"border border-gray-600 px-4 py-3 text-gray-400 text-center",children:"No history available"})})]})]})})]})]})]})})},P=(e,s,a,t,r)=>{let l=0,n=0,d=0,i=0,c=0,o=0;for(let m=1;m<=t;m++)switch(e[`day${m}`]){case"P":l++;break;case"L":n++;break;case"LV":d++;break;case"H":o++;break;case"HD":i++;break;case"AB":c++}const x=t-o;return{present:l,late:n,leave:d,halfDay:i,absconding:c,holidays:o,workingDays:x,attendancePercentage:x>0?((l+n+i)/x*100).toFixed(1):"0"}};function T(){const m=new Date,[h,g]=s.useState(m.getFullYear()),[p,y]=s.useState(m.getMonth()+1),[b,S]=s.useState([]),[A,T]=s.useState(!1),[I,$]=s.useState(null),[H,M]=s.useState(!1),[O,U]=s.useState(!1),[R,F]=s.useState(null),[Y,B]=s.useState(null),[V,G]=s.useState(null),[W,z]=s.useState(null),[Z,J]=s.useState([]),[q,K]=s.useState(""),[Q,X]=s.useState([]),[ee,se]=s.useState([]),[ae,te]=s.useState("calendar"),re=s.useRef(null),[le,ne]=s.useState(!1),[de,ie]=s.useState(!1);s.useEffect(()=>{const e=localStorage.getItem("userData");if(e){const s=JSON.parse(e);G(s)}},[]),s.useEffect(()=>{V?.user_id&&(async()=>{if(V?.user_id)try{const e=await w(h,null,V.user_id);e.success&&se(e.holidays||[])}catch(e){se([{_id:"1",date:"2025-01-01",name:"New Year's Day"},{_id:"2",date:"2025-01-26",name:"Republic Day"},{_id:"3",date:"2025-08-15",name:"Independence Day"},{_id:"4",date:"2025-12-25",name:"Christmas Day"}])}})()},[V,h]),s.useEffect(()=>{(async()=>{if(V?.user_id)try{const e=await(async e=>{try{return(await a.get(`${u}/attendance/permissions`,{params:{user_id:e},headers:j()})).data}catch(I){throw I}})(V.user_id);z(e)}catch(e){z({can_view_all:!1})}})()},[V]);const ce=s.useCallback(()=>{if(re.current){const{scrollLeft:e,scrollWidth:s,clientWidth:a}=re.current;ne(e>0),ie(e<s-a-1)}},[]),oe=s.useCallback(e=>{if(re.current){const s=300;re.current.scrollBy({left:"left"===e?-s:s,behavior:"smooth"}),setTimeout(ce,100)}},[ce]);s.useEffect(()=>{ce();const e=re.current;if(e)return e.addEventListener("scroll",ce),()=>{e.removeEventListener("scroll",ce)}},[ce]),s.useEffect(()=>{setTimeout(ce,100)},[b,ce]),r("attendance"),l();const xe=()=>n("attendance"),me=()=>xe(),he=()=>xe(),ge=e=>e?.employees?.length?e.employees.map(e=>{const s={id:e.employee_id,name:e.employee_name,employeeId:e.employee_code||e.employee_number||e.empId||`EMP-${e.employee_id?.slice(-6)||"UNKNOWN"}`,department:e.department_name||"Unknown Department",role:e.role_name||"",photo:e.employee_photo};return e.days.forEach(e=>{const a=`day${e.day}`;if(null!==e.status&&void 0!==e.status){const t=parseFloat(e.status);1.5===t?s[a]="H":1===t||1===t?s[a]="P":.5===t?s[a]="HD":0===t||0===t?s[a]="LV":-1===t||-1===t?s[a]="":-2===t||-2===t?s[a]="AB":"L"===e.status?s[a]="L":s[a]=""}else e.is_weekend?s[a]="W":e.is_holiday?s[a]="H":s[a]=""}),s}):[];s.useEffect(()=>{(async()=>{if(V?.user_id){T(!0),$(null);try{const e=await N(h,p,V.user_id);if(e&&e.employees){const s=ge(e);S(s)}else S([])}catch(e){$("Failed to load attendance data. Please try again."),S([])}finally{T(!1)}}})()},[h,p,V]);const pe=new Date(h,p,0).getDate(),ye=e=>{"prev"===e?1===p?(y(12),g(h-1)):y(p-1):12===p?(y(1),g(h+1)):y(p+1)};return A||V&&null===W&&!me()?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-black",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-500 mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]}),e.jsx("span",{className:"text-white text-lg",children:null===W?"Loading permissions...":"Loading attendance data..."})]})}):I?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-black",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-red-500 text-lg mb-2",children:I}),e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Retry"})]})}):e.jsxs("div",{className:"w-full p-6 space-y-6 bg-black min-h-screen",children:[e.jsx("div",{className:"bg-black rounded-lg p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[e.jsx("div",{}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>ye("prev"),className:"border border-gray-600 bg-black text-white hover:bg-gray-800 px-3 py-2 rounded-md transition-colors",children:e.jsx(d,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-2 min-w-[200px] justify-center",children:[e.jsx(i,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"font-semibold text-lg text-white",children:[D[p-1]," ",h]})]}),e.jsx("button",{onClick:()=>ye("next"),className:"border border-gray-600 bg-black text-white hover:bg-gray-800 px-3 py-2 rounded-md transition-colors",children:e.jsx(c,{className:"h-4 w-4"})})]}),he()&&e.jsxs("button",{onClick:()=>U(!0),className:"border border-gray-600 bg-black text-white hover:bg-gray-800 px-3 py-2 rounded-md transition-colors flex items-center gap-2",children:[e.jsx(i,{className:"h-4 w-4 mr-2"}),"Holidays"]}),e.jsxs("button",{onClick:()=>((e,s,a,r)=>{const l=new Date(s,a,0).getDate();let n=`\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <title>Monthly Attendance Report - ${D[a-1]} ${s}</title>\n      <style>\n        body { font-family: Arial, sans-serif; margin: 20px; }\n        .header { text-align: center; margin-bottom: 20px; }\n        .info { margin-bottom: 15px; font-size: 12px; }\n        table { width: 100%; border-collapse: collapse; font-size: 10px; }\n        th, td { border: 1px solid #ddd; padding: 4px; text-align: center; }\n        th { background-color: #2980b9; color: white; font-weight: bold; }\n        .employee-info { text-align: left; min-width: 120px; }\n        .summary { text-align: left; font-size: 9px; }\n        .status-P { background-color: #10b981; color: white; font-weight: bold; }\n        .status-A { background-color: #ef4444; color: white; font-weight: bold; }\n        .status-L { background: linear-gradient(135deg, #eab308, #f97316); color: white; font-weight: bold; }\n        .status-LV { background-color: #f97316; color: white; font-weight: bold; }\n        .status-H { background-color: #3b82f6; color: white; font-weight: bold; }\n        .status-HD { background-color: #eab308; color: white; font-weight: bold; }\n        .status-AB { background-color: #ef4444; color: white; font-weight: bold; }\n        .legend { margin-top: 20px; font-size: 11px; }\n        .legend-item { display: inline-block; margin-right: 15px; margin-bottom: 5px; }\n        .legend-color { display: inline-block; width: 20px; height: 15px; margin-right: 5px; vertical-align: middle; }\n        .monthly-summary { margin-top: 20px; font-size: 12px; }\n        @media print { body { margin: 10px; } }\n      </style>\n    </head>\n    <body>\n      <div class="header">\n        <h2></h2>\n        <h3>${D[a-1]} ${s}</h3>\n      </div>\n      \n      <div class="info">\n        <strong>Generated on:</strong> ${t(new Date)}<br>\n  `;const d=r.filter(e=>{const t=new Date(e.date);return t.getFullYear()===s&&t.getMonth()+1===a});d.length>0&&(n+=`<strong>Company Holidays:</strong> ${d.map(e=>e.name).join(", ")}<br>`),n+='\n      </div>\n      \n      <table>\n        <thead>\n          <tr>\n            <th class="employee-info">Employee Details</th>\n  ';for(let t=1;t<=l;t++){const e=E(s,a,t);n+=`<th>${t}<br><small>${e.substring(0,3)}</small></th>`}n+="\n            <th>Present</th>\n            <th>Late</th>\n            <th>Half Day</th>\n            <th>Holidays</th>\n            <th>Absconding</th>\n            <th>Attendance %</th>\n          </tr>\n        </thead>\n        <tbody>\n  ",e.forEach(e=>{const s=P(e,0,0,l);n+=`\n      <tr>\n        <td class="employee-info">\n          <strong>${e.name}</strong><br>\n          <small>${e.employeeId}</small><br>\n          <small>${e.department}</small>\n        </td>\n    `;for(let a=1;a<=l;a++){const s=e[`day${a}`]||"-";n+=`<td class="status-${s}">${s}</td>`}n+=`\n        <td>${s.present}</td>\n        <td>${s.late}</td>\n        <td>${s.halfDay}</td>\n        <td>${s.holidays}</td>\n        <td>${s.absconding}</td>\n        <td>${s.attendancePercentage}%</td>\n      </tr>\n    `}),n+='\n        </tbody>\n      </table>\n      \n      <div class="legend">\n        <h4>Legend:</h4>\n        <div class="legend-item">\n          <span class="legend-color" style="background-color: #10b981;"></span>P = Present\n        </div>\n        <div class="legend-item">\n          <span class="legend-color" style="background: linear-gradient(135deg, #eab308, #f97316);"></span>L = Late\n        </div>\n        <div class="legend-item">\n          <span class="legend-color" style="background-color: #f97316;"></span>LV = Leave Approved\n        </div>\n        <div class="legend-item">\n          <span class="legend-color" style="background-color: #ffffff; border: 2px solid #9ca3af;"></span>PL = Pending Leave\n        </div>\n        <div class="legend-item">\n          <span class="legend-color" style="background-color: #3b82f6;"></span>H = Holiday\n        </div>\n        <div class="legend-item">\n          <span class="legend-color" style="background-color: #eab308;"></span>HD = Half Day\n        </div>\n        <div class="legend-item">\n          <span class="legend-color" style="background-color: #ef4444;"></span>AB = Absconding\n        </div>\n        <div class="legend-item">\n          <span class="legend-color" style="background-color: #000000;"></span>ISS = Issue (Missing Punch)\n        </div>\n        <div class="legend-item">\n          <span class="legend-color" style="background-color: #000000;"></span>0 = Zero (Insufficient Hours)\n        </div>\n      </div>\n      \n      <div class="monthly-summary">\n        <h4>Monthly Summary:</h4>\n  ';const i=e.reduce((e,s)=>e+P(s,0,0,l).present,0),c=e.reduce((e,s)=>e+P(s,0,0,l).late,0),o=(e.reduce((e,s)=>{const a=P(s,0,0,l);return e+Number.parseFloat(a.attendancePercentage)},0)/e.length).toFixed(1);n+=`\n        <p><strong>Total Present Days:</strong> ${i}</p>\n        <p><strong>Total Late Days:</strong> ${c}</p>\n        <p><strong>Average Attendance:</strong> ${o}%</p>\n      </div>\n    </body>\n    </html>\n  `;const x=new Blob([n],{type:"text/html"}),m=URL.createObjectURL(x),h=document.createElement("a");h.href=m,h.download=`Attendance_Report_${D[a-1]}_${s}.html`,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(m);const g=window.open("","_blank");g.document.write(n),g.document.close(),setTimeout(()=>{g.print()},500)})(b,h,p,ee),className:"border border-gray-600 bg-black text-white hover:bg-gray-800 px-3 py-2 rounded-md transition-colors flex items-center gap-2",children:[e.jsx(o,{className:"h-4 w-4 mr-2"}),"Export"]})]})]})}),e.jsx("div",{className:"bg-black rounded-lg p-4 ",children:e.jsxs("div",{className:"flex flex-wrap gap-6 items-center justify-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-green-500 rounded"}),e.jsx("span",{className:"text-sm font-medium text-white",children:"Present (P)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-yellow-500 to-orange-500 rounded"}),e.jsx("span",{className:"text-sm font-medium text-white",children:"Late (L)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-orange-500 rounded"}),e.jsx("span",{className:"text-sm font-medium text-white",children:"Leave (LV)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded"}),e.jsx("span",{className:"text-sm font-medium text-white",children:"Holiday (H)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-yellow-500 rounded"}),e.jsx("span",{className:"text-sm font-medium text-white",children:"Half Day (HD)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-red-500 rounded"}),e.jsx("span",{className:"text-sm font-medium text-white",children:"Absconding (AB)"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-black rounded-lg p-6 border border-gray-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-400",children:b.reduce((e,s)=>e+P(s,0,0,pe).present,0)}),e.jsx("div",{className:"text-sm text-gray-300 mt-1",children:"Total Present Days"})]})}),e.jsx("div",{className:"bg-black rounded-lg p-6 border border-gray-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-400",children:b.reduce((e,s)=>e+P(s,0,0,pe).late,0)}),e.jsx("div",{className:"text-sm text-gray-300 mt-1",children:"Total Late Days"})]})}),e.jsx("div",{className:"bg-black rounded-lg p-6 border border-gray-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-orange-400",children:b.reduce((e,s)=>e+P(s,0,0,pe).leave,0)}),e.jsx("div",{className:"text-sm text-gray-300 mt-1",children:"Total Leave Days"})]})}),e.jsx("div",{className:"bg-black rounded-lg p-6 border border-gray-700",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-blue-400",children:[(b.reduce((e,s)=>{const a=P(s,0,0,pe);return e+Number.parseFloat(a.attendancePercentage)},0)/b.length).toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-gray-300 mt-1",children:"Average Attendance"})]})})]}),e.jsx("div",{className:"bg-black rounded-lg overflow-hidden shadow-2xl",children:e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>oe("left"),className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-white p-4 rounded-full shadow-lg transition-all duration-200 opacity-80 hover:opacity-100",style:{backgroundColor:"rgba(37, 99, 235, 1)",zIndex:9999},onMouseEnter:e=>e.target.style.backgroundColor="rgba(29, 78, 216, 1)",onMouseLeave:e=>e.target.style.backgroundColor="rgba(37, 99, 235, 1)","aria-label":"Scroll left",children:e.jsx(d,{className:"w-9 h-9"})}),e.jsx("button",{onClick:()=>oe("right"),className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-white p-4 rounded-full shadow-lg transition-all duration-200 opacity-80 hover:opacity-100",style:{backgroundColor:"rgba(37, 99, 235, 1)",zIndex:9999},onMouseEnter:e=>e.target.style.backgroundColor="rgba(29, 78, 216, 1)",onMouseLeave:e=>e.target.style.backgroundColor="rgba(37, 99, 235, 1)","aria-label":"Scroll right",children:e.jsx(c,{className:"w-9 h-9"})}),e.jsx("div",{ref:re,className:"overflow-x-auto",onScroll:ce,children:e.jsxs("table",{className:"w-full bg-black border-collapse border border-gray-700",style:{minWidth:"1200px"},children:[e.jsx("thead",{style:{backgroundColor:"#03b0f5"},children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 px-4 py-1 text-left font-bold text-white min-w-[200px] border border-gray-300",style:{backgroundColor:"#03b0f5"},children:"Employee Details"}),Array.from({length:pe},(e,s)=>s+1).map(s=>e.jsx("th",{className:"px-3 py-1 text-center font-bold text-white min-w-[50px] border border-gray-300",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-sm font-bold",children:s}),e.jsx("span",{className:"text-xs text-blue-100 opacity-80",children:E(h,p,s)})]})},s)),e.jsx("th",{className:"px-4 py-1 text-center font-bold text-white border border-gray-300 min-w-[140px]",children:"Summary"})]})}),e.jsx("tbody",{className:"bg-black",children:b.map((s,a)=>{const t=P(s,0,0,pe);return e.jsxs("tr",{className:"bg-black hover:bg-gray-800 transition-colors border-b border-gray-700",children:[e.jsx("td",{className:"sticky left-0 bg-black px-4 py-5 border border-gray-600 cursor-pointer hover:bg-gray-700 transition-colors",onClick:()=>(F(s),B(1),void M(!0)),children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-semibold text-white text-base",children:s.name}),e.jsx("div",{className:"text-sm text-blue-300 font-medium",children:s.employeeId}),e.jsx("div",{className:"text-sm text-gray-400",children:s.department})]})}),Array.from({length:pe},(e,s)=>s+1).map(a=>e.jsx("td",{className:"px-2 py-2 text-center cursor-pointer hover:bg-gray-700 border border-gray-600 transition-colors",onClick:()=>(async(e,s)=>{if(V?.user_id){F(e),B(s),M(!0),T(!0);try{const t=`${h}-${String(p).padStart(2,"0")}-${String(s).padStart(2,"0")}`,r=await f(e.id,t,V.user_id);try{const s=await v(e.id,t,V.user_id);J(s.comments||[])}catch(a){J([])}try{const s=await _(e.id,t,V.user_id);X(s.history||[])}catch(a){X([])}F({...e,attendanceDetail:r})}catch(a){}T(!1),B(s),M(!0)}})(s,a),children:k(s[`day${a}`])},a)),e.jsx("td",{className:"px-4 py-3 border border-gray-600",children:e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-300",children:"Present:"}),e.jsx("span",{className:"font-bold text-green-400",children:t.present})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-300",children:"Late:"}),e.jsx("span",{className:"font-bold text-yellow-400",children:t.late})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-300",children:"Leave:"}),e.jsx("span",{className:"font-bold text-orange-400",children:t.leave})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-300",children:"Half Day:"}),e.jsx("span",{className:"font-bold text-cyan-400",children:t.halfDay})]}),t.holidays>0&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-300",children:"Holidays:"}),e.jsx("span",{className:"font-bold text-blue-400",children:t.holidays})]}),t.absconding>0&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-300",children:"Absconding:"}),e.jsx("span",{className:"font-bold text-red-400",children:t.absconding})]}),e.jsx("div",{className:"border-t border-gray-600 pt-1 mt-2",children:e.jsxs("div",{className:"flex justify-between items-center font-semibold",children:[e.jsx("span",{className:"text-gray-300",children:"Attendance:"}),e.jsxs("span",{className:Number.parseFloat(t.attendancePercentage)>=90?"text-green-400":Number.parseFloat(t.attendancePercentage)>=75?"text-yellow-400":"text-red-400",children:[t.attendancePercentage,"%"]})]})})]})})]},s.id)})})]})})]})}),e.jsx(L,{employee:R,selectedDate:Y,selectedYear:h,selectedMonth:p,isOpen:H,onClose:()=>M(!1),onUpdate:(e,s,a)=>{S(t=>t.map(t=>t.id===e?{...t,[`day${s}`]:a}:t))},canUserEdit:e=>"own"!==r("attendance")&&x("attendance",e)}),e.jsx(C,{isOpen:O,onClose:()=>U(!1),holidays:ee,onUpdateHolidays:async e=>{if(se(e),V?.user_id&&(null!==W||me()))try{const e=await N(h,p,V.user_id);if(e&&e.employees){let s=ge(e);he()||(s=s.filter(e=>e.id===V.user_id)),S(s)}}catch(s){}},selectedYear:h,selectedMonth:p})]})}export{T as default};
