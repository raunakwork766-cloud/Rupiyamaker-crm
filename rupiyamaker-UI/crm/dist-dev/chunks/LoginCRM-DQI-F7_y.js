const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["chunks/LeadDetails-CauQVyUH.js","chunks/lead-components-CFe8eyn0.js","chunks/vendor-mui-C1GmDdcn.js","chunks/vendor-react-EzoxUMNY.js","chunks/vendor-utils-QXd9EeNt.js","chunks/vendor-antd-BB3a0mYC.js","chunks/task-components-CHE2_wEo.js","chunks/employee-components-Cf-1_awe.js","chunks/vendor-office-CbbGW2MO.js","styles/employee-components-CAryrO_Y.css","styles/task-components-DguWJUkH.css","chunks/AboutSection-rplupIym.js","chunks/HowToProcessSection-B4y7S0l5.js","assets/main-C1InxIxT.js","styles/main-CIIU-HSH.css","chunks/Attachments-CBTu7SM4.js","chunks/TaskSectionInLead-BU704pBp.js","chunks/ImportantQuestionsSection-B14mattr.js","chunks/OperationsSection-DIbPgI8h.js","chunks/RequestReassignmentButton-CJN-CsBI.js","chunks/leadApiHelper-Bq4A4HGf.js"])))=>i.map(i=>d[i]);
import{v as e,ar as t,q as a,f as s,as as n,T as l,e as r,o,p as i,F as c,h as d,d as m,U as u,c as x,t as h,X as g,at as p,au as y,av as b,aw as f,ax as j,ay as N,az as w,aA as v,aB as _,aC as S,g as k,r as L,_ as C}from"./lead-components-CFe8eyn0.js";import{j as T}from"./vendor-mui-C1GmDdcn.js";import{R as I,r as A}from"./vendor-react-EzoxUMNY.js";import{a as D}from"./employee-components-Cf-1_awe.js";import{F as E,s as O,k as B,M as $,B as F,D as R,C as M,e as P,w as U,x as G,I as z,r as H,y as W,T as K,z as V}from"./vendor-antd-BB3a0mYC.js";import"./vendor-utils-QXd9EeNt.js";import"./vendor-office-CbbGW2MO.js";(()=>{try{const e=new URLSearchParams(window.location.search).get("lead_id");if(e&&(sessionStorage.setItem("directViewLoginId",e),window.history&&window.history.replaceState)){const e=window.location.pathname;window.history.replaceState({},document.title,e)}}catch(e){}})();const Y=A.lazy(()=>C(()=>import("./LeadDetails-CauQVyUH.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]))),q=A.lazy(()=>C(()=>import("./OperationsSection-DIbPgI8h.js"),__vite__mapDeps([18,2,3,4,5,1]))),J="/api",{Option:Q}=P,{Search:X}=z,{Title:Z,Text:ee}=K,{confirm:te}=$,{TabPane:ae}=V,se=[{key:"Active Login",label:"ACTIVE LOGIN",icon:a,gradient:"from-blue-500 to-cyan-400",shadowColor:"shadow-blue-500/25"},{key:"Approve",label:"APPROVED",icon:s,gradient:"from-green-500 to-emerald-400",shadowColor:"shadow-green-500/25"},{key:"Disbursed",label:"DISBURSED",icon:n,gradient:"from-purple-500 to-violet-400",shadowColor:"shadow-purple-500/25"},{key:"Lost by Mistake",label:"LOST BY MISTAKE",icon:l,gradient:"from-orange-500 to-amber-400",shadowColor:"shadow-orange-500/25"},{key:"Lost Login",label:"LOST LOGIN",icon:r,gradient:"from-red-500 to-pink-400",shadowColor:"shadow-red-500/25"}],ne=e=>{if(null==e||""===e)return"-";if(0===e)return"â‚¹0";let t;try{if("string"==typeof e){const a=e.replace(/[^\d.-]/g,"");t=parseFloat(a)}else t=parseFloat(e);if(!isNaN(t))return`â‚¹${t.toLocaleString()}`}catch(a){}return"-"},le=(e,t)=>{if(!e)return"";switch(t){case"customer_name":return e.first_name||e.last_name?`${e.first_name||""} ${e.last_name||""}`.trim():e.customer_name||e.name||"";case"login_date":return e.login_date||e.login_created_at||e.login_department_sent_date||e.created_date||e.created_at||"";case"creator_name":return e.created_by_name||e.creator_name||"";case"team_name":return e.department_name||e.team_name||"";case"salary":return e.dynamic_fields?.financial_details?.monthly_income?e.dynamic_fields.financial_details.monthly_income:e.salary||e.monthly_income||"";case"total_income":return e.dynamic_fields?.financial_details?.total_income?e.dynamic_fields.financial_details.total_income:e.dynamic_fields?.financial_details?.monthly_income?e.dynamic_fields.financial_details.monthly_income:e.total_income||e.salary||e.monthly_income||"";case"cibil_score":return e.dynamic_fields?.financial_details?.cibil_score?e.dynamic_fields.financial_details.cibil_score:e.cibil_score||"";case"city":return e.dynamic_fields?.address?.city?e.dynamic_fields.address.city:e.city||"";case"pincode":return e.dynamic_fields?.address?.pincode?e.dynamic_fields.address.pincode:e.dynamic_fields?.address?.postal_code?e.dynamic_fields.address.postal_code:e.pincode||"";case"company_name":return e.dynamic_fields?.personal_details?.company_name?e.dynamic_fields.personal_details.company_name:e.company_name||"";case"company_category":if(e.dynamic_fields?.personal_details?.company_category){const t=e.dynamic_fields.personal_details.company_category;return Array.isArray(t)?t.join(", "):t}return e.company_category||"";case"loan_eligibility":return e.dynamic_fields?.eligibility_details?.finalEligibility?e.dynamic_fields.eligibility_details.finalEligibility:e.dynamic_fields?.check_eligibility?.loan_eligibility_status?e.dynamic_fields.check_eligibility.loan_eligibility_status:e.loan_eligibility||e.eligibility||"";case"amount_approved":return e.operations_amount_approved||e.amount_approved||"";case"foir_eligibility":case"foir":return e.dynamic_fields?.eligibility_details?.finalEligibility?e.dynamic_fields.eligibility_details.finalEligibility:e.dynamic_fields?.eligibility_details?.final_eligibility?e.dynamic_fields.eligibility_details.final_eligibility:e.dynamic_fields?.eligibility_details?.foir_eligibility?e.dynamic_fields.eligibility_details.foir_eligibility:e.dynamic_fields?.eligibility?.finalEligibility?e.dynamic_fields.eligibility.finalEligibility:e.dynamic_fields?.eligibility?.final_eligibility?e.dynamic_fields.eligibility.final_eligibility:e.eligibility?.finalEligibility?e.eligibility.finalEligibility:e.eligibility?.final_eligibility?e.eligibility.final_eligibility:e.foir_eligibility||e.final_eligibility||e.foir||"";case"net_disbursement_amount":return e.net_disbursement_amount||e.operations_net_disbursement_amount||"";default:return void 0!==e[t]&&""!==e[t]?e[t]:e.dynamic_fields&&void 0!==e.dynamic_fields[t]&&""!==e.dynamic_fields[t]?e.dynamic_fields[t]:""}},re=I.memo(({user:s,selectedLoanType:n,department:r="login"})=>{A.useEffect(()=>{localStorage.setItem("userDepartment","login")},[]);const[C,K]=A.useState(()=>{try{const e=localStorage.getItem("userPermissions");return e?JSON.parse(e):{}}catch{return{}}}),[V,X]=A.useState(!1),[Z,ee]=A.useState(()=>{try{const e=localStorage.getItem("userPermissions");if(e){const t=JSON.parse(e);return!!Array.isArray(t)&&t.some(e=>"*"===e.page&&("*"===e.actions||Array.isArray(e.actions)&&e.actions.includes("*")))}}catch{return!1}return!1}),te=localStorage.getItem("userId"),ae=e=>{const t=k();if(L(t,"login",e))return!0;if(Array.isArray(t)){const a=t.find(e=>"login"===e.page);if(a){if(Array.isArray(a.actions))return a.actions.includes(e)||a.actions.includes("*");if("*"===a.actions)return!0}}if(t&&"object"==typeof t&&!Array.isArray(t)){if("*"===t["*"]||"*"===t.Global||"*"===t.global||"*"===t.pages&&"*"===t.actions)return!0;const a=t.Login,s=t.login;if("*"===a||"*"===s)return!0;if(Array.isArray(a)&&a.includes(e))return!0;if(Array.isArray(s)&&s.includes(e))return!0}return!1},re=()=>ae("delete"),oe=()=>ae("edit"),ie=e=>Array.isArray(e)?e.some(e=>"*"===e.page&&("*"===e.actions||Array.isArray(e.actions)&&e.actions.includes("*"))):"*"===e.pages&&"*"===e.actions||"*"===e.Global||"*"===e.global;A.useEffect(()=>{setTimeout(()=>{(async()=>{try{const e=localStorage.getItem("userPermissions");if(e){const t=JSON.parse(e);return K(t),ee(ie(t)),void X(!1)}const t=await fetch(`${J}/users/permissions/${te}`),a=await t.json(),s=Array.isArray(a)?a:a.permissions||a||[];localStorage.setItem("userPermissions",JSON.stringify(s)),K(s),ee(ie(s))}catch(e){}finally{X(!1)}})()},0)},[te]),A.useEffect(()=>{ca||ma.current||setTimeout(()=>{ma.current=!0,Ws()},100)},[]);const[ce,de]=A.useState(()=>n||localStorage.getItem("loginCrmLoanTypeId")||"all");A.useEffect(()=>{const e=e=>{const{loanTypeId:t,loanTypeName:a,cleanLoanTypeName:s}=e.detail;de(t),s&&localStorage.setItem("loginCrmCleanLoanTypeName",s)};window.addEventListener("loginCrmLoanTypeChanged",e);const t=localStorage.getItem("loginCrmLoanTypeId");return t&&de(t),()=>{window.removeEventListener("loginCrmLoanTypeChanged",e)}},[]);const[me,ue]=A.useState([]),[xe,he]=A.useState([]),[ge,pe]=A.useState(!1),[ye,be]=A.useState(!1),[fe,je]=A.useState(50),[Ne,we]=A.useState("all"),[ve,_e]=A.useState(""),Se=function(e){const[t,a]=A.useState(e);return A.useEffect(()=>{const t=setTimeout(()=>{a(e)},300);return()=>{clearTimeout(t)}},[e,300]),t}(ve),[ke,Le]=A.useState(null),[Ce,Te]=A.useState(!1),[Ie,Ae]=A.useState(!1),[De,Ee]=A.useState(!1),[Oe,Be]=A.useState(!1),[$e,Fe]=A.useState(!1),[Re,Me]=A.useState(!1),[Pe,Ue]=A.useState(!1),[Ge,ze]=A.useState(0),[He,We]=A.useState(0),[Ke,Ve]=A.useState(["HDFC Bank","ICICI Bank","SBI Bank","Axis Bank"]),[Ye,qe]=A.useState([]),[Je,Qe]=A.useState(!1),[Xe,Ze]=A.useState([]),[et,tt]=A.useState(!1),[at,st]=A.useState([]),[nt,lt]=A.useState(!1),[rt,ot]=A.useState(!1),[it,ct]=A.useState(!1),dt=A.useRef(null),[mt,ut]=A.useState(!1),[xt,ht]=A.useState(!1),[gt,pt]=A.useState(null),[yt,bt]=A.useState(null),[ft,jt]=A.useState([]),[Nt,wt]=A.useState([]),[vt,_t]=A.useState([]),[St,kt]=A.useState([]),[Lt,Ct]=A.useState({}),[Tt,It]=A.useState([]),[At,Dt]=A.useState(!1),[Et,Ot]=A.useState([]),[Bt,$t]=A.useState(!1),[Ft,Rt]=A.useState(null),[Mt,Pt]=A.useState(""),[Ut,Gt]=A.useState(""),[zt,Ht]=A.useState([]),[Wt,Kt]=A.useState(null),[Vt,Yt]=A.useState({top:0,left:0,maxHeight:400}),[qt,Jt]=A.useState(""),[Qt,Xt]=A.useState(null),[Zt,ea]=A.useState(!0),[ta,aa]=A.useState([]),[sa,na]=A.useState([]),[la,ra]=A.useState({}),[oa,ia]=A.useState({}),[ca,da]=A.useState(!1),ma=A.useRef(!1),[ua,xa]=A.useState(!1),[ha,ga]=A.useState(!1),[pa,ya]=A.useState(!1),[ba,fa]=A.useState(!1),[ja,Na]=A.useState(!1),[wa,va]=A.useState({}),[_a,Sa]=A.useState({}),[ka,La]=A.useState(!1),[Ca,Ta]=A.useState({"0-1":!0,"0-2":!0,"0-3":!0,"0-4":!0}),Ia=async(e,t,a=!1)=>{if(ke){if(!(await(async e=>{try{const t=localStorage.getItem("userId");return(await fetch(`${J}/lead-login/login-leads/${e}?user_id=${t}`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).ok}catch(t){return!1}})(ke._id)))return O.warning("âš ï¸ This lead no longer exists. Refreshing the list..."),Le(null),Ue(!1),void Ns();try{La(!0);const s=localStorage.getItem("userId"),n=`/api/lead-login/login-leads/${ke._id}?user_id=${s}`;let l={};l="co_applicant_form"===e||"applicant_form"===e?{dynamic_fields:{...ke.dynamic_fields,[e]:t}}:{[e]:t};const r=await fetch(n,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(l)});if(!r.ok){if(404===r.status)return O.warning("âš ï¸ This lead may have been deleted. Please refresh the page."),Le(null),Ue(!1),void Ns();const e=await r.text();throw new Error(`HTTP error! status: ${r.status}, message: ${e}`)}va(t=>{const a={...t};return delete a[e],a});const o=await r.json();o&&o._id&&(Le(o),ue(e=>e.map(e=>e._id===o._id?o:e))),a||O.success("âœ… Changes saved successfully",1)}catch(s){if(s.message.includes("404"))return O.error("âš ï¸ Lead not found. It may have been deleted."),Le(null),Ue(!1),void Ns();s.message.includes("403")?O.error("ðŸ”’ You do not have permission to edit this lead"):s.message.includes("401")?O.error("ðŸ” Session expired. Please login again."):O.error(`âŒ Failed to save ${e}: ${s.message}`),Le(t=>{const a={...t};return"co_applicant_form"===e?(a.dynamic_fields&&delete a.dynamic_fields.co_applicant_form,delete a.coApplicantForm):"applicant_form"===e?(a.dynamic_fields&&delete a.dynamic_fields.applicant_form,delete a.loginForm):delete a[e],a})}finally{La(!1)}}},Aa=(e,t,a=!1,s=2e3)=>{if(ke)if(Le(a=>{const s={...a};return"co_applicant_form"===e?(s.dynamic_fields||(s.dynamic_fields={}),s.dynamic_fields.co_applicant_form=t,s.coApplicantForm=t):"applicant_form"===e?(s.dynamic_fields||(s.dynamic_fields={}),s.dynamic_fields.applicant_form=t,s.loginForm=t):s[e]=t,s}),ue(a=>a.map(a=>a._id===ke._id?{...a,[e]:t,..."co_applicant_form"===e&&{dynamic_fields:{...a.dynamic_fields,co_applicant_form:t},coApplicantForm:t},..."applicant_form"===e&&{dynamic_fields:{...a.dynamic_fields,applicant_form:t},loginForm:t}}:a)),va(a=>({...a,[e]:t})),_a[e]&&clearTimeout(_a[e]),s>0){const n=setTimeout(()=>{Ia(e,t,a)},s);Sa(t=>({...t,[e]:n}))}else Ia(e,t,a)};A.useEffect(()=>()=>{Object.values(_a).forEach(e=>{e&&clearTimeout(e)})},[ke?._id,_a]),A.useEffect(()=>{!Pe&&Object.keys(wa).length>0&&Object.entries(wa).forEach(([e,t])=>{Ia(e,t,!0)})},[Pe,wa]);const[Da,Ea]=A.useState(!1),[Oa,Ba]=A.useState("leadDate"),[$a,Fa]=A.useState(""),[Ra,Ma]=A.useState(""),[Pa,Ua]=A.useState(""),[Ga,za]=A.useState(""),[Ha,Wa]=A.useState(""),[Ka,Va]=A.useState(""),[Ya,qa]=A.useState(""),Ja=()=>{Fa(""),Ma(""),Ua(""),za(""),Wa(""),Va(""),qa("")},[Qa,Xa]=A.useState(0),Za=()=>{Xa(e=>e+1),setDisplayedItemsCount(50)},[es,ts]=A.useState({leadStatus:"",dateFrom:"",dateTo:"",noActivityDate:"",selectedStatuses:[],fileSentToLogin:!1,checkDuplicateLeads:!1,disbursementDateFrom:"",disbursementDateTo:"",leadDateFrom:"",leadDateTo:"",fileSentToLoginDateFrom:"",fileSentToLoginDateTo:"",teamName:[],createdBy:[],assignedTL:[],loanTypeFilter:[],campaignName:[],loginDepartment:[],channelName:[],incomeRangeFrom:"",incomeRangeTo:"",incomeSortOrder:""}),as=(e,t=null)=>{const a={"Active Login":0,Approve:0,Disbursed:0,"Lost by Mistake":0,"Lost Login":0};if(Array.isArray(e)){let s=e;t&&"all"!==t&&(s=e.filter(e=>{if(e.loan_type_id===t)return!0;const a=localStorage.getItem("loginCrmCleanLoanTypeName");if(a&&(e.loan_type===a||e.loan_type_name===a))return!0;const s="string"==typeof t?t.replace(" Login",""):t;return e.loan_type===s||e.loan_type_name===s||"68595a524cec3069a38501e6"===t&&("PL & OD"===e.loan_type||"PL & OD"===e.loan_type_name)||"68595a524cec3069a38501e5"===t&&("Home Loan"===e.loan_type||"Home Loan"===e.loan_type_name)})),s.forEach((e,t)=>{if(a.hasOwnProperty(e.status))a[e.status]++;else{const t=e.status?.toLowerCase();"active login"===t?a["Active Login"]++:"approve"===t||"approved"===t?a.Approve++:"disbursed"===t||"disbursement"===t?a.Disbursed++:"lost by mistake"===t||"lost by mistake"===t?a["Lost by Mistake"]++:"lost login"===t||"lost leads"===t||"lost lead"===t?a["Lost Login"]++:a["Active Login"]++}})}return a},[ss,ns]=A.useState({"Active Login":0,Approve:0,Disbursed:0,"Lost by Mistake":0,"Lost Login":0}),ls=A.useMemo(()=>{const e={"Active Login":0,Approve:0,Disbursed:0,"Lost by Mistake":0,"Lost Login":0};let t=Array.isArray(me)?[...me]:[];if("all"!==ce&&(t=t.filter(e=>{if(e.loan_type_id===ce)return!0;const t=localStorage.getItem("loginCrmCleanLoanTypeName");if(t&&(e.loan_type===t||e.loan_type_name===t))return!0;const a="string"==typeof ce?ce.replace(" Login",""):ce;return e.loan_type===a||e.loan_type_name===a||"68595a524cec3069a38501e6"===ce&&("PL & OD"===e.loan_type||"PL & OD"===e.loan_type_name)||"68595a524cec3069a38501e5"===ce&&("Home Loan"===e.loan_type||"Home Loan"===e.loan_type_name)})),"all"!==Ne&&(t=t.filter(e=>e.status===Ne)),ve){const e=ve.toLowerCase();t=t.filter(t=>t.name&&t.name.toLowerCase().includes(e)||t.phone&&t.phone.toString().includes(e)||t.mobile_number&&t.mobile_number.toString().includes(e)||t.email&&t.email.toLowerCase().includes(e))}if(t=t.filter(e=>{const t=new Date(e.login_date);let a=!0;if(es.dateFrom&&""!==es.dateFrom.trim()){const e=new Date(es.dateFrom);a=a&&t>=e}if(es.dateTo&&""!==es.dateTo.trim()){const e=new Date(es.dateTo);a=a&&t<=e}const s=es.fileSentToLogin,n=es.selectedStatuses&&es.selectedStatuses.length>0;let l=!0;if(s||n){let t=!1;if(s&&!0===e.file_sent_to_login&&(t=!0),n){const a="object"==typeof e.status?e.status.name||"Unknown":e.status||"Unknown",s="object"==typeof e.sub_status?e.sub_status.name||"":e.sub_status||"";es.selectedStatuses.some(t=>"File sent to login"===t?!0===e.file_sent_to_login:t===a||t===s)&&(t=!0)}l=t}else l=!es.leadStatus||e.status===es.leadStatus;let r=!0;if(es.disbursementDateFrom||es.disbursementDateTo){const t=e.disbursement_date?new Date(e.disbursement_date):null;if(t){if(es.disbursementDateFrom&&""!==es.disbursementDateFrom.trim()){const e=new Date(es.disbursementDateFrom);r=r&&t>=e}if(es.disbursementDateTo&&""!==es.disbursementDateTo.trim()){const e=new Date(es.disbursementDateTo);e.setHours(23,59,59,999),r=r&&t<=e}}else r=!1}const o=!es.teamName?.length||es.teamName.includes(e.team_name),i=!es.campaignName?.length||es.campaignName.includes(e.operations_channel_name),c=!es.createdBy?.length||es.createdBy.includes(e.creator_name),d=!es.assignedTL?.length||es.assignedTL.includes(e.assigned_tl_name),m=!es.loginDepartment?.length||es.loginDepartment.includes(e.creator_name)||es.loginDepartment.includes(e.department_name)||es.loginDepartment.includes(e.team_name),u=!es.channelName?.length||es.channelName.includes(e.channel_name||e.campaign_name);let x=!0;if(es.incomeRangeFrom||es.incomeRangeTo){const t=le(e,"total_income")||le(e,"salary"),a=parseFloat(t)||0,s=es.incomeRangeFrom?parseFloat(es.incomeRangeFrom):0,n=es.incomeRangeTo?parseFloat(es.incomeRangeTo):1/0;x=a>=s&&a<=n}return l&&a&&r&&o&&i&&c&&d&&m&&u&&x}),es.checkDuplicateLeads){const e=e=>{if(!e)return null;const t=e.toString().replace(/\D/g,"");return t.length>=10?t:null},a=new Map;t.forEach(t=>{const s=[e(t.mobile_number),e(t.phone),e(t.alternative_phone),e(t.alt_phone_number)].filter(e=>null!==e);[...new Set(s)].forEach(e=>{a.has(e)||a.set(e,[]),a.get(e).push(t)})});const s=new Set;a.forEach((e,t)=>{e.length>1&&s.add(t)}),t=0===s.size?[]:t.filter(t=>{const a=[e(t.mobile_number),e(t.phone),e(t.alternative_phone),e(t.alt_phone_number)].filter(e=>null!==e);return[...new Set(a)].some(e=>s.has(e))})}return t.forEach(t=>{if(e.hasOwnProperty(t.status))e[t.status]++;else{const a=t.status?.toLowerCase();"active login"===a?e["Active Login"]++:"approve"===a||"approved"===a?e.Approve++:"disbursed"===a||"disbursement"===a?e.Disbursed++:"lost by mistake"===a||"lost by mistake"===a?e["Lost by Mistake"]++:"lost login"===a||"lost leads"===a||"lost lead"===a?e["Lost Login"]++:e["Active Login"]++}}),e},[me,ce,Ne,ve,es,Qa]),[rs]=E.useForm(),[os]=E.useForm(),[is]=E.useForm(),cs=(()=>{const e=[{value:"all",label:"All Status"}];return ta.length>0?ta.forEach(t=>{e.push({value:t,label:t})}):["Active Login","Approve","Disbursed","Lost by Mistake","Lost Login"].forEach(t=>{e.push({value:t,label:t})}),e})(),ds=()=>(at&&at.length>0?at.sort():[...new Set(me.map(e=>e.team_name).filter(Boolean))].sort()).filter(e=>e.toLowerCase().includes($a.toLowerCase())),ms=()=>[...new Set(me.map(e=>e.creator_name).filter(Boolean))].sort().filter(e=>e.toLowerCase().includes(Ra.toLowerCase())),us=()=>(Ye&&Ye.length>0?Ye.map(e=>e.name||(e.first_name&&e.last_name?`${e.first_name} ${e.last_name}`.trim():e.first_name||e.last_name||"Unknown")).filter(Boolean).sort():[...new Set(me.map(e=>e.assigned_tl_name||e.assignedTL).filter(Boolean))].sort()).filter(e=>e.toLowerCase().includes(Ga.toLowerCase())),xs=()=>(()=>{if(Xe&&Xe.length>0){const e=Xe.filter(e=>(e.department_name||e.department||"").toLowerCase().includes("login")).map(e=>e.name||`${e.first_name||""} ${e.last_name||""}`.trim()||e.username||e.id).filter(e=>e&&e.trim());return[...new Set(e)].sort()}const e=new Set;return me.forEach(t=>{t.creator_name&&e.add(t.creator_name),t.department_name&&e.add(t.department_name),t.team_name&&e.add(t.team_name)}),[...e].filter(Boolean).sort()})().filter(e=>e.toLowerCase().includes(Ka.toLowerCase())),hs=()=>[...new Set(me.map(e=>e.channel_name||e.campaign_name).filter(Boolean))].sort().filter(e=>e.toLowerCase().includes(Ya.toLowerCase())),gs=()=>{if(!Pa.trim())return la;const e={};return Object.keys(la).forEach(t=>{const a=t.toLowerCase().includes(Pa.toLowerCase()),s=la[t]?.filter(e=>{const t="object"==typeof e?e.name:e;return t&&t.toLowerCase().includes(Pa.toLowerCase())})||[];(a||s.length>0)&&(e[t]=a?la[t]:s)}),e},ps=()=>{let e=0;return es.leadStatus&&e++,(es.dateFrom||es.dateTo)&&e++,es.teamName?.length>0&&e++,es.campaignName?.length>0&&e++,es.createdBy?.length>0&&e++,es.assignedTL?.length>0&&e++,es.selectedStatuses?.length>0&&e++,es.fileSentToLogin&&e++,es.checkDuplicateLeads&&e++,(es.disbursementDateFrom||es.disbursementDateTo)&&e++,(es.leadDateFrom||es.leadDateTo)&&e++,(es.fileSentToLoginDateFrom||es.fileSentToLoginDateTo)&&e++,es.noActivityDate&&e++,es.loanTypeFilter?.length>0&&e++,(es.incomeRangeFrom||es.incomeRangeTo)&&e++,es.incomeSortOrder&&e++,es.loginDepartment?.length>0&&e++,es.channelName?.length>0&&e++,e},ys=e=>{switch(e){case"leadDate":let e=0;return(es.dateFrom||es.dateTo)&&e++,(es.disbursementDateFrom||es.disbursementDateTo)&&e++,(es.leadDateFrom||es.leadDateTo)&&e++,(es.fileSentToLoginDateFrom||es.fileSentToLoginDateTo)&&e++,es.noActivityDate&&e++,e;case"leads":return es.leadStatus?1:0;case"date":default:return 0;case"team":return es.teamName?.length||0;case"createdBy":return es.createdBy?.length||0;case"leadActivity":let t=0;return es.checkDuplicateLeads&&t++,es.fileSentToLogin&&t++,t;case"status":return es.selectedStatuses?.length||0;case"assignedTL":return es.assignedTL?.length||0;case"loginDepartment":return es.loginDepartment?.length||0;case"channelName":return es.channelName?.length||0;case"other":return es.campaignName?.length||0;case"income":let a=0;return(es.incomeRangeFrom||es.incomeRangeTo)&&a++,es.incomeSortOrder&&a++,a}},bs=e=>{if(dt.current){const t=300,a=dt.current.scrollLeft,s="left"===e?a-t:a+t;dt.current.scrollTo({left:s,behavior:"smooth"})}},fs=()=>{if(dt.current){const{scrollLeft:e,scrollWidth:t,clientWidth:a}=dt.current;ot(e>0),ct(e<t-a-1)}};A.useEffect(()=>{fs()},[xe]),A.useEffect(()=>{const e=()=>{const e=localStorage.getItem("loginCrmLoanTypeId")||"all";de(e)};return e(),(async()=>{const e=[Ns(),_s()];try{await Promise.all(e)}catch(t){}})(),window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}},[]),A.useEffect(()=>{me.length>0&&!ge&&(setTimeout(async()=>{await Promise.all([Ls(),ws()]).catch(e=>{})},0),setTimeout(async()=>{await Promise.all([Is(),vs()]).catch(e=>{})},500),setTimeout(async()=>{await Promise.all([ks(),Ts(),Cs()]).catch(e=>{})},1e3))},[me.length,ge]),A.useEffect(()=>{const e=()=>{if(!document.hidden){const e=`logincrm_leads_${localStorage.getItem("userId")}_${Ne}_${ce}_time`,t=localStorage.getItem(e);t&&Date.now()-parseInt(t)>12e4&&Ns()}};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[Ne,ce]),A.useEffect(()=>{ce&&Ns()},[ce]),A.useEffect(()=>{const e=e=>{null===Wt||e.target.closest(".status-dropdown-container")||e.target.closest(".status-dropdown-button")||e.target.closest(".status-dropdown-menu")||Kt(null)},t=e=>{null!==Wt&&"Escape"===e.key&&Kt(null)},a=e=>{if(null!==Wt){const t=e.target;t.closest(".status-dropdown-container")||t.closest(".status-dropdown-menu")||t.classList.contains("status-dropdown-container")||t.classList.contains("status-dropdown-menu")||(Kt(null),Xt(null),ea(!0),Jt(""))}};return null!==Wt&&(document.addEventListener("click",e),document.addEventListener("keydown",t),document.addEventListener("scroll",a,!0),window.addEventListener("scroll",a,!0)),()=>{document.removeEventListener("click",e),document.removeEventListener("keydown",t),document.removeEventListener("scroll",a,!0),window.removeEventListener("scroll",a,!0)}},[Wt]);const js=async()=>{fa(!0),be(!1);try{const t=`logincrm_leads_${localStorage.getItem("userId")}_${Ne}_${ce}`,a=`${t}_time`;if(localStorage.removeItem(t),localStorage.removeItem(a),"caches"in window)try{await caches.delete("api-cache")}catch(e){}ue([]),await Ns(),O.success("âœ… Data refreshed with cache cleared",2)}catch(e){O.error("âŒ Failed to refresh data")}finally{fa(!1)}};A.useEffect(()=>{(me.length>0||es.noActivityDate)&&Ns()},[es.noActivityDate]);const Ns=A.useCallback(async()=>{const e=sessionStorage.getItem("directViewLoginId");if(e){sessionStorage.removeItem("directViewLoginId");try{await(async e=>{if(e)try{const t=localStorage.getItem("userId"),a=await fetch(`${J}/lead-login/login-leads/${e}?user_id=${t}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(!a.ok)throw new Error(`Failed to fetch lead with ID ${e}`);const s=await a.json();return Le(s),Ue(!0),s}catch(t){throw O.error(`Could not load lead details: ${t.message}`),t}})(e)}catch(l){}}const t=localStorage.getItem("userId"),a=new URLSearchParams({user_id:t});"all"!==Ne&&a.append("status_filter",Ne),"all"!==ce&&a.append("loan_type",ce),es.noActivityDate&&""!==es.noActivityDate.trim()&&a.append("no_activity_date",es.noActivityDate);const s=`logincrm_leads_${t}_${Ne}_${ce}`,n=`${s}_time`;try{const e=localStorage.getItem(s),t=localStorage.getItem(n);if(e&&t){const a=JSON.parse(e),s=Date.now()-parseInt(t);if(s<3e5&&a.length>0&&(ue(a),be(!0),pe(!1),s<3e4))return}}catch(r){}pe(!0),es.noActivityDate&&""!==es.noActivityDate.trim()&&Na(!0);try{const e=new AbortController,t=setTimeout(()=>e.abort(),2e4),l=(Date.now(),await fetch(`${J}/lead-login/login-department-leads?${a}`,{signal:e.signal,headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json",Priority:"high","Accept-Encoding":"gzip, deflate, br"},keepalive:!0,mode:"cors",credentials:"include"}));if(clearTimeout(t),Date.now(),l.ok){const e=(await l.json()).leads||[];try{localStorage.setItem(s,JSON.stringify(e)),localStorage.setItem(n,Date.now().toString())}catch(r){}ue(e),be(!1)}else O.error(`Failed to fetch leads. Status: ${l.status}`),0===me.length&&(ue([]),he([]))}catch(l){"AbortError"===l.name?O.error("Request timeout. Please check your connection and try again."):O.error(`Error fetching leads: ${l.message}`),0===me.length&&(ue([]),he([]))}finally{pe(!1),Na(!1)}},[Ne,ce,es.noActivityDate,me.length]),ws=async()=>{try{xa(!0);const e="logincrm_users",t="logincrm_users_time",a=localStorage.getItem(e),s=localStorage.getItem(t),n=Date.now()-6e5;if(a&&s&&parseInt(s)>n){const e=JSON.parse(a);return jt(e),void xa(!1)}const l=localStorage.getItem("userId"),r=await fetch(`${J}/users/all-users?user_id=${l}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(r.ok){const a=(await r.json()).users||[];jt(a),localStorage.setItem(e,JSON.stringify(a)),localStorage.setItem(t,Date.now().toString())}else r.status,jt([])}catch(e){jt([])}finally{xa(!1)}},vs=async()=>{try{const e=localStorage.getItem("userId"),t=await fetch(`${J}/lead-login/junior-users?user_id=${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(t.ok){const e=await t.json();wt(e.users||[])}else wt(ft)}catch(e){wt(ft)}},_s=async()=>{try{ga(!0);const e="logincrm_loan_types",t="logincrm_loan_types_time",a=localStorage.getItem(e),s=localStorage.getItem(t),n=Date.now()-9e5;if(a&&s&&parseInt(s)>n){const e=JSON.parse(a);return _t(e),void ga(!1)}const l=localStorage.getItem("userId"),r=await fetch(`${J}/loan-types?user_id=${l}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(r.ok){const a=await r.json(),s=[{_id:"all",name:"All Loan Types",description:"Show all leads"},...a.items||a.loan_types||a||[]];_t(s),localStorage.setItem(e,JSON.stringify(s)),localStorage.setItem(t,Date.now().toString())}else Ss()}catch(e){Ss()}finally{ga(!1)}},Ss=()=>{_t([{_id:"all",name:"All Loan Types",description:"Show all leads"},{_id:"personal",name:"Personal Loan",description:"Personal loans"},{_id:"home",name:"Home Loan",description:"Home loans"},{_id:"business",name:"Business Loan",description:"Business loans"}])},ks=async()=>{try{ya(!0);const e=localStorage.getItem("userId"),t=await fetch(`${J}/lead-login/important-questions?user_id=${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(t.ok){const e=await t.json();kt(e.questions||[])}}catch(e){}finally{ya(!1)}},Ls=async()=>{try{const e=localStorage.getItem("userId"),t=localStorage.getItem("token");if(!e)return void Ve(["HDFC Bank","ICICI Bank","SBI Bank","Axis Bank"]);const a=await fetch(`${J}/settings/bank-names?user_id=${e}`,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(a.ok){const e=await a.json();if(Array.isArray(e)&&e.length>0){const t=e.filter(e=>e&&!0===e.is_active).map(e=>e.name).filter(e=>e&&e.trim());t.length>0?Ve(t):Ve(["HDFC Bank","ICICI Bank","SBI Bank","Axis Bank"])}else Ve(["HDFC Bank","ICICI Bank","SBI Bank","Axis Bank"])}else Ve(["HDFC Bank","ICICI Bank","SBI Bank","Axis Bank"])}catch(e){Ve(["HDFC Bank","ICICI Bank","SBI Bank","Axis Bank"])}},Cs=async()=>{lt(!0);try{const e="/api",t=await fetch(`${e}/leads/assignment-options?user_id=${te}&show_all_users=true`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(t.ok){const e=await t.json();let a=[];e.departments&&Array.isArray(e.departments)&&(a=e.departments.map(e=>e.name).filter(Boolean)),st(a)}else st([])}catch(e){st([])}finally{lt(!1)}},Ts=async()=>{tt(!0);try{const t="/api",a=await fetch(`${t}/leads/assignment-options?user_id=${te}&show_all_users=true`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(a.ok){const s=await a.json();let n=[];if(s.departments&&Array.isArray(s.departments))for(const a of s.departments)try{const e=await fetch(`${t}/leads/assignment-options?user_id=${te}&department_id=${a.id}&show_all_users=true`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(e.ok){const t=await e.json();if(t.users&&Array.isArray(t.users)){const e=t.users.map(e=>({...e,department_name:a.name||e.department_name,department_id:a.id}));n=[...n,...e]}}}catch(e){}0===n.length&&s.users&&(n=s.users),Ze(n)}else Ze([])}catch(t){Ze([])}finally{tt(!1)}},Is=async()=>{Qe(!0);try{const t="/api",a=[`${t}/users?user_id=${te}&designation=team leader`,`${t}/users?user_id=${te}`,`${t}/hrms/employees?user_id=${te}&designation=team leader`,`${t}/employees?user_id=${te}&designation=team leader`];let s=null,n=null;for(const l of a)try{const e=await fetch(l,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(e.ok){s=await e.json(),n=l;break}}catch(e){}if(s){let e=[];Array.isArray(s)?e=s:s.items&&Array.isArray(s.items)?e=s.items:s.users&&Array.isArray(s.users)?e=s.users:s.employees&&Array.isArray(s.employees)&&(e=s.employees);const t=e.filter(e=>{const t=e.designation||e.role||e.position||e.job_title;return t&&t.toLowerCase().includes("team leader")});qe(t)}else qe([])}catch(t){qe([])}finally{Qe(!1)}},As=A.useMemo(()=>{if(!me||0===me.length)return[];let e=[...me];if("all"!==ce&&(e=e.filter(e=>{if(e.loan_type_id===ce)return!0;const t=localStorage.getItem("loginCrmCleanLoanTypeName");if(t&&(e.loan_type===t||e.loan_type_name===t))return!0;const a="string"==typeof ce?ce.replace(" Login",""):ce;return e.loan_type===a||e.loan_type_name===a||"68595a524cec3069a38501e6"===ce&&("PL & OD"===e.loan_type||"PL & OD"===e.loan_type_name)||"68595a524cec3069a38501e5"===ce&&("Home Loan"===e.loan_type||"Home Loan"===e.loan_type_name)})),"all"!==Ne&&(e=e.filter(e=>e.status===Ne)),Se){const t=Se.toLowerCase();e=e.filter(e=>{const a=le(e,"customer_name")||`${e.first_name||""} ${e.last_name||""}`.trim()||"",s=le(e,"company_name")||"",n=le(e,"city")||"",l=le(e,"pincode")||"";return a.toLowerCase().includes(t)||"string"==typeof e.phone&&e.phone.includes(t)||"string"==typeof e.alternative_phone&&e.alternative_phone.includes(t)||"string"==typeof e.email&&e.email.toLowerCase().includes(t)||s.toLowerCase().includes(t)||"string"==typeof e.creator_name&&e.creator_name.toLowerCase().includes(t)||"string"==typeof e.team_name&&e.team_name.toLowerCase().includes(t)||"string"==typeof e.operations_channel_name&&e.operations_channel_name.toLowerCase().includes(t)||n.toLowerCase().includes(t)||"string"==typeof l&&l.includes(t)||"string"==typeof e.status&&e.status.toLowerCase().includes(t)||"string"==typeof e.sub_status&&e.sub_status.toLowerCase().includes(t)||"string"==typeof e.custom_lead_id&&e.custom_lead_id.toLowerCase().includes(t)||"string"==typeof e.login&&e.login.toLowerCase().includes(t)})}return Object.values(es).some(e=>e)&&(e=e.filter(e=>{const t=new Date(e.login_date);if(es.dateFrom&&es.dateTo){const e=new Date(es.dateFrom),a=new Date(es.dateTo);if(t<e||t>a)return!1}return!0})),e},[me,ce,Ne,Se,es,Qa]),Ds=A.useMemo(()=>As&&0!==As.length?As.slice(0,fe):[],[As,fe]),Es=A.useMemo(()=>As&&As.length>fe,[As,fe]);A.useEffect(()=>{he(As),ns(ls)},[As,ls]),A.useEffect(()=>{je(50)},[Se,ce,Ne,es,Qa]);const Os=async e=>{try{const t=localStorage.getItem("userId"),a=await fetch(`${J}/lead-login/login-leads/${e._id}?user_id=${t}`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(a.ok){const e=await a.json();Le(e),Ue(!0)}else 404===a.status?(O.warning("âš ï¸ This lead no longer exists. Refreshing the list..."),Ns()):(Le(e),Ue(!0),O.info("Using cached lead data - some information may not be up to date"))}catch(t){Le(e),Ue(!0),O.warning("Could not fetch latest data - using cached information")}},Bs=async(e,t,a=!1)=>{if(xe[e],a){const a=Gs().results.find(e=>e.name===t);if(a)return"sub"===a.type?(await $s(e,a.mainStatus,a.subStatus),void Ms()):la[t]&&la[t].length>0?void Rs(t):(await $s(e,t,t),void Ms())}if(Zt)return la[t]&&la[t].length>0?void Rs(t):(await $s(e,t,t),void Ms());let s=Qt;!s&&oa[t]&&(s=oa[t]),s||(s=t),await $s(e,s,t),Ms()},$s=async(e,t,a=null)=>{const s=xe[e];try{const n={status:t};let l=a;l=a||(la[t]&&la[t].length>0?null:t),l&&(n.sub_status=l);const r=await fetch(`${J}/lead-login/login-leads/${s._id}?user_id=${te}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(n)});if(!r.ok)throw new Error("Failed to update status");{const a=await r.json(),n=a?.status||t,o=a?.sub_status||l||t,i=[...xe];i[e]={...i[e],status:n,sub_status:o},he(i);const c=me.map(e=>e._id===s._id?{...e,status:n,sub_status:o}:e);ue(c),ns(as(c,ce)),Ms(),O.success("Status updated successfully")}}catch(n){O.error("Failed to update status")}},Fs=()=>{if("login"===r){if(qt){const e=[];return Object.entries(la).forEach(([t,a])=>{a.forEach(t=>{e.push(t)})}),[...e.filter(e=>("object"==typeof e?e.name:e).toLowerCase()===qt.toLowerCase()),...e.filter(e=>{const t="object"==typeof e?e.name:e;return t.toLowerCase().includes(qt.toLowerCase())&&t.toLowerCase()!==qt.toLowerCase()})]}if(Zt)return ta;if(!Zt&&Qt)return la[Qt]||[]}return ta.length>0?ta:["ACTIVE LOGIN","APPROVED","DISBURSED","LOST BY MISTAKE","LOST LOGIN"]},Rs=e=>{Xt(e),ea(!1),Jt("")},Ms=()=>{Kt(null),Xt(null),ea(!0),Jt("")},Ps=e=>{if(5===Ge&&mt)return pt(e),void(yt?yt():ht(!0));ze(e),We(0)},Us=(e,t)=>{ut(e),bt(()=>t)},Gs=()=>{if(!qt)return{type:"normal",results:[]};const e=qt.toLowerCase(),t=[];return(ta.length>0?ta:["Active Login","Approve","Disbursed","Lost by Mistake","Lost Login"]).forEach(a=>{const s="object"==typeof a?a.name:a;s.toLowerCase().includes(e)&&t.push({type:"main",name:s,mainStatus:s,subStatus:null})}),Object.entries(la).forEach(([a,s])=>{s.forEach(s=>{const n="object"==typeof s?s.name:s;n.toLowerCase().includes(e)&&t.push({type:"sub",name:n,mainStatus:a,subStatus:n})})}),{type:"search",results:t}},zs=e=>{const t=oa[e]||"";return t&&"object"==typeof t&&t.name?t.name:t},Hs=e=>{if(!e)return"-";const t=D(e),a=(e=>{if(!e)return 0;const t=new Date,a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),s=new Date(e),n=new Date(s.getFullYear(),s.getMonth(),s.getDate()),l=a.getTime()-n.getTime(),r=Math.floor(l/864e5);return Math.max(0,r)})(e);return T.jsxs("div",{className:"text-left",children:[T.jsx("div",{children:t}),T.jsx("div",{className:"text-sm text-gray-400",children:0===a?"Today":1===a?"1 day old":a>0?`${a} days old`:"Future date"})]})},Ws=async()=>{da(!0);try{const e="logincrm_statuses",t="logincrm_statuses_time",a=localStorage.getItem(e),s=localStorage.getItem(t),n=Date.now()-9e5;if(a&&s&&parseInt(s)>n){const e=JSON.parse(a);return aa(e.allStatuses||[]),na(e.allSubStatuses||[]),ia(e.subStatusToMainStatus||{}),ra(e.statusHierarchy||{}),void da(!1)}const l="/api",r=await fetch(`${l}/leads/admin/statuses?user_id=${te}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(r.ok){const e=await r.json();let t=[];t=Array.isArray(e)?e:e&&Array.isArray(e.statuses)?e.statuses:e&&Array.isArray(e.data)?e.data:[];const a="login",s=t.filter(e=>e.department?e.department===a:!e.department_ids||(Array.isArray(e.department_ids)?e.department_ids.includes(a):e.department_ids===a)),n=[],l=[],o={},i={};s.forEach((e,t)=>{const a=e.name;n.push(a);const s=e.sub_statuses||[],r=s.map(e=>"object"==typeof e&&(e.name||e.status_name)||e);i[a]=r,s.forEach(e=>{const t="object"==typeof e&&(e.name||e.status_name)||e;l.push(t),o[t]=a})}),aa(n),na(l),ia(o),ra(i);const c="logincrm_statuses",d="logincrm_statuses_time";localStorage.setItem(c,JSON.stringify({allStatuses:n,allSubStatuses:l,subStatusToMainStatus:o,statusHierarchy:i})),localStorage.setItem(d,Date.now().toString())}else aa(["ACTIVE LOGIN","APPROVED","DISBURSED","LOST BY MISTAKE","LOST LOGIN"]),na(["NEW LOGIN","SENT TO BANK","LOGIN COMPLETE UNDERWRITING","CASE FORWARDED","RELOOK","IMPORTANT RELOOK","ABND","CUSTOMER DENIED FOR LOGIN","CUSTOMER RESIGNED","LOCATION NOT DOABLE"]),ra({"ACTIVE LOGIN":["NEW LOGIN","SENT TO BANK","LOGIN COMPLETE UNDERWRITING","CASE FORWARDED","RELOOK","IMPORTANT RELOOK"],"LOST BY MISTAKE":["ABND","CUSTOMER DENIED FOR LOGIN","CUSTOMER RESIGNED","LOCATION NOT DOABLE"],APPROVED:[],DISBURSED:[],"LOST LOGIN":[]}),ia({"NEW LOGIN":"ACTIVE LOGIN","SENT TO BANK":"ACTIVE LOGIN","LOGIN COMPLETE UNDERWRITING":"ACTIVE LOGIN","CASE FORWARDED":"ACTIVE LOGIN",RELOOK:"ACTIVE LOGIN","IMPORTANT RELOOK":"ACTIVE LOGIN",ABND:"LOST BY MISTAKE","CUSTOMER DENIED FOR LOGIN":"LOST BY MISTAKE","CUSTOMER RESIGNED":"LOST BY MISTAKE","LOCATION NOT DOABLE":"LOST BY MISTAKE"})}catch(e){aa(["ACTIVE LOGIN","APPROVED","DISBURSED","LOST BY MISTAKE","LOST LOGIN"]),na(["NEW LOGIN","SENT TO BANK","LOGIN COMPLETE UNDERWRITING","CASE FORWARDED","RELOOK","IMPORTANT RELOOK","ABND","CUSTOMER DENIED FOR LOGIN","CUSTOMER RESIGNED","LOCATION NOT DOABLE"]),ra({"ACTIVE LOGIN":["NEW LOGIN","SENT TO BANK","LOGIN COMPLETE UNDERWRITING","CASE FORWARDED","RELOOK","IMPORTANT RELOOK"],"LOST BY MISTAKE":["ABND","CUSTOMER DENIED FOR LOGIN","CUSTOMER RESIGNED","LOCATION NOT DOABLE"],APPROVED:[],DISBURSED:[],"LOST LOGIN":[]}),ia({"NEW LOGIN":"ACTIVE LOGIN","SENT TO BANK":"ACTIVE LOGIN","LOGIN COMPLETE UNDERWRITING":"ACTIVE LOGIN","CASE FORWARDED":"ACTIVE LOGIN",RELOOK:"ACTIVE LOGIN","IMPORTANT RELOOK":"ACTIVE LOGIN",ABND:"LOST BY MISTAKE","CUSTOMER DENIED FOR LOGIN":"LOST BY MISTAKE","CUSTOMER RESIGNED":"LOST BY MISTAKE","LOCATION NOT DOABLE":"LOST BY MISTAKE"})}finally{da(!1)}},Ks=Et.length===xe.length&&xe.length>0;if(Pe&&ke){const a=[{label:"LEAD DETAILS",getContent:(e,t)=>[{label:"About",content:T.jsx(p,{height:"300px",children:T.jsx(y,{lead:e,onSave:e=>{if(!ke)return;const t=localStorage.getItem("userId"),a=`/api/lead-login/login-leads/${ke._id}?user_id=${t}`;return fetch(a,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(e)}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>(Le(e),ue(t=>t.map(t=>t._id===e._id?e:t)),e)).catch(e=>{throw e})},canEdit:oe()})})},{label:"How to Process",content:T.jsxs(p,{height:"250px",children:[T.jsx(b,{process:e.process,onSave:(e,t)=>Aa(e,t,!0,1500),lead:e,canEdit:oe()}),"```"]})},{label:"Login Operations",content:T.jsx(q,{lead:e,onSave:(e,t)=>Aa(e,t,!0,1500),canEdit:oe()})},{label:"APPLICANT FORM",content:T.jsxs("div",{className:"space-y-4 sm:space-y-6 w-full",children:[T.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-2",children:[T.jsx("h3",{className:"text-base sm:text-lg font-bold text-[#03B0F5]",children:"Primary Applicant"}),T.jsx("button",{className:"px-3 sm:px-4 py-2 rounded-lg transition font-bold text-sm sm:text-lg whitespace-nowrap "+(oe()?"bg-green-600 text-white hover:bg-green-700":"bg-gray-400 text-gray-600 cursor-not-allowed"),onClick:()=>{oe()&&t("co_applicant_form",{first_name:"",last_name:"",mobile_number:"",email:"",date_of_birth:"",address:"",city:"",state:"",pincode:"",pan_number:"",aadhar_number:"",initialized:!0})},disabled:!oe(),children:"+ Add Co-Applicant"})]}),T.jsx(f,{data:e.dynamic_fields?.applicant_form||e.loginForm||{},onSave:e=>{Aa("applicant_form",e,!0,0)},bankOptions:Ke,mobileNumber:e.mobile_number,bankName:e.salaryAccountBank||e.bank_name,isReadOnlyMobile:!0,leadId:e._id,leadCustomerName:e.first_name&&e.last_name?`${e.first_name} ${e.last_name}`:e.customerName,leadData:e,canEdit:oe()}),(e.dynamic_fields?.co_applicant_form||e.coApplicantForm)&&T.jsxs("div",{className:"mt-6 sm:mt-8 pt-4 sm:pt-6 border-t-2 border-cyan-400 w-full",children:[T.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-2",children:[T.jsx("h3",{className:"text-base sm:text-lg font-bold text-[#03B0F5]",children:"Co-Applicant"}),T.jsx("button",{className:"px-3 sm:px-4 py-2 rounded-lg transition font-bold text-sm sm:text-lg whitespace-nowrap "+(oe()?"bg-red-600 text-white hover:bg-red-700":"bg-gray-400 text-gray-600 cursor-not-allowed"),onClick:()=>{oe()&&t("co_applicant_form",null)},disabled:!oe(),children:"Remove Co-Applicant"})]}),T.jsx(f,{data:e.dynamic_fields?.co_applicant_form||e.coApplicantForm||{},onSave:e=>{Aa("co_applicant_form",e,!0,0)},bankOptions:Ke,mobileNumber:"",bankName:"",isCoApplicant:!0,leadId:e._id,leadCustomerName:e.first_name&&e.last_name?`${e.first_name} ${e.last_name} - Co-Applicant`:`${e.customerName||e.customer_name||""} - Co-Applicant`,leadData:e,canEdit:oe()})]})]})},{label:"Important Questions",content:T.jsx(j,{leadData:e,onUpdate:e=>{Aa("importantquestion",e,!0,2e3),e.question_responses&&Aa("question_responses",e.question_responses,!0,2e3)},currentUserRole:{permissions:[],_id:localStorage.getItem("userId"),department:localStorage.getItem("userDepartment")||"login"},canEdit:oe()})}]},{label:"OBLIGATION",getContent:(e,t)=>[{content:T.jsx("div",{children:T.jsx(N,{leadData:e,handleChangeFunc:(e,t)=>{Aa(e,t,!0)},onDataUpdate:async()=>{await(async()=>{if(ke?._id)try{const e=localStorage.getItem("userId"),t=await fetch(`${J}/lead-login/login-leads/${ke._id}?user_id=${e}`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const a=await t.json();Le(a),ue(e=>e.map(e=>e._id===a._id?a:e))}catch(e){}})(),Ns()},onUnsavedChangesUpdate:Us,canEdit:oe()})})}]},{label:"REMARK",getContent:e=>[{content:T.jsx("div",{className:"p-6 bg-white rounded-xl shadow-2xl text-[1rem] text-gray-100 border-l-4 border-cyan-500/60",children:T.jsx(w,{leadData:e,canEdit:oe()})})}]},{label:"TASK",getContent:e=>[{content:T.jsx("div",{className:"p-4 bg-gradient-to-r from-[#1b2736] to-[#23243a] rounded-xl shadow text-[1rem] text-[#03b0f5] border-l-4 border-cyan-400/40",children:T.jsx("div",{className:"font-bold text-cyan-400 mb-2",children:T.jsx(p,{height:"300px",children:T.jsx(v,{leadData:e,canEdit:oe()})})})})}]},{label:"ATTACHEMENT",getContent:e=>[{content:T.jsx("div",{children:T.jsx(p,{height:"350px",children:T.jsx(_,{leadId:e._id,userId:e.created_by,onContentInteraction:e=>{},canEdit:oe()})})})}]},{label:"LEADS ACTIVITY",getContent:e=>[{content:T.jsx("div",{className:"p-4 bg-white rounded-xl shadow text-[1rem] text-[#03b0f5] border-l-4 border-cyan-400/40",children:T.jsx("div",{className:"font-bold text-cyan-400 mb-2",children:T.jsx(p,{height:"400px",children:T.jsx(S,{leadId:String(e._id||e.id),userId:String(e.assigned_to||localStorage.getItem("userId")||localStorage.getItem("user_id")),leadData:e})})})})}]}],s=a[Ge].getContent(ke,Aa);return T.jsxs("div",{className:"min-h-screen bg-black text-white text-sm sm:text-base w-full",children:[T.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 px-4 sm:px-6 py-4 sm:py-6 bg-[#0c1019] border-b-4 border-cyan-400/70 shadow-lg",children:[T.jsx("button",{onClick:()=>{Ue(!1),Le(null),Ns()},className:"text-cyan-300 mr-2 px-2 py-1 text-xl font-bold rounded hover:bg-cyan-900/20 transition","aria-label":"Back",children:"â†"}),T.jsx(B,{className:"text-cyan-300 w-8 sm:w-12 h-6 sm:h-10 drop-shadow"}),T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("h1",{className:"text-lg sm:text-2xl font-extrabold text-cyan-300 tracking-wide drop-shadow truncate",children:le(ke,"customer_name")||"Lead Details"}),ka&&T.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-yellow-600/20 rounded-full border border-yellow-500/50",children:[T.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-yellow-400"}),T.jsx("span",{className:"text-yellow-400 text-sm font-medium",children:"Saving..."})]}),Object.keys(wa).length>0&&!ka&&T.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-orange-600/20 rounded-full border border-orange-500/50",children:[T.jsx("div",{className:"w-3 h-3 bg-orange-400 rounded-full animate-pulse"}),T.jsx("span",{className:"text-orange-400 text-sm font-medium",children:"Pending changes"})]}),T.jsxs("button",{onClick:()=>Os(ke),className:"flex items-center gap-1 px-3 py-1 bg-blue-600/20 rounded-full border border-blue-500/50 hover:bg-blue-600/30 transition-colors",title:"Refresh lead data",children:[T.jsx(e,{className:"w-3 h-3 text-blue-400"}),T.jsx("span",{className:"text-blue-400 text-sm font-medium",children:"Refresh"})]})]}),T.jsxs("div",{className:"ml-auto flex items-center gap-3",children:[ke&&T.jsxs("button",{className:"copy-lead-button bg-gradient-to-b from-cyan-400 to-blue-700 px-3 sm:px-5 py-1.5 rounded-lg text-white font-bold shadow-lg hover:from-blue-700 hover:to-cyan-400 uppercase tracking-wide transition text-sm sm:text-base flex items-center",onClick:()=>{O.success("ðŸš€ Copy process started...",2),(async()=>{if(O.info("ðŸ”„ Copy process initiated...",2),ke)try{O.loading("ðŸ“‹ Copying lead...",0);const a=`/api/leads/copy?user_id=${localStorage.getItem("userId")}`,s={lead_id:ke._id,copy_options:{keep_custom_lead_id:!0,copy_activities:!0,copy_attachments:!0,copy_tasks:!0,copy_remarks:!0,copy_obligations:!0,preserve_original_metadata:!0,preserve_assigned_to:!0,preserve_created_by:!0,preserve_all_fields:!0,preserve_status:!0,add_copy_activity:!0},override_values:{}},n=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(s)});if(!n.ok){const e=await n.json();throw new Error(e.message||`HTTP error! status: ${n.status}`)}const l=await n.json(),r=l.lead_id||l._id||l.id,o=l.custom_lead_id||l.lead_number||r;O.destroy();try{const e=r?`âœ… Lead copied successfully! New Lead ID: ${o}`:"âœ… Lead copied successfully!";O.success({content:e,duration:8,style:{marginTop:"10vh",zIndex:9999,fontSize:"14px",fontWeight:"bold"}}),window.Notification&&"granted"===Notification.permission?new Notification("Lead Copied",{body:e,icon:"/favicon.ico"}):window.Notification&&"denied"!==Notification.permission&&Notification.requestPermission();const t=document.querySelector(".copy-lead-button");if(t){const e=t.textContent;t.textContent="âœ… Copied!",t.style.backgroundColor="#10b981",setTimeout(()=>{t.textContent=e,t.style.backgroundColor=""},3e3)}}catch(e){try{O.success("âœ… Lead copied successfully!")}catch(t){const e=document.createElement("div");if(e.innerHTML=`âœ… Lead copied successfully! New Lead ID: ${o}`,e.style.cssText="\n                            position: fixed;\n                            top: 20px;\n                            right: 20px;\n                            background: #52c41a;\n                            color: white;\n                            padding: 12px 20px;\n                            border-radius: 8px;\n                            font-weight: bold;\n                            z-index: 10000;\n                            box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n                            opacity: 0;\n                            transform: translateX(100%);\n                            transition: all 0.3s ease-out;\n                        ",!document.getElementById("toast-styles")){const e=document.createElement("style");e.id="toast-styles",e.textContent="\n                                .toast-enter {\n                                    opacity: 1 !important;\n                                    transform: translateX(0) !important;\n                                }\n                            ",document.head.appendChild(e)}document.body.appendChild(e),setTimeout(()=>e.classList.add("toast-enter"),10),setTimeout(()=>{document.body.contains(e)&&document.body.removeChild(e)},5e3),alert(`Lead copied successfully! New Lead ID: ${o}`)}}js()}catch(a){O.destroy();try{O.error(`Failed to copy lead: ${a.message}`,5)}catch(e){alert(`Failed to copy lead: ${a.message}`)}}else O.error("âš ï¸ No lead selected to copy")})()},children:[T.jsx(t,{className:"mr-2 h-4 w-4"})," COPY THIS LEAD"]}),ke?.file_sent_to_login&&T.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-green-600/20 rounded-full border border-green-500/50",children:[T.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-full"}),T.jsx("span",{className:"text-green-400 text-sm font-medium",children:"File Received"})]})]})]}),T.jsx("div",{className:"flex flex-wrap items-center gap-2 px-4 sm:px-7 py-2 sm:py-3 bg-black border-b border-[#232c3a] overflow-x-auto relative ","data-tab-area":"true",children:a.map((e,t)=>T.jsxs("button",{"data-tab-button":"true","data-tab-index":t,className:`\n                                flex items-center px-3 sm:px-6 py-2 sm:py-3 rounded-3xl font-extrabold border shadow-md text-sm sm:text-lg transition whitespace-nowrap relative  cursor-pointer\n                                ${t===Ge?"bg-[#03B0F5] via-blue-700 to-cyan-500 text-white border-cyan-400 shadow-lg scale-105":"bg-white text-[#03B0F5] border-[#2D3C56] hover:bg-cyan-400/10 hover:text-cyan-400"}\n                                focus:outline-none focus:ring-2 focus:ring-cyan-400\n                            `,style:{boxShadow:t===Ge?"0 4px 16px 0 #1cb5e080":void 0,cursor:"pointer",letterSpacing:"0.01em"},onClick:e=>{e.preventDefault(),e.stopPropagation();try{Ps(t)}catch(a){ze(t)}},onMouseDown:e=>{e.stopPropagation()},tabIndex:0,onKeyDown:e=>{if("Enter"===e.key||" "===e.key){e.preventDefault(),e.stopPropagation();try{Ps(t)}catch(a){ze(t)}}},children:[e.icon||null,e.label]},e.label))}),T.jsx("div",{className:"px-2 sm:px-4 lg:px-6 py-4 lg:py-6 w-full relative z-0",children:T.jsx("div",{className:"w-full relative z-0",children:s.map((e,t)=>{const a=`${Ge}-${t}`,s=Ca[a];return T.jsxs("div",{className:"mb-6 w-full",children:[e.label&&T.jsxs("button",{className:"w-full px-2 sm:px-5 py-3 font-extrabold text-base sm:text-lg lg:text-[1.05rem] text-[#03B0F5] bg-gray-200 hover:bg-gray-300 border-2 border-gray-400 rounded-lg flex items-center justify-between transition-colors duration-200 shadow-md",onClick:()=>(e=>{Ta(t=>({...t,[e]:!t[e]}))})(a),children:[T.jsx("span",{children:e.label}),T.jsx("svg",{className:"w-5 h-5 transform transition-transform duration-200 "+(s?"":"rotate-180"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(!e.label||!s)&&T.jsx("div",{className:"w-full mt-2",children:e.content})]},t)})})})]})}return!V&&C&&Object.keys(C).length>0&&!ae("show")?T.jsx("div",{className:"min-h-screen bg-black text-white flex items-center justify-center",children:T.jsxs("div",{className:"text-center",children:[T.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Access Denied"}),T.jsx("p",{className:"text-gray-400",children:"You don't have permission to view login records."})]})}):T.jsxs(I.Fragment,{children:[T.jsx("style",{children:"\n        .sticky-table-container {\n            max-height: 600px;\n            overflow-y: auto;\n            overflow-x: auto;\n            border-radius: 12px;\n        }\n        \n        .sticky-header {\n            position: sticky;\n            top: 0;\n            background: white;\n            z-index: 10;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        }\n        \n        .sticky-th {\n            position: sticky;\n            top: 0;\n            background: white;\n            z-index: 10;\n            border-bottom: 2px solid #e5e7eb;\n        }\n        \n        /* Smooth animations for filter popup */\n        @keyframes fadeIn {\n            from {\n                opacity: 0;\n            }\n            to {\n                opacity: 1;\n            }\n        }\n        \n        @keyframes slideUp {\n            from {\n                opacity: 0;\n                transform: translateY(20px) scale(0.95);\n            }\n            to {\n                opacity: 1;\n                transform: translateY(0) scale(1);\n            }\n        }\n        \n        .animate-fadeIn {\n            animation: fadeIn 0.2s ease-out;\n        }\n        \n        /* Smooth scrollbar for filter popup */\n        .filter-scroll::-webkit-scrollbar {\n            width: 8px;\n            height: 8px;\n        }\n        \n        .filter-scroll::-webkit-scrollbar-track {\n            background: #1f2937;\n            border-radius: 4px;\n        }\n        \n        .filter-scroll::-webkit-scrollbar-thumb {\n            background: #4b5563;\n            border-radius: 4px;\n            transition: background 0.2s;\n        }\n        \n        .filter-scroll::-webkit-scrollbar-thumb:hover {\n            background: #6b7280;\n        }\n    "}),T.jsxs("div",{className:"min-h-screen bg-black text-white font-sans overflow-hidden",children:[T.jsx("div",{className:"fixed inset-0 opacity-[0.02] pointer-events-none z-0",style:{backgroundImage:"radial-gradient(circle at 1px 1px, rgba(255,255,255,0.15) 1px, transparent 0)",backgroundSize:"20px 20px"}}),T.jsx("div",{className:"relative z-10 flex h-screen",children:T.jsx("div",{className:"flex-1 overflow-y-auto",children:T.jsxs("div",{className:"px-6 py-8 space-y-8",children:[T.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:T.jsx("div",{})}),T.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-6",children:se.map(({key:e,label:t,icon:a,gradient:s,shadowColor:n},l)=>T.jsxs("div",{className:`p-4 rounded-xl bg-gradient-to-r ${s} shadow-lg ${n}`,children:[T.jsxs("div",{className:"flex justify-between items-center",children:[T.jsx(a,{className:"w-6 h-6 text-white"}),T.jsx("span",{className:"text-xl font-bold text-white",children:ss[e]||0})]}),T.jsx("p",{className:"mt-4 text-md text-white font-medium uppercase tracking-wide",children:t})]},l))}),T.jsxs("div",{className:"bg-black-900 rounded-xl shadow-lg",children:[T.jsx("div",{className:"sticky top-0 z-10 bg-black-900 rounded-t-xl",children:T.jsxs("div",{className:"flex items-center justify-between gap-4 mb-4 px-4 pt-4",children:[T.jsxs("div",{className:"flex items-center gap-3",children:[!re()&&!Z||At?re()||Z?T.jsxs("div",{className:"flex items-center gap-6 bg-gray-900 rounded-lg p-3",children:[T.jsxs("label",{className:"flex items-center cursor-pointer text-[#03B0F5] font-bold",children:[T.jsx("input",{type:"checkbox",className:"accent-blue-500 mr-2",checked:Ks,onChange:e=>{if(e.target.checked){const e=xe.map((e,t)=>t);Ot(e),It(xe.map(e=>e._id))}else Ot([]),It([])},style:{width:18,height:18}}),"Select All"]}),T.jsxs("span",{className:"text-white font-semibold",children:[Et.length," row",1!==Et.length?"s":""," selected"]}),Z&&T.jsxs("button",{className:"px-3 py-1 bg-red-600 text-white rounded font-bold hover:bg-red-700 transition",onClick:async()=>{if(0!==Et.length&&window.confirm(`Are you sure you want to delete ${Et.length} selected lead${Et.length>1?"s":""}?`))try{O.loading("Deleting selected leads...",0);const e=Et.map(e=>xe[e]._id),t=localStorage.getItem("userId"),a=localStorage.getItem("token"),s=e.map(async e=>{const s=await fetch(`${J}/lead-login/login-leads/${e}?user_id=${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(!s.ok)throw new Error(`Failed to delete lead ${e}: ${s.status}`);return e});await Promise.all(s),O.destroy(),O.success(`âœ… Successfully deleted ${Et.length} lead${Et.length>1?"s":""}!`,5),Dt(!1),Ot([]),It([]),"caches"in window&&caches.delete("api-cache"),setTimeout(()=>{js()},100)}catch(e){O.destroy();try{O.error(`âŒ Failed to delete leads: ${e.message}`,5)}catch(t){alert(`Failed to delete leads: ${e.message}`)}}},disabled:0===Et.length,children:["Delete (",Et.length,")"]}),T.jsx("button",{className:"px-3 py-1 bg-gray-600 text-white rounded font-bold hover:bg-gray-700 transition",onClick:()=>{Dt(!1),Ot([]),It([])},children:"Cancel"})]}):null:T.jsxs("button",{className:"px-5 py-3 rounded-lg flex items-center gap-2 transition font-bold text-base "+(Tt.length>0?"bg-green-600 hover:bg-green-700 text-white":"bg-[#03B0F5] hover:bg-[#0280b5] text-white"),onClick:()=>{Dt(!0),Ot([]),It([])},children:[T.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),Tt.length>0?`Selected (${Tt.length})`:"Select"]}),(ve||ps()>0)&&T.jsxs("div",{className:"text-base text-gray-300 bg-[#1b2230] px-4 py-3 rounded-lg border border-gray-600",children:[xe.length," of ",me.length," leads",ve&&T.jsxs("span",{className:"ml-2",children:['matching "',T.jsx("span",{className:"text-cyan-400 font-semibold",children:ve}),'"']}),ba&&T.jsx("span",{className:"ml-2 text-yellow-400 font-semibold",children:"â€¢ Clearing cache..."})]}),ba&&T.jsx("div",{className:"text-base text-yellow-300 bg-yellow-900/20 px-4 py-3 rounded-lg border border-yellow-500/50",children:"ðŸ”„ Cache clearing in progress - ensuring fresh data from database"}),Tt.length>0&&!At&&T.jsx("div",{className:"text-base text-green-300 bg-[#1b2230] px-4 py-3 rounded-lg border border-green-600",children:T.jsxs("span",{className:"flex items-center gap-2",children:[T.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),Tt.length," lead",1!==Tt.length?"s":""," selected"]})})]}),T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsxs("button",{className:"px-5 py-3 rounded-lg font-bold shadow transition relative flex items-center gap-3 text-base "+(ps()>0?"bg-orange-500 text-white hover:bg-orange-600":"bg-gray-600 text-white hover:bg-gray-700"),onClick:()=>Ea(!0),children:[T.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filter",ps()>0&&T.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-sm rounded-full h-6 w-6 flex items-center justify-center",children:ps()})]}),T.jsxs("div",{className:"relative w-[320px]",children:[T.jsx("input",{type:"text",placeholder:"Search by name, phone, email, company, city, status...",value:ve,onChange:e=>_e(e.target.value),className:"w-full py-3 pl-10 pr-4 bg-[#1b2230] text-gray-300 rounded-lg focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 text-base placeholder-gray-500 truncate",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}),T.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:T.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),ve&&T.jsx("button",{onClick:()=>_e(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-300",children:T.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})]})]})}),T.jsx("div",{className:"w-full bg-black",style:{marginLeft:0},children:T.jsxs("div",{className:"relative",children:[rt&&T.jsx("button",{onClick:()=>bs("left"),className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-white p-4 rounded-full shadow-lg transition-all duration-200 opacity-20 hover:opacity-100",style:{backgroundColor:"rgba(37, 99, 235, 1)",zIndex:9999},onMouseEnter:e=>e.target.style.backgroundColor="rgba(29, 78, 216, 1)",onMouseLeave:e=>e.target.style.backgroundColor="rgba(37, 99, 235, 1)","aria-label":"Scroll left",children:T.jsx(o,{className:"w-9 h-9"})}),it&&T.jsx("button",{onClick:()=>bs("right"),className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-white p-4 rounded-full shadow-lg transition-all duration-200 opacity-20 hover:opacity-100",style:{backgroundColor:"rgba(37, 99, 235, 1)",zIndex:9999},onMouseEnter:e=>e.target.style.backgroundColor="rgba(29, 78, 216, 1)",onMouseLeave:e=>e.target.style.backgroundColor="rgba(37, 99, 235, 1)","aria-label":"Scroll right",children:T.jsx(i,{className:"w-9 h-9"})}),T.jsx("div",{ref:dt,className:"overflow-auto max-h-[600px] sticky-table-container",onScroll:fs,children:T.jsxs("table",{className:"min-w-[1700px] w-full",children:[T.jsx("thead",{className:"text-blue-900 bg-white sticky top-0 z-10 sticky-header",children:T.jsxs("tr",{children:[(re()||Z)&&At&&T.jsx("th",{className:"py-1 px-4 text-lg font-extrabold text-[#03B0F5] text-left whitespace-nowrap sticky-th",children:"â˜‘ï¸"}),T.jsx("th",{className:"py-1 px-4 text-lg font-extrabold text-[#03B0F5] text-left whitespace-nowrap sticky-th",children:"#"}),T.jsx("th",{className:"py-1 px-4 text-lg font-extrabold text-[#03B0F5] text-left whitespace-nowrap sticky-th",children:"LOGIN DATE"}),T.jsx("th",{className:"py-1 px-4 text-lg font-extrabold text-[#03B0F5] text-left whitespace-nowrap sticky-th",children:"CREATED BY"}),T.jsx("th",{className:"py-1 px-4 text-lg font-extrabold text-[#03B0F5] text-left whitespace-nowrap sticky-th",children:"TEAM NAME"}),T.jsx("th",{className:"py-1 px-4 text-lg font-extrabold text-[#03B0F5] text-left whitespace-nowrap sticky-th",children:"CUSTOMER NAME"}),T.jsx("th",{className:"py-1 px-4 text-lg font-extrabold text-[#03B0F5] text-left whitespace-nowrap sticky-th",children:"STATUS"}),T.jsx("th",{className:"py-1 px-4 text-lg font-extrabold text-[#03B0F5] text-left whitespace-nowrap sticky-th",children:"TOTAL INCOME"}),T.jsx("th",{className:"py-1 px-4 text-lg font-extrabold text-[#03B0F5] text-left whitespace-nowrap sticky-th",children:"FOIR ELIGIBILITY"}),T.jsx("th",{className:"py-1 px-4 text-lg font-extrabold text-[#03B0F5] text-left whitespace-nowrap sticky-th",children:"LOAN AMOUNT REQUIRED"}),T.jsx("th",{className:"py-1 px-4 text-lg font-extrabold text-[#03B0F5] text-left whitespace-nowrap sticky-th",children:"NET DISBURSEMENT AMOUNT"}),T.jsx("th",{className:"py-1 px-4 text-lg font-extrabold text-[#03B0F5] text-left whitespace-nowrap sticky-th",children:"COMPANY NAME"})]})}),T.jsxs("tbody",{children:[ge?T.jsx(T.Fragment,{children:[...Array(10)].map((e,t)=>T.jsxs("tr",{className:"border-b border-gray-800 animate-pulse",children:[(re()||Z)&&At&&T.jsx("td",{className:"py-3 px-4",children:T.jsx("div",{className:"h-4 w-4 bg-gray-700 rounded"})}),T.jsx("td",{className:"py-3 px-4",children:T.jsx("div",{className:"h-4 w-8 bg-gray-700 rounded"})}),T.jsx("td",{className:"py-3 px-4",children:T.jsx("div",{className:"h-4 w-24 bg-gray-700 rounded"})}),T.jsx("td",{className:"py-3 px-4",children:T.jsx("div",{className:"h-4 w-32 bg-gray-700 rounded"})}),T.jsx("td",{className:"py-3 px-4",children:T.jsx("div",{className:"h-4 w-28 bg-gray-700 rounded"})}),T.jsx("td",{className:"py-3 px-4",children:T.jsx("div",{className:"h-4 w-40 bg-gray-700 rounded"})}),T.jsx("td",{className:"py-3 px-4",children:T.jsx("div",{className:"h-4 w-36 bg-gray-700 rounded"})}),T.jsx("td",{className:"py-3 px-4",children:T.jsx("div",{className:"h-4 w-24 bg-gray-700 rounded"})}),T.jsx("td",{className:"py-3 px-4",children:T.jsx("div",{className:"h-4 w-20 bg-gray-700 rounded"})}),T.jsx("td",{className:"py-3 px-4",children:T.jsx("div",{className:"h-4 w-32 bg-gray-700 rounded"})}),T.jsx("td",{className:"py-3 px-4",children:T.jsx("div",{className:"h-4 w-28 bg-gray-700 rounded"})}),T.jsx("td",{className:"py-3 px-4",children:T.jsx("div",{className:"h-4 w-36 bg-gray-700 rounded"})})]},t))}):ja?T.jsx("tr",{children:T.jsx("td",{colSpan:(re()||Z)&&At?"13":"12",className:"text-center py-10 text-gray-500",children:T.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[T.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"}),T.jsx("span",{children:"Checking activity for leads..."})]})})}):0===Ds.length?T.jsx("tr",{children:T.jsxs("td",{colSpan:(re()||Z)&&At?"13":"12",className:"text-center py-10 text-gray-500",children:["No Leads Found","all"!==ce&&T.jsxs("div",{className:"mt-2",children:[T.jsxs("span",{className:"text-md text-gray-400",children:["for ",vt.find(e=>e._id===ce)?.name||"selected loan type"]}),T.jsx("br",{}),T.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-md mt-2",onClick:()=>{de("all"),localStorage.setItem("selectedLoanType","all")},children:"Show All Leads"})]})]})}):Ds.map((e,t)=>T.jsxs("tr",{className:"border-b border-gray-800 hover:bg-gray-800 transition cursor-pointer",onClick:()=>Os(e),children:[(re()||Z)&&At&&T.jsx("td",{className:"text-left py-3 px-4 text-sm font-bold whitespace-nowrap",onClick:e=>e.stopPropagation(),children:T.jsx("input",{type:"checkbox",className:"accent-blue-500",checked:Et.includes(t),onChange:()=>(e=>{let t;t=Et.includes(e)?Et.filter(t=>t!==e):[...Et,e],Ot(t);const a=t.map(e=>xe[e]._id);It(a)})(t),style:{width:18,height:18}})}),T.jsx("td",{className:"text-left py-3 px-4 text-sm font-bold whitespace-nowrap",children:t+1}),T.jsx("td",{className:"text-left py-3 px-4 text-sm font-bold whitespace-nowrap",children:e.login_date?Hs(e.login_date):"-"}),T.jsx("td",{className:"text-left py-3 px-4 text-sm font-bold whitespace-nowrap",children:T.jsx("span",{className:"text-sm font-bold text-wrap",children:le(e,"creator_name")||"-"})}),T.jsx("td",{className:"text-left py-3 px-4 text-sm font-bold whitespace-nowrap",children:e.team_name||"-"}),T.jsx("td",{className:"text-left py-3 px-4 text-sm font-bold whitespace-wrap",children:e.customer_name||"-"}),T.jsx("td",{className:"text-left py-3 px-4 text-md whitespace-nowrap relative",onClick:e=>e.stopPropagation(),children:T.jsxs("div",{className:"relative status-dropdown-container",children:[T.jsx("button",{className:"bg-gray-800 text-white py-2 px-3 rounded-md border border-gray-600 hover:bg-gray-700 transition-colors w-full text-left min-w-[150px] status-dropdown-button",onClick:e=>((e,t)=>{if(t.stopPropagation(),Wt===e)return Kt(null),void Jt("");const a=t.target.getBoundingClientRect(),s=window.pageYOffset||document.documentElement.scrollTop,n=window.pageXOffset||document.documentElement.scrollLeft;let l;l=Zt&&!qt?Object.keys(la).length||cs.length:Qt&&la[Qt]?la[Qt].length:cs.length;const r=Math.min(80+40*l,400),o=window.innerWidth,i=window.innerHeight;let c=a.left+n;c+300>o&&(c=o-300-10);const d=i-a.bottom,m=a.top;let u,x;d>=r+10?(u=a.bottom+s+5,x=Math.min(r,d-10)):m>=r+10?(u=a.top+s-r-5,x=Math.min(r,m-10)):m>d?(x=m-10,u=a.top+s-x-5):(x=d-10,u=a.bottom+s+5),Yt({top:u,left:c,maxHeight:Math.max(x,200)}),Kt(e),Jt(""),Xt(null),ea(!0)})(t,e),children:T.jsx("div",{className:"font-medium text-white truncate w-full text-md",children:e.sub_status?T.jsxs("div",{children:[T.jsx("div",{children:"object"==typeof e.sub_status?e.sub_status.name||"Unknown Sub-Status":e.sub_status||"Unknown Sub-Status"}),T.jsx("div",{className:"text-xs text-gray-400",children:"object"==typeof e.status?e.status.name||"Unknown Status":e.status||"Unknown Status"})]}):"object"==typeof e.status?e.status.name||"Select Status":e.status||"Select Status"})}),Wt===t&&T.jsxs("div",{className:"fixed bg-white border border-gray-300 rounded-lg shadow-xl z-[9999] status-dropdown-menu flex flex-col",style:{top:`${Vt.top}px`,left:`${Vt.left}px`,minWidth:"280px",maxWidth:"400px",maxHeight:`${Vt.maxHeight||400}px`,backgroundColor:"white",zIndex:9999,overflowY:"hidden"},onClick:e=>{e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},onScroll:e=>{e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},onWheel:e=>{e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},children:[T.jsxs("div",{className:"p-3 border-b border-gray-200 bg-white sticky top-0 z-10 rounded-t-lg",children:[!Zt&&Qt&&T.jsxs("div",{className:"flex items-center justify-between mb-2",children:[T.jsxs("button",{onClick:e=>{e.stopPropagation(),Xt(null),ea(!0),Jt("")},className:"flex items-center text-blue-600 hover:text-blue-800 text-sm font-medium",children:[T.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"Back to Main Statuses"]}),T.jsx("span",{className:"text-xs text-gray-600 font-medium",children:Qt})]}),T.jsxs("div",{className:"relative",children:[T.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:T.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),T.jsx("input",{type:"text",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg text-black focus:outline-none focus:border-sky-400",placeholder:Zt?"Search main statuses...":"Search sub-statuses...",value:qt,onChange:e=>Jt(e.target.value),onClick:e=>e.stopPropagation(),autoFocus:!0})]})]}),T.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-100 bg-white rounded-b-lg",style:{height:"220px",overflowY:"auto"},onScroll:e=>e.stopPropagation(),children:ca?T.jsx("div",{className:"px-4 py-3 text-center text-gray-400",children:"Loading statuses..."}):qt?(()=>{const a=Gs();return a.results.length>0?a.results.map((a,s)=>{const n=("object"==typeof e.sub_status?(e.sub_status?.name||"Unknown")===a.name:e.sub_status===a.name)||("object"==typeof e.status?(e.status?.name||"Unknown")===a.name:e.status===a.name);return T.jsx("div",{className:"px-4 py-3 cursor-pointer text-black hover:bg-blue-100 transition-colors border-b border-gray-100 last:border-b-0 text-left "+(n?"bg-yellow-400 text-black font-bold":""),style:{minHeight:"40px"},onClick:e=>{e.stopPropagation(),Bs(t,a.name,!0)},onMouseDown:e=>e.preventDefault(),children:T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{className:"flex-1",children:[T.jsx("div",{className:"text-sm font-medium text-left",children:a.name}),T.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"sub"===a.type?T.jsxs(T.Fragment,{children:["Sub-status of: ",a.mainStatus]}):T.jsxs(T.Fragment,{children:["Main status",la[a.name]&&la[a.name].length>0?` (${la[a.name].length} sub-statuses)`:""]})})]}),"main"===a.type&&la[a.name]&&la[a.name].length>0&&T.jsx("div",{className:"text-blue-500 text-sm font-medium ml-2",children:T.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})})]})},`search-result-${s}-${a.name}`)}):T.jsx("div",{className:"px-4 py-3 text-base text-gray-500 text-center",children:"No statuses match your search."})})():Fs().length>0?Fs().map((a,s)=>{const n="object"==typeof a?a.name:a,l=Zt&&la[n]&&la[n].length>0,r=("object"==typeof e.sub_status?(e.sub_status?.name||"Unknown")===n:e.sub_status===n)||("object"==typeof e.status?(e.status?.name||"Unknown")===n:e.status===n);return T.jsx("div",{className:"px-4 py-3 cursor-pointer text-black hover:bg-blue-100 transition-colors border-b border-gray-100 last:border-b-0 text-left "+(r?"bg-yellow-400 text-black font-bold":""),style:{minHeight:"40px"},onClick:e=>{e.stopPropagation(),l?Rs(n):Bs(t,n)},onMouseDown:e=>e.preventDefault(),children:T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{className:"flex-1",children:[T.jsx("div",{className:"text-sm font-medium text-left",children:n}),!Zt&&T.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Main: ",zs(n)]}),l&&T.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[la[n].length," sub-status",1!==la[n].length?"es":""]})]}),l&&T.jsx("div",{className:"text-blue-500 text-sm font-medium ml-2",children:T.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})})]})},`status-${s}-${n}`)}):T.jsxs("div",{className:"px-4 py-3 text-base text-gray-500 text-center",children:["No ",Zt?"statuses":"sub-statuses"," available."]})})]})]})}),T.jsx("td",{className:"text-left py-3 px-4 text-md whitespace-nowrap",children:ne(le(e,"total_income")||le(e,"salary"))}),T.jsx("td",{className:"text-left py-3 px-4 text-md whitespace-nowrap",children:le(e,"foir_eligibility")||le(e,"foir")||"-"}),T.jsx("td",{className:"text-left py-3 px-4 text-md whitespace-nowrap",children:ne(e.loan_amount)}),T.jsx("td",{className:"text-left py-3 px-4 text-md whitespace-nowrap",children:ne(le(e,"net_disbursement_amount"))}),T.jsx("td",{className:"text-left py-3 px-4 text-md whitespace-nowrap",children:le(e,"company_name")||"-"})]},e._id)),Es&&Ds.length>0&&T.jsx("tr",{children:T.jsxs("td",{colSpan:(re()||Z)&&At?"13":"12",className:"py-6 text-center bg-black",children:[T.jsxs("button",{onClick:()=>je(e=>e+100),className:"px-8 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-all duration-200 transform hover:scale-105 shadow-lg",children:["Show More (",Math.min(100,As.length-fe)," more leads)"]}),T.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Showing ",Ds.length," of ",As.length," leads"]})]})}),!Es&&Ds.length>0&&T.jsx("tr",{children:T.jsx("td",{colSpan:(re()||Z)&&At?"13":"12",className:"py-6 text-center bg-black text-gray-400",children:T.jsxs("p",{className:"text-sm",children:["â€” End of leads (",As.length," total) â€”"]})})})]})]})})]})}),T.jsx($,{title:"Update Operations Details",open:Ie,onCancel:()=>Ae(!1),footer:[T.jsx(F,{onClick:()=>Ae(!1),children:"Cancel"},"cancel"),T.jsx(F,{type:"primary",onClick:()=>{rs.validateFields().then(e=>{(async(e,t)=>{try{const a=localStorage.getItem("userId"),s={activity_type:"operations_update",description:"Lead operations data updated",created_by:localStorage.getItem("userName")||"Unknown User",user_id:a,created_at:(new Date).toISOString(),details:{fields_updated:Object.keys(t)}},n={...t,activity:s};(await fetch(`${J}/lead-login/update-operations/${e}?user_id=${a}`,{method:"PATCH",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify(n)})).ok?(O.success("Operations data updated successfully"),Ns()):O.error("Failed to update operations data")}catch(a){O.error("Error updating operations data")}})(ke._id,e),Ae(!1),rs.resetFields()}).catch(e=>{})},children:"Submit"},"submit")],children:T.jsx(E,{form:rs,layout:"vertical"})}),T.jsx($,{title:"Validate Important Questions",open:De,onCancel:()=>Ee(!1),footer:[T.jsx(F,{onClick:()=>Ee(!1),children:"Cancel"},"cancel"),T.jsx(F,{type:"primary",onClick:()=>{(async(e,t)=>{try{const a=localStorage.getItem("userId"),s={responses:t,activity:{activity_type:"question_validation",description:"Important questions validated",created_by:localStorage.getItem("userName")||"Unknown User",user_id:a,created_at:(new Date).toISOString(),details:{questions_validated:Object.keys(t).length,question_ids:Object.keys(t)}}},n=await fetch(`${J}/lead-login/validate-questions/${e}?user_id=${a}`,{method:"PATCH",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify(s)});if(n.ok)O.success("All questions validated successfully"),Ns();else{const e=await n.json();O.error(e.detail||"Failed to validate questions")}}catch(a){O.error("Error validating questions")}})(ke._id,Lt),Ee(!1),Ct({})},children:"Confirm"},"submit")],width:700,children:St.length>0?T.jsxs("div",{className:"questions-container",children:[T.jsx("h4",{children:"Please validate the following important questions:"}),T.jsx(R,{}),T.jsx(E,{layout:"vertical",children:St.map((e,t)=>T.jsx(E.Item,{label:e.question||e.question_text,children:"checkbox"===e.type?T.jsx(M,{onChange:t=>{Ct({...Lt,[e.id||e._id]:t.target.checked})},checked:Lt[e.id||e._id]||!1,children:"Yes"}):T.jsx(P,{style:{width:"100%"},placeholder:"Select response",onChange:t=>{Ct({...Lt,[e.id||e._id]:t})},value:Lt[e.id||e._id]||void 0,children:e.options&&Array.isArray(e.options)?e.options.map((e,t)=>T.jsx(P.Option,{value:e,children:e},t)):["Yes","No","N/A"].map((e,t)=>T.jsx(P.Option,{value:e,children:e},t))})},e.id||t))})]}):T.jsx("div",{className:"empty-questions",children:T.jsx("p",{children:"No important questions are configured for validation. Please contact your administrator."})})}),T.jsx($,{title:"Assign Lead to Users",open:Oe,onCancel:()=>Be(!1),footer:[T.jsx(F,{onClick:()=>Be(!1),children:"Cancel"},"cancel"),T.jsx(F,{type:"primary",onClick:()=>{os.validateFields().then(e=>{(async(e,t)=>{try{const a=localStorage.getItem("userId"),s=localStorage.getItem("userName")||"Unknown User",n=(me.find(t=>t._id===e),{activity_type:"assignment",description:`Lead assigned to ${t.length} user(s)`,created_by:s,user_id:a,created_at:(new Date).toISOString()});(await fetch(`${J}/lead-login/assign-multiple-users/${e}?user_id=${a}`,{method:"PATCH",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify({assigned_user_ids:t,activity:n})})).ok?(O.success("Lead assigned successfully"),Ns()):O.error("Failed to assign lead")}catch(a){O.error("Error assigning lead")}})(ke._id,e.assignedUsers),Be(!1),os.resetFields()}).catch(e=>{})},children:"Assign"},"submit")],children:T.jsx(E,{form:os,layout:"vertical"})}),T.jsx($,{title:"Assign Multiple Leads",open:$e,onCancel:()=>Fe(!1),footer:[T.jsx(F,{onClick:()=>Fe(!1),children:"Cancel"},"cancel"),T.jsx(F,{type:"primary",onClick:()=>{is.validateFields().then(e=>{(async e=>{if(0!==Tt.length)try{const t=localStorage.getItem("userId"),a=localStorage.getItem("userName")||"Unknown User",s={activity_type:"bulk_assignment",description:`Leads assigned to ${e.length} user(s) in bulk operation`,created_by:a,user_id:t,created_at:(new Date).toISOString()},n=Tt.map(a=>fetch(`${J}/lead-login/assign-multiple-users/${a}?user_id=${t}`,{method:"PATCH",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify({assigned_user_ids:e,activity:s})})),l=(await Promise.all(n)).filter(e=>e.ok).length;l===Tt.length?O.success(`Successfully assigned ${l} leads`):O.warning(`Assigned ${l} out of ${Tt.length} leads`),It([]),Ns()}catch(t){O.error("Error bulk assigning leads")}else O.warning("Please select leads to assign")})(e.assignedUsers),Fe(!1),is.resetFields()}).catch(e=>{})},children:"Assign"},"submit")],children:T.jsx(E,{form:is,layout:"vertical"})}),T.jsxs($,{title:"Update Lead Status",open:Bt,onOk:async()=>{if(Ft&&Mt)try{pe(!0);const e=localStorage.getItem("userId"),t=localStorage.getItem("userName")||"Unknown User",a={activity_type:"status_update",description:`Status changed from "${Ft.status||"Not Set"}" to "${Mt}"${Ut?` with sub-status "${Ut}"`:""}`,performed_by:e,performed_by_name:t,details:{previous_status:Ft.status||null,previous_sub_status:Ft.sub_status||null,new_status:Mt,new_sub_status:Ut||null}},s=await fetch(`${J}/lead-login/login-leads/${Ft._id}?user_id=${e}`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify({status:Mt,sub_status:Ut||null,activity:a})});if(s.ok){O.success("Status updated successfully"),$t(!1);const e=me.map(e=>e._id===Ft._id?{...e,status:Mt,sub_status:Ut||null}:e);ue(e),ns(as(e,ce)),await Ns()}else{const e=await s.json();O.error(e.detail||"Failed to update status")}}catch(e){O.error("Error updating status")}finally{pe(!1)}else O.error("Status is required")},onCancel:()=>$t(!1),confirmLoading:ge,children:[T.jsxs(E,{layout:"vertical",children:[T.jsxs(U,{gutter:16,children:[T.jsx(G,{span:12,children:T.jsx(E.Item,{label:"Current Status",children:T.jsx(z,{value:Ft?.status||"Not Set",disabled:!0})})}),T.jsx(G,{span:12,children:T.jsx(E.Item,{label:"Current Sub-Status",children:T.jsx(z,{value:Ft?.sub_status||"Not Set",disabled:!0})})})]}),T.jsxs(U,{gutter:16,children:[T.jsx(G,{span:12,children:T.jsx(E.Item,{label:"New Status",required:!0,children:T.jsx(P,{value:Mt,onChange:e=>{Pt(e),Gt(""),(async e=>{try{const t=await fetch(`${J}/leads/statuses/login?user_id=${localStorage.getItem("userId")}`);if(t.ok){const a=(await t.json()).find(t=>t.name.toLowerCase()===e.toLowerCase());a&&a.sub_statuses&&a.sub_statuses.length>0?Ht(a.sub_statuses.map(e=>({value:e.name,label:e.name}))):Ht([])}else Ht([])}catch(t){Ht([])}})(e)},style:{width:"100%"},children:cs.map(e=>"all"!==e.value&&T.jsx(Q,{value:e.value,children:e.label},e.value))})})}),T.jsx(G,{span:12,children:T.jsx(E.Item,{label:"New Sub-Status",children:T.jsx(P,{value:Ut,onChange:Gt,style:{width:"100%"},placeholder:"Select Sub-Status",allowClear:!0,loading:0===zt.length&&""!==Mt,children:zt.map(e=>T.jsx(Q,{value:e.value,children:e.label},e.value))})})})]})]}),T.jsx("div",{style:{marginTop:"8px",fontSize:"12px",color:"#666"},children:"ðŸ’¡ Selecting a new status will load corresponding sub-statuses"})]}),Da&&T.jsx("div",{className:"fixed inset-0 bg-transparent bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-[9999] animate-fadeIn",onClick:e=>{e.target===e.currentTarget&&(Ea(!1),Ja())},style:{animation:"fadeIn 0.2s ease-out"},children:T.jsxs("div",{className:"bg-[#1b2230] border border-gray-600 rounded-lg shadow-2xl p-6 w-[800px] max-w-[90vw] h-[600px] flex flex-col relative transform transition-all duration-300 ease-out",style:{animation:"slideUp 0.3s ease-out"},onClick:e=>e.stopPropagation(),children:[T.jsxs("div",{className:"flex justify-between items-center mb-6 flex-shrink-0",children:[T.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[T.jsx(c,{className:"w-6 h-6 text-blue-400"}),"Filter Login"]}),T.jsx("button",{onClick:()=>{Ea(!1),Ja()},className:"text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg p-2 transition-all duration-200 text-2xl leading-none",title:"Close",children:"Ã—"})]}),T.jsxs("div",{className:"grid grid-cols-3 gap-6 flex-1 overflow-hidden min-h-0 relative",children:[T.jsxs("div",{className:"col-span-1 border-r border-gray-600 pr-4 overflow-y-auto max-h-full relative",style:{scrollbarWidth:"thin",scrollbarColor:"#4B5563 #1F2937"},children:[T.jsx("h3",{className:"text-base font-medium text-gray-300 mb-4 sticky top-0 bg-[#1b2230] py-2 z-10",children:"Filter Categories"}),T.jsxs("div",{className:"space-y-3",children:[T.jsx("button",{onClick:()=>Ba("leadDate"),className:"w-full text-left px-4 py-3 rounded-lg transition-colors "+("leadDate"===Oa?"bg-blue-600 text-white":"text-gray-300 hover:bg-[#2a3441]"),children:T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx(d,{className:"w-5 h-5"}),T.jsx("span",{className:"text-base",children:" Login Date Filters"})]}),ys("leadDate")>0&&T.jsx("span",{className:"bg-red-500 text-white text-sm rounded-full h-6 w-6 flex items-center justify-center",children:ys("leadDate")})]})}),T.jsx("button",{onClick:()=>Ba("date"),className:"w-full text-left px-3 py-2 rounded-lg transition-colors "+("date"===Oa?"bg-blue-600 text-white":"text-gray-300 hover:bg-[#2a3441]"),children:T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx(m,{className:"w-4 h-4"}),"Login Age"]}),ys("date")>0&&T.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:ys("date")})]})}),T.jsx("button",{onClick:()=>Ba("createdBy"),className:"w-full text-left px-3 py-2 rounded-lg transition-colors "+("createdBy"===Oa?"bg-blue-600 text-white":"text-gray-300 hover:bg-[#2a3441]"),children:T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx(u,{className:"w-4 h-4"}),"Created By"]}),ys("createdBy")>0&&T.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:ys("createdBy")})]})}),T.jsx("button",{onClick:()=>Ba("status"),className:"w-full text-left px-3 py-2 rounded-lg transition-colors "+("status"===Oa?"bg-blue-600 text-white":"text-gray-300 hover:bg-[#2a3441]"),children:T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx(l,{className:"w-4 h-4"}),"Status"]}),ys("status")>0&&T.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:ys("status")})]})}),T.jsx("button",{onClick:()=>Ba("team"),className:"w-full text-left px-3 py-2 rounded-lg transition-colors "+("team"===Oa?"bg-blue-600 text-white":"text-gray-300 hover:bg-[#2a3441]"),children:T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx(a,{className:"w-4 h-4"}),"Team Name"]}),ys("team")>0&&T.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:ys("team")})]})}),T.jsx("button",{onClick:()=>Ba("assignedTL"),className:"w-full text-left px-3 py-2 rounded-lg transition-colors "+("assignedTL"===Oa?"bg-blue-600 text-white":"text-gray-300 hover:bg-[#2a3441]"),children:T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx(u,{className:"w-4 h-4"}),"Assigned TL"]}),ys("assignedTL")>0&&T.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:ys("assignedTL")})]})}),T.jsx("button",{onClick:()=>Ba("loginDepartment"),className:"w-full text-left px-3 py-2 rounded-lg transition-colors "+("loginDepartment"===Oa?"bg-blue-600 text-white":"text-gray-300 hover:bg-[#2a3441]"),children:T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx(u,{className:"w-4 h-4"}),"Login Person/Department"]}),ys("loginDepartment")>0&&T.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:ys("loginDepartment")})]})}),T.jsx("button",{onClick:()=>Ba("channelName"),className:"w-full text-left px-3 py-2 rounded-lg transition-colors "+("channelName"===Oa?"bg-blue-600 text-white":"text-gray-300 hover:bg-[#2a3441]"),children:T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx(H,{className:"w-4 h-4"}),"Channel"]}),ys("channelName")>0&&T.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:ys("channelName")})]})}),T.jsx("button",{onClick:()=>Ba("income"),className:"w-full text-left px-3 py-2 rounded-lg transition-colors "+("income"===Oa?"bg-blue-600 text-white":"text-gray-300 hover:bg-[#2a3441]"),children:T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),"Total Income"]}),ys("income")>0&&T.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:ys("income")})]})}),T.jsx("button",{onClick:()=>Ba("leadActivity"),className:"w-full text-left px-3 py-2 rounded-lg transition-colors "+("leadActivity"===Oa?"bg-blue-600 text-white":"text-gray-300 hover:bg-[#2a3441]"),children:T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx(x,{className:"w-4 h-4"}),"Quick Filters"]}),ys("leadActivity")>0&&T.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:ys("leadActivity")})]})})]})]}),T.jsx("div",{className:"col-span-2 overflow-y-auto max-h-full relative",style:{scrollbarWidth:"thin",scrollbarColor:"#4B5563 #1F2937"},children:T.jsxs("div",{className:"h-full pr-2",children:["leadDate"===Oa&&T.jsxs("div",{children:[T.jsx("h3",{className:"text-base font-medium text-gray-300 mb-4",children:"Login Date Filters"}),T.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-400 text-xs mb-1",children:"From Date"}),T.jsx("input",{type:"date",value:es.dateFrom,onChange:e=>ts({...es,dateFrom:e.target.value}),className:"w-full bg-[#1b2230] border border-gray-600 rounded px-3 py-2 text-gray-300 focus:outline-none focus:border-blue-500"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-400 text-xs mb-1",children:"To Date"}),T.jsx("input",{type:"date",value:es.dateTo,onChange:e=>ts({...es,dateTo:e.target.value}),className:"w-full bg-[#1b2230] border border-gray-600 rounded px-3 py-2 text-gray-300 focus:outline-none focus:border-blue-500"})]})]}),T.jsx("button",{onClick:()=>ts({...es,dateFrom:"",dateTo:""}),className:"mt-4 text-xs text-blue-400 hover:text-blue-300",children:"Clear Date Range"}),T.jsxs("div",{className:"border-t border-gray-600 pt-6 mt-6",children:[T.jsx("h4",{className:"text-sm font-medium text-gray-300 mb-4",children:"Disbursement Date Range"}),T.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-400 text-xs mb-1",children:"From Date"}),T.jsx("input",{type:"date",value:es.disbursementDateFrom,onChange:e=>ts({...es,disbursementDateFrom:e.target.value}),className:"w-full bg-[#1b2230] border border-gray-600 rounded px-3 py-2 text-gray-300 focus:outline-none focus:border-blue-500"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-400 text-xs mb-1",children:"To Date"}),T.jsx("input",{type:"date",value:es.disbursementDateTo,onChange:e=>ts({...es,disbursementDateTo:e.target.value}),className:"w-full bg-[#1b2230] border border-gray-600 rounded px-3 py-2 text-gray-300 focus:outline-none focus:border-blue-500"})]})]}),T.jsx("button",{onClick:()=>ts({...es,disbursementDateFrom:"",disbursementDateTo:""}),className:"mt-4 text-xs text-blue-400 hover:text-blue-300",children:"Clear Disbursement Date Range"})]}),T.jsxs("div",{className:"border-t border-gray-600 pt-6 mt-6",children:[T.jsx("h4",{className:"text-sm font-medium text-gray-300 mb-4",children:"No Activity Filter"}),T.jsxs("div",{className:"space-y-4",children:[T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-400 text-xs mb-1",children:"Show leads with no activity since this date"}),T.jsx("input",{type:"date",value:es.noActivityDate||"",onChange:e=>ts({...es,noActivityDate:e.target.value}),className:"w-full bg-[#1b2230] border border-gray-600 rounded px-3 py-2 text-gray-300 focus:outline-none focus:border-blue-500",placeholder:"Select date"})]}),es.noActivityDate&&T.jsxs("div",{className:"space-y-2",children:[ja&&T.jsxs("div",{className:"flex items-center space-x-2 text-xs text-blue-400",children:[T.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-400"}),T.jsx("span",{children:"Checking activities..."})]}),T.jsx("button",{onClick:()=>ts({...es,noActivityDate:""}),className:"text-xs text-blue-400 hover:text-blue-300",children:"Clear No Activity Filter"})]})]})]})]}),"date"===Oa&&T.jsxs("div",{children:[T.jsx("h3",{className:"text-base font-medium text-gray-300 mb-4",children:"Login Age Range (Days)"}),T.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-400 text-xs mb-1",children:"From Age (Days)"}),T.jsx("input",{type:"number",className:"w-full bg-[#1b2230] border border-gray-600 rounded px-3 py-2 text-gray-300 focus:outline-none focus:border-blue-500",placeholder:"0"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-400 text-xs mb-1",children:"To Age (Days)"}),T.jsx("input",{type:"number",className:"w-full bg-[#1b2230] border border-gray-600 rounded px-3 py-2 text-gray-300 focus:outline-none focus:border-blue-500",placeholder:"365"})]})]}),T.jsx("button",{className:"text-xs text-blue-400 hover:text-blue-300",children:"Clear Age Range"})]}),"leads"===Oa&&T.jsxs("div",{children:[T.jsx("h3",{className:"text-base font-medium text-gray-300 mb-4",children:"Login Status"}),T.jsx("div",{className:"space-y-4",children:T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-400 text-xs mb-1",children:"Lead Status"}),T.jsxs("select",{value:es.leadStatus,onChange:e=>ts({...es,leadStatus:e.target.value}),className:"w-full bg-[#1b2230] border border-gray-600 rounded px-3 py-2 text-gray-300 focus:outline-none focus:border-blue-500",children:[T.jsx("option",{value:"",children:"All Status"}),T.jsx("option",{value:"Active Login",children:"Active Login"}),T.jsx("option",{value:"Approve",children:"Approve"}),T.jsx("option",{value:"Disbursed",children:"Disbursed"}),T.jsx("option",{value:"Lost by Mistake",children:"Lost by Mistake"}),T.jsx("option",{value:"Lost Login",children:"Lost Login"})]})]})})]}),"date"===Oa&&T.jsxs("div",{children:[T.jsx("h3",{className:"text-base font-medium text-gray-300 mb-4",children:"Login Date Range"}),T.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-400 text-xs mb-1",children:"From Date"}),T.jsx("input",{type:"date",value:es.dateFrom,onChange:e=>ts({...es,dateFrom:e.target.value}),className:"w-full bg-[#1b2230] border border-gray-600 rounded px-3 py-2 text-gray-300 focus:outline-none focus:border-blue-500"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-400 text-xs mb-1",children:"To Date"}),T.jsx("input",{type:"date",value:es.dateTo,onChange:e=>ts({...es,dateTo:e.target.value}),className:"w-full bg-[#1b2230] border border-gray-600 rounded px-3 py-2 text-gray-300 focus:outline-none focus:border-blue-500"})]})]}),T.jsx("button",{onClick:()=>ts({...es,dateFrom:"",dateTo:""}),className:"mt-4 text-xs text-blue-400 hover:text-blue-300",children:"Clear Date Range"})]}),"team"===Oa&&T.jsxs("div",{children:[T.jsx("h3",{className:"text-base font-medium text-gray-300 mb-4",children:"Team Name"}),T.jsx("div",{className:"mb-4",children:T.jsxs("div",{className:"relative",children:[T.jsx("input",{type:"text",placeholder:"Search teams...",value:$a,onChange:e=>Fa(e.target.value),className:"w-full bg-[#1b2230] border border-gray-600 rounded px-3 py-2 pl-10 text-gray-300 focus:outline-none focus:border-blue-500"}),T.jsx(h,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),$a&&T.jsx("button",{onClick:()=>Fa(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-300",children:T.jsx(g,{className:"w-4 h-4"})})]})}),T.jsxs("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[ds().map(e=>T.jsxs("label",{className:"flex items-center cursor-pointer",children:[T.jsx("input",{type:"checkbox",value:e,checked:Array.isArray(es.teamName)?es.teamName.includes(e):es.teamName===e,onChange:t=>{const a=Array.isArray(es.teamName)?es.teamName:es.teamName?[es.teamName]:[];t.target.checked?ts({...es,teamName:[...a,e]}):ts({...es,teamName:a.filter(t=>t!==e)}),setTimeout(()=>Za(),0)},className:"accent-blue-500 mr-2"}),T.jsx("span",{className:"text-gray-300",children:e})]},e)),$a&&0===ds().length&&T.jsxs("div",{className:"text-gray-400 text-sm py-2 text-center",children:['No teams found matching "',$a,'"']})]})]}),"createdBy"===Oa&&T.jsxs("div",{children:[T.jsx("h3",{className:"text-base font-medium text-gray-300 mb-4",children:"Created By"}),T.jsx("div",{className:"mb-4",children:T.jsxs("div",{className:"relative",children:[T.jsx("input",{type:"text",placeholder:"Search creators...",value:Ra,onChange:e=>Ma(e.target.value),className:"w-full bg-[#1b2230] border border-gray-600 rounded px-3 py-2 pl-10 text-gray-300 focus:outline-none focus:border-blue-500"}),T.jsx(h,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),Ra&&T.jsx("button",{onClick:()=>Ma(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-300",children:T.jsx(g,{className:"w-4 h-4"})})]})}),T.jsxs("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[ms().map(e=>T.jsxs("label",{className:"flex items-center cursor-pointer",children:[T.jsx("input",{type:"checkbox",value:e,checked:Array.isArray(es.createdBy)?es.createdBy.includes(e):es.createdBy===e,onChange:t=>{const a=Array.isArray(es.createdBy)?es.createdBy:es.createdBy?[es.createdBy]:[];t.target.checked?ts({...es,createdBy:[...a,e]}):ts({...es,createdBy:a.filter(t=>t!==e)}),setTimeout(()=>Za(),0)},className:"accent-blue-500 mr-2"}),T.jsx("span",{className:"text-gray-300",children:e})]},e)),Ra&&0===ms().length&&T.jsxs("div",{className:"text-gray-400 text-sm py-2 text-center",children:['No creators found matching "',Ra,'"']})]})]}),"leadActivity"===Oa&&T.jsxs("div",{children:[T.jsx("h3",{className:"text-base font-medium text-gray-300 mb-4",children:"Quick Filters"}),T.jsx("div",{className:"space-y-4",children:T.jsxs("div",{children:[T.jsxs("label",{className:"flex items-center cursor-pointer",children:[T.jsx("input",{type:"checkbox",checked:es.checkDuplicateLeads||!1,onChange:e=>{ts({...es,checkDuplicateLeads:e.target.checked}),setTimeout(()=>Za(),0)},className:"accent-blue-500 mr-2"}),T.jsx("span",{className:"text-gray-300",children:"Check Duplicate Leads"})]}),T.jsx("p",{className:"text-xs text-gray-500 mt-1 ml-6",children:"Show leads with same phone number or alternative phone number"})]})})]}),"duplicateLeads"===Oa&&T.jsxs("div",{children:[T.jsx("h3",{className:"text-base font-medium text-gray-300 mb-4",children:"Check Duplicate Leads"}),T.jsxs("div",{className:"space-y-4",children:[T.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"This filter will show leads that have the same phone number or alternative phone number."}),T.jsxs("label",{className:"flex items-center cursor-pointer",children:[T.jsx("input",{type:"checkbox",checked:es.checkDuplicateLeads||!1,onChange:e=>{ts({...es,checkDuplicateLeads:e.target.checked}),setTimeout(()=>Za(),0)},className:"accent-blue-500 mr-2"}),T.jsx("span",{className:"text-gray-300",children:"Show Only Duplicate Leads"})]})]})]}),"disbursementDate"===Oa&&T.jsxs("div",{children:[T.jsx("h3",{className:"text-base font-medium text-gray-300 mb-4",children:"Disbursement Date Range"}),T.jsxs("div",{className:"space-y-4",children:[T.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Filter leads by disbursement date. You can specify from date, to date, or both."}),T.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-400 text-xs mb-1",children:"From Date"}),T.jsx("input",{type:"date",value:es.disbursementDateFrom,onChange:e=>ts({...es,disbursementDateFrom:e.target.value}),className:"w-full bg-[#1b2230] border border-gray-600 rounded px-3 py-2 text-gray-300 focus:outline-none focus:border-blue-500"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-gray-400 text-xs mb-1",children:"To Date"}),T.jsx("input",{type:"date",value:es.disbursementDateTo,onChange:e=>ts({...es,disbursementDateTo:e.target.value}),className:"w-full bg-[#1b2230] border border-gray-600 rounded px-3 py-2 text-gray-300 focus:outline-none focus:border-blue-500"})]})]})]})]}),"status"===Oa&&T.jsxs("div",{children:[T.jsx("h3",{className:"text-base font-medium text-gray-300 mb-4",children:"Status"}),T.jsx("div",{className:"mb-4",children:T.jsxs("div",{className:"relative",children:[T.jsx("input",{type:"text",placeholder:"Search statuses...",value:Pa,onChange:e=>Ua(e.target.value),className:"w-full bg-[#1b2230] border border-gray-600 rounded px-3 py-2 pl-10 text-gray-300 focus:outline-none focus:border-blue-500"}),T.jsx(h,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),Pa&&T.jsx("button",{onClick:()=>Ua(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-300",children:T.jsx(g,{className:"w-4 h-4"})})]})}),T.jsxs("div",{className:"flex gap-2 mb-4",children:[T.jsx("button",{onClick:()=>{ts({...es,selectedStatuses:[]})},className:"px-3 py-1 text-xs bg-gray-600 text-white rounded hover:bg-gray-700 transition",children:"Clear All"}),T.jsx("button",{onClick:()=>{const e=[];Object.entries(la).forEach(([t,a])=>{e.push(t),Array.isArray(a)&&a.forEach(a=>{const s="object"==typeof a?a.name:a;s&&s!==t&&e.push(s)})}),ts({...es,selectedStatuses:[...new Set(e)]})},className:"px-3 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Select All"})]}),T.jsxs("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[(!es.selectedStatuses||0===es.selectedStatuses.length)&&T.jsx("div",{className:"mb-3 p-2 bg-green-900/20 border border-green-700/30 rounded text-green-300 text-sm",children:"âœ“ Showing all statuses (no filter applied)"}),es.selectedStatuses&&es.selectedStatuses.length>0&&T.jsxs("div",{className:"mb-3 p-2 bg-blue-900/20 border border-blue-700/30 rounded text-blue-300 text-sm",children:["ðŸ“‹ Filtering by ",es.selectedStatuses.length," selected status(es)"]}),Object.keys(gs()).length>0?Object.keys(gs()).map(e=>T.jsxs("div",{className:"mb-4",children:[T.jsxs("label",{className:"flex items-center cursor-pointer font-medium text-blue-300 mb-2",children:[T.jsx("input",{type:"checkbox",className:"accent-blue-500 mr-2",checked:es.selectedStatuses?.includes(e)||!1,onChange:t=>{const a=es.selectedStatuses||[],s=t.target.checked?[...a,e]:a.filter(t=>t!==e),n={...es,selectedStatuses:s};ts(n),setTimeout(()=>Za(),0)}}),T.jsx("span",{className:"text-blue-300",children:e})]}),gs()[e]&&gs()[e].length>0&&T.jsx("div",{className:"ml-6 space-y-1",children:gs()[e].map(t=>{const a="object"==typeof t?t.name:t;return a&&a!==e?T.jsxs("label",{className:"flex items-center cursor-pointer",children:[T.jsx("input",{type:"checkbox",className:"accent-blue-500 mr-2",checked:es.selectedStatuses?.includes(a)||!1,onChange:e=>{const t=es.selectedStatuses||[],s=e.target.checked?[...t,a]:t.filter(e=>e!==a),n={...es,selectedStatuses:s};ts(n),setTimeout(()=>Za(),0)}}),T.jsx("span",{className:"text-gray-300 text-sm",children:a})]},a):null})})]},e)):Pa?T.jsxs("div",{className:"text-gray-400 text-sm py-2 text-center",children:['No statuses found matching "',Pa,'"']}):T.jsxs("div",{className:"text-center py-4",children:[T.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-blue-500 mx-auto mb-2"}),T.jsx("span",{className:"text-gray-400 text-sm",children:"Loading status options..."})]})]})]}),"assignedTL"===Oa&&T.jsxs("div",{children:[T.jsx("h3",{className:"text-base font-medium text-gray-300 mb-4",children:"Assigned TL"}),T.jsx("div",{className:"mb-4",children:T.jsxs("div",{className:"relative",children:[T.jsx("input",{type:"text",placeholder:"Search TLs...",value:Ga,onChange:e=>za(e.target.value),className:"w-full bg-[#1b2230] border border-gray-600 rounded px-3 py-2 pl-10 text-gray-300 focus:outline-none focus:border-blue-500"}),T.jsx(h,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),Ga&&T.jsx("button",{onClick:()=>za(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-300",children:T.jsx(g,{className:"w-4 h-4"})})]})}),!Je&&us().length>0&&T.jsxs("div",{className:"mb-3 flex gap-2",children:[T.jsx("button",{onClick:()=>{const e=us();ts({...es,assignedTL:e})},className:"px-2 py-1 text-xs bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors",children:"Select All"}),T.jsx("button",{onClick:()=>{ts({...es,assignedTL:[]})},className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-700 text-white rounded transition-colors",children:"Clear All"})]}),T.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:Je?T.jsxs("div",{className:"text-gray-400 text-sm py-2 text-center",children:[T.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500 mx-auto mb-2"}),"Loading team leaders..."]}):T.jsxs(T.Fragment,{children:[us().map(e=>T.jsxs("label",{className:"flex items-center cursor-pointer",children:[T.jsx("input",{type:"checkbox",value:e,checked:Array.isArray(es.assignedTL)?es.assignedTL.includes(e):es.assignedTL===e,onChange:t=>{const a=Array.isArray(es.assignedTL)?es.assignedTL:es.assignedTL?[es.assignedTL]:[];t.target.checked?ts({...es,assignedTL:[...a,e]}):ts({...es,assignedTL:a.filter(t=>t!==e)})},className:"accent-blue-500 mr-2"}),T.jsx("span",{className:"text-gray-300",children:e})]},e)),Ga&&0===us().length&&T.jsxs("div",{className:"text-gray-400 text-sm py-2 text-center",children:['No TLs found matching "',Ga,'"']}),!Je&&0===Ye.length&&!Ga&&0===us().length&&T.jsx("div",{className:"text-gray-400 text-sm py-2 text-center",children:"No team leaders found"})]})})]}),"channelName"===Oa&&T.jsxs("div",{children:[T.jsx("h3",{className:"text-base font-medium text-gray-300 mb-4",children:"Channel Name"}),T.jsx("div",{className:"mb-4",children:T.jsxs("div",{className:"relative",children:[T.jsx("input",{type:"text",placeholder:"Search channels...",value:Ya,onChange:e=>qa(e.target.value),className:"w-full bg-[#1b2230] border border-gray-600 rounded px-3 py-2 pl-10 text-gray-300 focus:outline-none focus:border-blue-500"}),T.jsx(W,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"})]})}),T.jsxs("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[hs().map((e,t)=>T.jsxs("label",{className:"flex items-center cursor-pointer p-2 rounded hover:bg-[#2a3441] transition-colors",children:[T.jsx(M,{checked:es.channelName?.includes(e)||!1,onChange:t=>{const a=t.target.checked,s=es.channelName||[];ts(a?{...es,channelName:[...s,e]}:{...es,channelName:s.filter(t=>t!==e)})},className:"mr-3"}),T.jsx("span",{className:"text-gray-300 flex-1",children:e})]},t)),Ya&&0===hs().length&&T.jsxs("div",{className:"text-gray-400 text-sm py-2 text-center",children:['No channels found matching "',Ya,'"']})]})]}),"loginDepartment"===Oa&&T.jsxs("div",{children:[T.jsx("h3",{className:"text-base font-medium text-gray-300 mb-4",children:"Login Person/Department"}),T.jsx("div",{className:"mb-4",children:T.jsxs("div",{className:"relative",children:[T.jsx("input",{type:"text",placeholder:"Search login employees...",value:Ka,onChange:e=>Va(e.target.value),className:"w-full bg-[#1b2230] border border-gray-600 rounded px-3 py-2 pl-10 text-gray-300 focus:outline-none focus:border-blue-500"}),T.jsx(h,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),Ka&&T.jsx("button",{onClick:()=>Va(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-300",children:T.jsx(g,{className:"w-4 h-4"})})]})}),!et&&xs().length>0&&T.jsxs("div",{className:"mb-3 flex gap-2",children:[T.jsx("button",{onClick:()=>{const e=xs();ts({...es,loginDepartment:e})},className:"px-2 py-1 text-xs bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors",children:"Select All"}),T.jsx("button",{onClick:()=>{ts({...es,loginDepartment:[]})},className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-700 text-white rounded transition-colors",children:"Clear All"})]}),T.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:et?T.jsxs("div",{className:"text-gray-400 text-sm py-2 text-center",children:[T.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500 mx-auto mb-2"}),"Loading login employees..."]}):T.jsxs(T.Fragment,{children:[xs().map(e=>T.jsxs("label",{className:"flex items-center cursor-pointer",children:[T.jsx("input",{type:"checkbox",value:e,checked:Array.isArray(es.loginDepartment)?es.loginDepartment.includes(e):es.loginDepartment===e,onChange:t=>{const a=Array.isArray(es.loginDepartment)?es.loginDepartment:es.loginDepartment?[es.loginDepartment]:[];t.target.checked?ts({...es,loginDepartment:[...a,e]}):ts({...es,loginDepartment:a.filter(t=>t!==e)})},className:"accent-blue-500 mr-2"}),T.jsx("span",{className:"text-gray-300",children:e})]},e)),Ka&&0===xs().length&&T.jsxs("div",{className:"text-gray-400 text-sm py-2 text-center",children:['No employees found matching "',Ka,'"']}),!et&&0===Xe.length&&!Ka&&0===xs().length&&T.jsx("div",{className:"text-gray-400 text-sm py-2 text-center",children:"No login employees found"})]})})]}),"other"===Oa&&T.jsxs("div",{children:[T.jsx("h3",{className:"text-base font-medium text-gray-300 mb-4",children:"Campaign Name"}),T.jsxs("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[T.jsxs("label",{className:"flex items-center cursor-pointer",children:[T.jsx("input",{type:"radio",name:"campaignName",value:"",checked:!es.campaignName,onChange:e=>ts({...es,campaignName:""}),className:"accent-blue-500 mr-2"}),T.jsx("span",{className:"text-gray-300",children:"All Campaigns"})]}),[...new Set(me.map(e=>e.operations_channel_name).filter(Boolean))].sort().map(e=>T.jsxs("label",{className:"flex items-center cursor-pointer",children:[T.jsx("input",{type:"radio",name:"campaignName",value:e,checked:es.campaignName===e,onChange:e=>ts({...es,campaignName:e.target.value}),className:"accent-blue-500 mr-2"}),T.jsx("span",{className:"text-gray-300",children:e})]},e))]})]}),"income"===Oa&&T.jsxs("div",{children:[T.jsx("h3",{className:"text-base font-medium text-gray-300 mb-4",children:"Total Income Filter"}),T.jsxs("div",{className:"mb-6",children:[T.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-3",children:"Income Range"}),T.jsxs("div",{className:"flex gap-3",children:[T.jsxs("div",{className:"flex-1",children:[T.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"From"}),T.jsx("input",{type:"number",placeholder:"Min income",value:es.incomeRangeFrom,onChange:e=>ts({...es,incomeRangeFrom:e.target.value}),className:"w-full px-3 py-2 bg-[#2a3441] border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none"})]}),T.jsxs("div",{className:"flex-1",children:[T.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"To"}),T.jsx("input",{type:"number",placeholder:"Max income",value:es.incomeRangeTo,onChange:e=>ts({...es,incomeRangeTo:e.target.value}),className:"w-full px-3 py-2 bg-[#2a3441] border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none"})]})]})]}),T.jsxs("div",{children:[T.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-3",children:"Sort by Income"}),T.jsxs("div",{className:"space-y-2",children:[T.jsxs("label",{className:"flex items-center cursor-pointer",children:[T.jsx("input",{type:"radio",name:"incomeSortOrder",value:"",checked:!es.incomeSortOrder,onChange:e=>ts({...es,incomeSortOrder:""}),className:"accent-blue-500 mr-2"}),T.jsx("span",{className:"text-gray-300",children:"No sorting"})]}),T.jsxs("label",{className:"flex items-center cursor-pointer",children:[T.jsx("input",{type:"radio",name:"incomeSortOrder",value:"desc",checked:"desc"===es.incomeSortOrder,onChange:e=>ts({...es,incomeSortOrder:e.target.value}),className:"accent-blue-500 mr-2"}),T.jsx("span",{className:"text-gray-300",children:"Highest to Lowest"})]}),T.jsxs("label",{className:"flex items-center cursor-pointer",children:[T.jsx("input",{type:"radio",name:"incomeSortOrder",value:"asc",checked:"asc"===es.incomeSortOrder,onChange:e=>ts({...es,incomeSortOrder:e.target.value}),className:"accent-blue-500 mr-2"}),T.jsx("span",{className:"text-gray-300",children:"Lowest to Highest"})]})]})]})]})]})}),T.jsxs("div",{className:"flex justify-between gap-[250px] items-center mt-6 pt-4 border-t border-gray-600 flex-shrink-0",children:[T.jsx("button",{onClick:()=>{ts({leadStatus:"",dateFrom:"",dateTo:"",teamName:[],campaignName:[],createdBy:[],assignedTL:[],loginDepartment:[],channelName:[],loanTypeFilter:[],noActivityDate:"",selectedStatuses:[],checkDuplicateLeads:!1,disbursementDateFrom:"",disbursementDateTo:"",leadDateFrom:"",leadDateTo:"",fileSentToLoginDateFrom:"",fileSentToLoginDateTo:"",fileSentToLogin:!1,incomeRangeFrom:"",incomeRangeTo:"",incomeSortOrder:""}),Ja(),Za()},className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition whitespace-nowrap",children:"Clear all filter"}),T.jsxs("div",{className:"flex gap-2",children:[T.jsx("button",{onClick:()=>{Ea(!1),Ja()},className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition whitespace-nowrap",children:"Cancel"}),T.jsx("button",{onClick:()=>{Ea(!1),Ja(),Za()},className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition whitespace-nowrap",children:"Apply Filters"})]})]})]})]})}),xt&&T.jsx("div",{className:"fixed inset-0 bg-transparent bg-opacity-50 z-[9999] flex items-center justify-center",children:T.jsx("div",{className:"bg-white rounded-lg p-6 m-4 max-w-md w-full relative z-[9999]",children:T.jsxs("div",{className:"text-center",children:[T.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-yellow-100 mb-4",children:T.jsx("svg",{className:"h-6 w-6 text-yellow-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.268 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),T.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Unsaved Changes"}),T.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"You have unsaved changes in the obligation section. Do you want to save your changes before switching tabs?"}),T.jsxs("div",{className:"flex gap-3",children:[T.jsx("button",{onClick:()=>{ht(!1),pt(null)},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 font-medium",children:"Stay Here"}),T.jsx("button",{onClick:()=>{ht(!1),null!==gt&&(ze(gt),We(0),pt(null)),ut(!1)},className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-medium",children:"Continue Without Saving"})]})]})})}),Pe&&ke&&T.jsx(A.Suspense,{fallback:T.jsx("div",{className:"flex items-center justify-center min-h-screen bg-black",children:T.jsxs("div",{className:"text-center",children:[T.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-400 mx-auto mb-4"}),T.jsx("p",{className:"text-cyan-300 text-lg",children:"Loading lead details..."})]})}),children:T.jsx(Y,{lead:ke,user:s,onBack:()=>{Ue(!1),Le(null),Ns()},onLeadUpdate:e=>{ue(t=>t.map(t=>t._id===e._id?e:t)),Le(e)}})})]})]})})})]})]})});export{re as default};
