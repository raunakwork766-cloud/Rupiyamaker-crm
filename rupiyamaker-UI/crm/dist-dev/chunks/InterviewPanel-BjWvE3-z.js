import{j as e}from"./vendor-mui-C1GmDdcn.js";import{r as t,u as s,R as a}from"./vendor-react-EzoxUMNY.js";import{c as r}from"../assets/main-Dht40psf.js";import{i as n,f as i,A as l,b as o}from"./employee-components-D5mp2BtY.js";import{y as d}from"./task-components-CDyGxvgk.js";import{a7 as c,S as m,X as u,g as x,r as p,o as h,p as g}from"./lead-components-CR6vCRpQ.js";import{M as b,o as y,B as f,n as w,I as v,k as j,p as N,q as _,r as C,t as k,u as S,g as E,v as A,s as O}from"./vendor-antd-BB3a0mYC.js";import"./vendor-utils-QXd9EeNt.js";import"./vendor-office-CbbGW2MO.js";const I=({interviewId:s,isOpen:a,onClose:r,inline:i=!1})=>{const[l,o]=t.useState([]),[x,p]=t.useState(""),[h,g]=t.useState(!1),[b,y]=t.useState(!1),[f,w]=t.useState("");t.useEffect(()=>{s&&a&&v()},[s,a]),t.useEffect(()=>{window.customEvents||(window.customEvents=new EventTarget);const e=()=>{s&&a&&v()},t=()=>{s&&a&&v()};return window.customEvents.addEventListener("interviewStatusChanged",e),window.customEvents.addEventListener("interviewUpdated",t),()=>{window.customEvents&&(window.customEvents.removeEventListener("interviewStatusChanged",e),window.customEvents.removeEventListener("interviewUpdated",t))}},[s,a]);const v=async()=>{try{g(!0),w("");const e=await n.getComments(s),t=Array.isArray(e)?e:e.comments?e.comments:e.data?e.data:[];o(t)}catch(e){w("Failed to load comments: "+e.message),o([])}finally{g(!1)}},j=async()=>{if(x.trim()){y(!0);try{w("");const t=await n.addComment(s,x.trim()),a=t.data||t,r={id:a.id||a._id||Date.now().toString(),_id:a.id||a._id||Date.now().toString(),content:x.trim(),comment:x.trim(),created_by:a.created_by||"Current User",created_by_name:a.created_by_name||"Current User",created_at:a.created_at||(new Date).toISOString(),updated_at:a.updated_at||(new Date).toISOString(),...a};o(e=>[r,...e]),p(""),((e,t={})=>{window.customEvents||(window.customEvents=new EventTarget),window.customEvents.dispatchEvent(new CustomEvent(e,{detail:{interviewId:s,...t}}))})("commentAdded",{comment:r});try{await n.addHistoryEntry(s,{action_type:"comment_added",action:"Comment Added",description:`Added a new comment: "${x.trim().substring(0,50)}${x.trim().length>50?"...":""}"`,details:{comment_id:r.id,comment_preview:x.trim().substring(0,100),comment_length:x.trim().length}})}catch(e){}d.success("Comment added successfully")}catch(t){w("Failed to add comment: "+t.message),d.error(t.message||"Failed to add comment")}finally{y(!1)}}else d.error("Please enter a comment")},N=e=>{if(!e)return"Unknown time";try{return new Date(e).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}catch(t){return"Invalid date"}};return a?i?e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(c,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Interview Comments"}),e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-sm font-medium",children:[l.length," comment",1!==l.length?"s":""]})]})}),f&&e.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-300 rounded-lg",children:e.jsx("p",{className:"text-red-700",children:f})}),e.jsx("div",{className:"border-b pb-4 mb-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newComment",className:"block text-sm font-medium text-gray-700 mb-1",children:"Add a comment"}),e.jsx("textarea",{id:"newComment",value:x,onChange:e=>p(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),!b&&x.trim()&&x.length<=1e3&&j())},className:"w-full p-2 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm text-black",rows:2,placeholder:"Write your comment here...",disabled:b})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:[x.length,"/1000 characters"]}),e.jsxs("button",{type:"button",onClick:j,disabled:b||!x.trim()||x.length>1e3,className:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",children:[b?e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white"}):e.jsx(m,{className:"w-3 h-3"}),"Add Comment"]})]})]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto mb-4 space-y-4",children:h?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Loading comments..."})]}):0===l.length?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(c,{className:"w-8 h-8 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No comments yet"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Be the first to add a comment!"})]}):l.map(t=>e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[e.jsx("span",{className:"font-bold",children:t.created_by_name||"Unknown User"}),e.jsx("span",{children:N(t.created_at)})]}),e.jsx("div",{className:"text-gray-800",children:t.content}),t.updated_at&&t.updated_at!==t.created_at&&e.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Edited: ",N(t.updated_at)]})]},t.id))})]}):e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl mx-4 max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("div",{className:"flex items-center gap-3"}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(u,{className:"w-6 h-6"})})]}),f&&e.jsx("div",{className:"mx-6 mt-4 p-4 bg-red-100 border border-red-300 rounded-lg",children:e.jsx("p",{className:"text-red-700",children:f})}),e.jsx("div",{className:"border-b mx-6 pb-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newCommentModal",className:"block text-sm font-medium text-gray-700 mb-2",children:"Add a comment"}),e.jsx("textarea",{id:"newCommentModal",value:x,onChange:e=>p(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),!b&&x.trim()&&x.length<=1e3&&j())},className:"w-full p-3 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-black",placeholder:"Write your comment here...",disabled:b})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:[x.length,"/1000 characters"]}),e.jsxs("button",{type:"button",onClick:j,disabled:b||!x.trim()||x.length>1e3,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[b?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):e.jsx(m,{className:"w-4 h-4"}),b?"Adding...":"Add Comment"]})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:h?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Loading comments..."})]}):0===l.length?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(c,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 text-lg",children:"No comments yet"}),e.jsx("p",{className:"text-gray-400",children:"Be the first to add a comment!"})]}):l.map(t=>e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[e.jsx("span",{className:"font-bold",children:t.created_by_name||"Unknown User"}),e.jsx("span",{children:N(t.created_at)})]}),e.jsx("div",{className:"text-gray-800",children:t.content}),t.updated_at&&t.updated_at!==t.created_at&&e.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Edited: ",N(t.updated_at)]})]},t.id))}),e.jsx("div",{className:"border-t p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newComment",className:"block text-sm font-medium text-gray-700 mb-2",children:"Add a comment"}),e.jsx("textarea",{id:"newComment",value:x,onChange:e=>p(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),!b&&x.trim()&&x.length<=1e3&&j())},className:"w-full p-3 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-black",rows:3,placeholder:"Write your comment here...",disabled:b})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:[x.length,"/1000 characters"]}),e.jsxs("button",{type:"button",onClick:j,disabled:b||!x.trim()||x.length>1e3,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[b?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):e.jsx(m,{className:"w-4 h-4"}),b?"Adding...":"Add Comment"]})]})]})})]})}):null},T=({interviewId:s,isOpen:a,onClose:r,inline:i=!1})=>{const[l,o]=t.useState([]),[d,c]=t.useState(!1),[m,u]=t.useState("");t.useEffect(()=>{s&&a&&x()},[s,a]);const x=async()=>{if(s&&!d){c(!0);try{const e=await n.getHistory(s),t=(e.data||e.history||e||[]).map((e,t)=>{const s=new Date(e.created_at),a=s.toLocaleDateString(),r=s.toLocaleTimeString();return{id:e.id||e._id||t,date:a,time:r,createdBy:e.created_by_name||"Unknown User",actionType:e.action_type||"activity",changes:e.action||e.description||"Activity performed",rawData:e}});o(t),u("")}catch(e){u("Failed to load history: "+e.message),o([])}finally{c(!1)}}};return a?i?e.jsxs("div",{className:"mt-4 max-h-[350px] overflow-y-auto",children:[d?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500 mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Loading history..."})]}):l&&l.length>0?e.jsx("div",{className:"overflow-hidden border border-gray-200 rounded-lg shadow",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-blue-500 uppercase tracking-wider",children:"#"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-blue-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-blue-500 uppercase tracking-wider",children:"Time"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-blue-500 uppercase tracking-wider",children:"Created By"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-blue-500 uppercase tracking-wider",children:"Activity & Details"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map((t,s)=>e.jsxs("tr",{className:s%2==0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:s+1}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.date}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.time}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.createdBy}),e.jsxs("td",{className:"px-6 py-4 text-sm text-gray-800 break-words",children:[e.jsxs("div",{className:"flex items-center gap-2",children:["created"===t.actionType&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"ðŸ“ CREATED"}),"status_changed"===t.actionType&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"ðŸ”„ STATUS"}),"comment_added"===t.actionType&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"ðŸ’¬ COMMENT"}),"field_changed"===t.actionType&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:"âœï¸ FIELD CHANGED"}),"updated"===t.actionType&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:"âœï¸ UPDATED"}),"scheduled"===t.actionType&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-cyan-100 text-cyan-800",children:"ðŸ“… SCHEDULED"}),"rescheduled"===t.actionType&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:"ðŸ”„ RESCHEDULED"}),!["created","status_changed","comment_added","field_changed","updated","scheduled","rescheduled"].includes(t.actionType)&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"â“ ACTIVITY"})]}),e.jsx("div",{className:"mt-1 text-sm uppercase font-medium",children:t.changes})]})]},t.id))})]})}):e.jsx("div",{className:"text-center text-gray-500 py-4",children:"No history available for this interview."}),m&&e.jsx("div",{className:"mt-4 p-4 bg-red-100 border border-red-300 rounded-lg",children:e.jsx("p",{className:"text-red-700",children:m})})]}):e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-6xl mx-4 max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Interview History"}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:"âœ•"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[d?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500 mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Loading history..."})]}):l&&l.length>0?e.jsx("div",{className:"overflow-hidden border border-gray-200 rounded-lg shadow",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-blue-500 uppercase tracking-wider",children:"#"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-blue-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-blue-500 uppercase tracking-wider",children:"Time"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-blue-500 uppercase tracking-wider",children:"Created By"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-blue-500 uppercase tracking-wider",children:"Activity & Details"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map((t,s)=>e.jsxs("tr",{className:s%2==0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:s+1}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.date}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.time}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.createdBy}),e.jsxs("td",{className:"px-6 py-4 text-sm text-gray-800 break-words",children:[e.jsxs("div",{className:"flex items-center gap-2",children:["created"===t.actionType&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"ðŸ“ CREATED"}),"status_changed"===t.actionType&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"ðŸ”„ STATUS"}),"comment_added"===t.actionType&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"ðŸ’¬ COMMENT"}),"field_changed"===t.actionType&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:"âœï¸ FIELD CHANGED"}),"updated"===t.actionType&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:"âœï¸ UPDATED"}),"scheduled"===t.actionType&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-cyan-100 text-cyan-800",children:"ðŸ“… SCHEDULED"}),"rescheduled"===t.actionType&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:"ðŸ”„ RESCHEDULED"}),!["created","status_changed","comment_added","field_changed","updated","scheduled","rescheduled"].includes(t.actionType)&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"â“ ACTIVITY"})]}),e.jsx("div",{className:"mt-1 text-sm uppercase font-medium",children:t.changes})]})]},t.id))})]})}):e.jsxs("div",{className:"text-center text-gray-500 py-8",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No history available"}),e.jsx("p",{children:"This interview has no recorded activities yet."})]}),m&&e.jsx("div",{className:"mt-4 p-4 bg-red-100 border border-red-300 rounded-lg",children:e.jsx("p",{className:"text-red-700",children:m})})]})]})}):null};function M(e){if(!e)return"";const t=e.toString().replace(/[^\d]/g,"");return t?`â‚¹${t.replace(/\B(?=(\d{3})+(?!\d))/g,",")}`:""}function L(e,t,s){var a;t(s,(a=e)?a.replace(/[â‚¹,]/g,""):"")}const D=({value:s,onChange:a,onClose:r,isOpen:n,className:i=""})=>{const[l,o]=t.useState(8),[d,c]=t.useState(0),[m,u]=t.useState("AM"),[x,p]=t.useState("hours"),[h,g]=t.useState(!1),b=t.useRef(null);t.useEffect(()=>{if(s){const[e,t]=s.split(":"),a=parseInt(e),r=parseInt(t);c(r),0===a?(o(12),u("AM")):12===a?(o(12),u("PM")):a>12?(o(a-12),u("PM")):(o(a),u("AM"))}},[s]),t.useEffect(()=>{const e=e=>{b.current&&!b.current.contains(e.target)&&r()},t=e=>{h&&f(e)},s=()=>{g(!1)};return n&&(document.addEventListener("mousedown",e),document.addEventListener("mousemove",t),document.addEventListener("mouseup",s)),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",s)}},[n,r,h]);const y=()=>"hours"===x?l%12*30:6*d,f=e=>{const t=document.querySelector(".clock-face");if(!t)return;const s=t.getBoundingClientRect(),a=s.left+s.width/2,r=s.top+s.height/2,n=e.clientX-a,i=e.clientY-r;let l=Math.atan2(n,-i)*(180/Math.PI);l<0&&(l+=360),w(l)},w=e=>{if("hours"===x){let t=Math.round(e/30);0===t&&(t=12),o(t)}else{let t=Math.round(e/6);60===t&&(t=0),c(t)}},v=e=>{e.preventDefault(),e.stopPropagation(),g(!0)};return n?e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",onClick:e=>{e.preventDefault(),e.stopPropagation(),r()},children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl overflow-hidden",ref:b,onClick:e=>{e.preventDefault(),e.stopPropagation()},style:{width:"400px"},children:[e.jsxs("div",{className:"bg-cyan-500 text-white p-6 relative",children:[e.jsx("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),r()},className:"absolute top-4 right-4 text-white hover:text-gray-200 text-2xl font-light leading-none",children:"Ã—"}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-6xl font-light mb-4 tracking-wider",children:[e.jsx("span",{className:"cursor-pointer transition-all "+("hours"===x?"border-b-2 border-white pb-1":"opacity-70"),onClick:()=>p("hours"),children:l.toString().padStart(2,"0")}),e.jsx("span",{className:"mx-3 opacity-70",children:":"}),e.jsx("span",{className:"cursor-pointer transition-all "+("minutes"===x?"border-b-2 border-white pb-1":"opacity-70"),onClick:()=>p("minutes"),children:d.toString().padStart(2,"0")})]}),e.jsxs("div",{className:"flex justify-center space-x-1",children:[e.jsx("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),u("AM")},className:"px-6 py-2 rounded-full text-sm font-medium transition-all "+("AM"===m?"bg-white text-cyan-500 shadow-md":"bg-transparent text-white border border-white hover:bg-white hover:text-cyan-500"),children:"AM"}),e.jsx("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),u("PM")},className:"px-6 py-2 rounded-full text-sm font-medium transition-all "+("PM"===m?"bg-white text-cyan-500 shadow-md":"bg-transparent text-white border border-white hover:bg-white hover:text-cyan-500"),children:"PM"})]})]})]}),e.jsx("div",{className:"p-8 bg-white",children:e.jsxs("div",{className:"relative w-80 h-80 mx-auto bg-gray-100 rounded-full cursor-pointer shadow-inner clock-face",onClick:e=>{const t=e.currentTarget.getBoundingClientRect(),s=t.left+t.width/2,a=t.top+t.height/2,r=e.clientX-s,n=e.clientY-a;let i=Math.atan2(r,-n)*(180/Math.PI);i<0&&(i+=360),w(i)},children:[[...Array(12)].map((t,s)=>{const a="hours"===x?0===s?12:s:5*s,r="hours"===x?a:0===a?"00":a,n=30*s,i=140*Math.sin(n*Math.PI/180),m=140*-Math.cos(n*Math.PI/180),u="hours"===x?a===l:a===d;return e.jsx("div",{className:"absolute w-10 h-10 flex items-center justify-center text-lg font-medium cursor-pointer rounded-full transition-all "+(u?"bg-cyan-500 text-white shadow-lg scale-110":"text-gray-700 hover:bg-gray-200"),style:{left:`calc(50% + ${i}px - 20px)`,top:`calc(50% + ${m}px - 20px)`},onClick:e=>{e.stopPropagation(),(e=>{"hours"===x?o(e):c(e)})(a)},children:r},s)}),e.jsx("div",{className:"absolute w-4 h-4 bg-cyan-500 rounded-full z-20",style:{left:"calc(50% - 8px)",top:"calc(50% - 8px)"}}),e.jsx("div",{className:"absolute bg-cyan-500 origin-bottom z-10 rounded-full "+(h?"cursor-grabbing":"cursor-grab"),style:{width:"3px",height:"hours"===x?"100px":"120px",left:"calc(50% - 1.5px)",top:"hours"===x?"calc(50% - 100px)":"calc(50% - 120px)",transform:`rotate(${y()}deg)`,transformOrigin:"bottom center",transition:h?"none":"transform 0.3s ease-in-out"},onMouseDown:v}),(()=>{const{x:t,y:s}=(()=>{const e=y(),t="hours"===x?100:120;return{x:Math.sin(e*Math.PI/180)*t,y:-Math.cos(e*Math.PI/180)*t}})();return e.jsx("div",{className:"absolute w-4 h-4 bg-cyan-500 rounded-full shadow-lg z-30 transition-all "+(h?"cursor-grabbing scale-110":"cursor-grab hover:scale-105"),style:{left:`calc(50% + ${t}px - 8px)`,top:`calc(50% + ${s}px - 8px)`,transition:h?"none":"all 0.3s ease-in-out"},onMouseDown:v})})()]})}),e.jsxs("div",{className:"p-4 flex justify-end space-x-4 bg-gray-50 border-t",children:[e.jsx("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),r()},className:"px-6 py-2 text-cyan-500 hover:bg-cyan-50 rounded font-medium transition-colors text-sm uppercase tracking-wide",children:"CANCEL"}),e.jsx("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),(()=>{let e=l;"AM"===m&&12===l?e=0:"PM"===m&&12!==l&&(e=l+12);const t=`${e.toString().padStart(2,"0")}:${d.toString().padStart(2,"0")}`;a(t),r()})()},className:"px-8 py-2 bg-cyan-500 text-white rounded hover:bg-cyan-600 font-medium transition-colors text-sm uppercase tracking-wide shadow-md",children:"OK"})]})]})}):null};function R({interview:s,onSave:a,onClose:r,jobOpeningOptions:n=[],interviewTypeOptions:l=[],sourcePortalOptions:o=[]}){const c=e=>{if(!e||"object"!=typeof e)throw new Error("Invalid interview data provided to EditInterview component");let t=e._id||e.id;return t||(t=null),{id:t,_id:t,isReadOnly:!t,createdBy:e.created_by||"Unknown",candidate_name:e.candidate_name||"",mobile_number:e.mobile_number||"",alternate_number:e.alternate_number||"",gender:e.gender||"Male",job_opening:e.job_opening||"",interview_type:e.interview_type||"In-Person",source_portal:e.source_portal||"",city:e.city||"",state:e.state||"",experience_type:e.experience_type||"fresher",total_experience:e.total_experience||"",old_salary:e.old_salary||"",offer_salary:e.offer_salary||"",interview_date:e.interview_date?new Date(e.interview_date).toISOString().split("T")[0]:"",interview_time:e.interview_time||"",status:e.status||"new_interview",created_by:e.created_by||"",user_id:e.user_id||""}},[m,u]=t.useState(c(s)),[x,p]=t.useState(!0),[h,g]=t.useState(i(new Date)),[b,y]=t.useState(!1),[f,w]=t.useState(null),[v,j]=t.useState(!1),[N,_]=t.useState(!1),[C,k]=t.useState(""),[S,E]=t.useState("");t.useEffect(()=>{s&&u(c(s))},[s]);const[A,O]=t.useState(!0),[R,F]=t.useState(!1),[B,P]=t.useState(!1),[U,H]=t.useState(!1),[q,$]=t.useState(0),[z,W]=t.useState(0),[G,Y]=t.useState(!1),[V,J]=t.useState(!1);t.useEffect(()=>{const e=()=>{W(e=>e+1)},t=()=>{W(e=>e+1)};return window.customEvents||(window.customEvents=new EventTarget),window.customEvents.addEventListener("commentAdded",e),window.customEvents.addEventListener("interviewUpdated",t),()=>{window.customEvents.removeEventListener("commentAdded",e),window.customEvents.removeEventListener("interviewUpdated",t)}},[]);const K=(e,t)=>{const s=m[e];u(s=>({...s,[e]:t})),"status"===e&&s!==t&&(window.customEvents||(window.customEvents=new EventTarget),window.customEvents.dispatchEvent(new CustomEvent("interviewStatusChanged",{detail:{interviewId:m.id,oldStatus:s,newStatus:t}})))},Q=()=>{p(!1),r()};return x?e.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-transparent",style:{backdropFilter:"blur(3px)"},children:e.jsxs("div",{className:"relative bg-white p-6 rounded-xl shadow-2xl w-full max-w-5xl mx-auto space-y-6 max-h-[90vh] overflow-y-auto",children:[e.jsx("button",{className:"absolute right-2 top-2 text-gray-500 hover:text-red-500 transition text-2xl font-bold",onClick:Q,"aria-label":"Close",type:"button",children:"Ã—"}),e.jsx("h2",{className:"text-xl font-bold text-blue-500 mb-4",children:"EDIT INTERVIEW"}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),y(!0),w(null);try{if(!m.candidate_name||!m.mobile_number||!m.interview_date)throw new Error("Please fill in all required fields");let e=m.status;(s.interview_date?new Date(s.interview_date).toISOString().split("T")[0]:"")!==m.interview_date&&(e="rescheduled");const t={candidate_name:m.candidate_name,mobile_number:m.mobile_number,alternate_number:m.alternate_number||null,gender:m.gender,job_opening:m.job_opening,interview_type:m.interview_type,source_portal:m.source_portal,city:m.city,state:m.state,experience_type:m.experience_type,total_experience:m.total_experience,old_salary:m.old_salary?parseFloat(m.old_salary):null,offer_salary:m.offer_salary?parseFloat(m.offer_salary):null,interview_date:new Date(m.interview_date+"T"+(m.interview_time||"00:00")).toISOString(),interview_time:m.interview_time,status:e};if(!m.id)throw new Error("Cannot update interview: No valid database ID available. This interview can only be viewed. Please contact support to update this record.");if(m.isReadOnly)throw new Error("Cannot update interview: This interview is in read-only mode due to missing database ID. Please refresh the page and try again.");await a(m.id,t),u(t=>({...t,...m,status:e})),window.customEvents||(window.customEvents=new EventTarget),window.customEvents.dispatchEvent(new CustomEvent("interviewUpdated",{detail:{interviewId:m.id,type:"update",data:t}})),d.success("Interview updated successfully! The table has been updated with the new information."),p(!1),r()}catch(t){w(t.message||"Failed to update interview"),d.error(t.message||"Failed to update interview")}finally{y(!1)}},className:"p-8",children:[f&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",children:f}),m.isReadOnly&&e.jsxs("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded mb-6",children:[e.jsx("strong",{children:"Read-Only Mode:"})," This interview cannot be updated due to missing database ID. You can view the details but cannot make changes."]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",children:"Date & Time"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold bg-gray-100",value:h,readOnly:!0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",htmlFor:"createdBy",children:"Created By"}),e.jsx("input",{id:"createdBy",type:"text",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold bg-gray-100",value:m.createdBy,readOnly:!0})]})]}),f&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",children:f}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",htmlFor:"candidate_name",children:"Candidate Name"}),e.jsx("input",{id:"candidate_name",type:"text",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold",value:m.candidate_name,onChange:e=>K("candidate_name",e.target.value),placeholder:"Enter candidate name",required:!0})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mt-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",htmlFor:"mobile_number",children:"Mobile Number"}),e.jsx("input",{id:"mobile_number",type:"tel",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold",value:m.mobile_number,onChange:e=>K("mobile_number",e.target.value),placeholder:"Enter mobile number",required:!0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",htmlFor:"alternate_number",children:"Alternate Number"}),e.jsx("input",{id:"alternate_number",type:"tel",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold",value:m.alternate_number,onChange:e=>K("alternate_number",e.target.value),placeholder:"Enter alternate number"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mt-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",htmlFor:"gender",children:"Gender"}),e.jsxs("select",{id:"gender",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold",value:m.gender,onChange:e=>K("gender",e.target.value),children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",htmlFor:"job_opening",children:"Job Opening"}),e.jsxs("select",{id:"job_opening",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold",value:m.job_opening,onChange:e=>K("job_opening",e.target.value),children:[e.jsx("option",{value:"",children:"Select Job Opening"}),n.map((t,s)=>e.jsx("option",{value:t,children:t},s))]})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mt-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",htmlFor:"interview_type",children:"Interview Type"}),e.jsxs("select",{id:"interview_type",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold",value:m.interview_type,onChange:e=>K("interview_type",e.target.value),children:[e.jsx("option",{value:"",children:"Select Type"}),l.map((t,s)=>e.jsx("option",{value:t,children:t},s))]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",htmlFor:"source_portal",children:"Source Portal"}),e.jsxs("select",{id:"source_portal",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold",value:m.source_portal,onChange:e=>K("source_portal",e.target.value),children:[e.jsx("option",{value:"",children:"Select Source Portal"}),o.map((t,s)=>e.jsx("option",{value:t,children:t},s))]})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mt-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",htmlFor:"city",children:"City"}),e.jsx("input",{id:"city",type:"text",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold",value:m.city,onChange:e=>K("city",e.target.value),placeholder:"Enter city"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",htmlFor:"state",children:"State"}),e.jsx("input",{id:"state",type:"text",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold",value:m.state,onChange:e=>K("state",e.target.value),placeholder:"Enter state"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mt-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",htmlFor:"experience_type",children:"Experience Type"}),e.jsxs("select",{id:"experience_type",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold",value:m.experience_type,onChange:e=>K("experience_type",e.target.value),children:[e.jsx("option",{value:"",children:"Select Experience"}),e.jsx("option",{value:"fresher",children:"Fresher"}),e.jsx("option",{value:"experienced",children:"Experienced"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",htmlFor:"total_experience",children:"Total Experience"}),e.jsx("input",{id:"total_experience",type:"text",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold",value:m.total_experience,onChange:e=>K("total_experience",e.target.value),placeholder:"e.g., 2 years"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mt-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",htmlFor:"old_salary",children:"Current Salary"}),e.jsx("input",{id:"old_salary",type:"text",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold",value:M(m.old_salary),onChange:e=>L(e.target.value,K,"old_salary"),placeholder:"Enter current salary"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",htmlFor:"offer_salary",children:"Offered Salary"}),e.jsx("input",{id:"offer_salary",type:"text",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold",value:M(m.offer_salary),onChange:e=>L(e.target.value,K,"offer_salary"),placeholder:"Enter offered salary"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mt-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",htmlFor:"interview_date",children:"Interview Date"}),e.jsx("input",{id:"interview_date",type:"date",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold",value:m.interview_date,onChange:e=>K("interview_date",e.target.value)})]}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",htmlFor:"interview_time",children:"Interview Time"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"interview_time",type:"text",readOnly:!0,className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold focus:border-cyan-500 focus:ring-2 focus:ring-cyan-200 cursor-pointer",value:m.interview_time?(()=>{const[e,t]=m.interview_time.split(":"),s=parseInt(e),a=s>=12?"PM":"AM";return`${0===s?12:s>12?s-12:s}:${parseInt(t).toString().padStart(2,"0")} ${a}`})():"Click to select time",onClick:()=>Y(!0),placeholder:"Click to select time"}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:"ðŸ•"}),e.jsx(D,{value:m.interview_time,onChange:e=>{K("interview_time",e),Y(!1)},onClose:()=>{Y(!1)},isOpen:G})]}),e.jsx("small",{className:"text-gray-500 text-xs mt-1 block",children:"Click to open time picker"})]})]}),e.jsxs("div",{className:"mt-6 p-4 border-2 border-orange-300 rounded-lg bg-orange-50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("input",{type:"checkbox",id:"reschedule_checkbox",checked:N,onChange:e=>{return t=e.target.checked,_(t),void(t?(k(m.interview_date||""),E(m.interview_time||"")):(k(""),E("")));var t},className:"w-4 h-4 text-orange-600 bg-white border-orange-300 rounded focus:ring-orange-500"}),e.jsx("label",{htmlFor:"reschedule_checkbox",className:"text-lg font-bold text-orange-700",children:"Reschedule Interview"})]}),N&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-3 p-2 bg-orange-100 rounded border border-orange-200",children:e.jsxs("p",{className:"text-sm text-orange-800",children:[e.jsx("strong",{children:"Note:"}),' Rescheduling will update the interview date and time, and reset the status to "New Interview".']})}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",htmlFor:"reschedule_date",children:"New Interview Date *"}),e.jsx("input",{id:"reschedule_date",type:"date",className:"w-full px-3 py-2 border border-orange-400 rounded text-black font-bold",value:C,onChange:e=>k(e.target.value),min:(new Date).toISOString().split("T")[0],required:!0})]}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",htmlFor:"reschedule_time",children:"New Interview Time *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"reschedule_time",type:"text",readOnly:!0,className:"w-full px-3 py-2 border border-orange-400 rounded text-black font-bold focus:border-orange-500 focus:ring-2 focus:ring-orange-200 cursor-pointer",value:S?(()=>{const[e,t]=S.split(":"),s=parseInt(e),a=s>=12?"PM":"AM";return`${0===s?12:s>12?s-12:s}:${parseInt(t).toString().padStart(2,"0")} ${a}`})():"Click to select time",onClick:()=>J(!0),placeholder:"Click to select time",required:!0}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:"ðŸ•"}),e.jsx(D,{value:S,onChange:e=>{E(e),J(!1)},onClose:()=>{J(!1)},isOpen:V})]}),e.jsx("small",{className:"text-gray-500 text-xs mt-1 block",children:"Click to open time picker"})]})]})]})]}),e.jsx("div",{className:"flex gap-4 mt-6",children:N?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:async()=>{if(C&&S){y(!0),w(null);try{const e={interview_date:new Date(C+"T"+S).toISOString(),interview_time:S,status:"rescheduled"};if(!m.id)throw new Error("Cannot reschedule interview: No valid database ID available.");await a(m.id,e),u(e=>({...e,interview_date:C,interview_time:S,status:"rescheduled"})),k(""),E(""),_(!1),window.customEvents||(window.customEvents=new EventTarget),window.customEvents.dispatchEvent(new CustomEvent("interviewUpdated",{detail:{interviewId:m.id,type:"reschedule",data:e}})),d.success(`Interview rescheduled successfully to ${new Date(C+"T"+S).toLocaleDateString()} at ${S}! The table has been updated.`)}catch(e){w(e.message||"Failed to reschedule interview"),d.error(e.message||"Failed to reschedule interview")}finally{y(!1)}}else w("Please select both date and time for rescheduling")},className:"flex-1 px-6 py-3 font-bold rounded-lg shadow transition text-lg "+(m.isReadOnly?"bg-gray-400 text-gray-600 cursor-not-allowed":"bg-orange-600 text-white hover:bg-orange-700"),disabled:b||m.isReadOnly,children:m.isReadOnly?"Read-Only Mode":b?"Rescheduling...":"Reschedule Interview"}),e.jsx("button",{type:"button",onClick:()=>_(!1),className:"flex-1 px-6 py-3 bg-gray-600 text-white font-bold rounded-lg shadow hover:bg-gray-700 transition text-lg",children:"Cancel Reschedule"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"submit",className:"flex-1 px-6 py-3 font-bold rounded-lg shadow transition text-lg "+(m.isReadOnly?"bg-gray-400 text-gray-600 cursor-not-allowed":"bg-cyan-600 text-white hover:bg-cyan-700"),disabled:b||m.isReadOnly,children:m.isReadOnly?"Read-Only Mode":b?"Updating...":"Update Interview"}),e.jsx("button",{type:"button",onClick:Q,className:"flex-1 px-6 py-3 bg-gray-600 text-white font-bold rounded-lg shadow hover:bg-gray-700 transition text-lg",children:m.isReadOnly?"Close":"Cancel"})]})})]}),m.id&&!m.isReadOnly&&e.jsxs("div",{className:"mt-6 bg-white p-4 rounded-lg shadow-sm border",children:[e.jsxs("div",{className:"flex space-x-2 mb-4",children:[e.jsx("button",{type:"button",className:"px-4 py-2 font-semibold rounded-lg shadow "+(A?"bg-green-500 text-white hover:bg-green-600":"bg-white text-gray-700 hover:bg-gray-100"),onClick:()=>{O(!A),F(!1)},children:"âž• Comments"}),e.jsx("button",{type:"button",className:"px-4 py-2 font-semibold rounded-lg shadow "+(R?"bg-green-500 text-white hover:bg-green-600":"bg-white text-gray-700 hover:bg-gray-100"),onClick:()=>{F(!R),O(!1)},children:"ðŸ“‹ History"})]}),A&&e.jsx("div",{className:"mt-4",children:B?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500 mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Loading comments..."})]}):e.jsx(I,{interviewId:m.id,isOpen:!0,onClose:()=>O(!1),inline:!0},q)}),R&&e.jsx("div",{className:"mt-4",children:U?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500 mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Loading history..."})]}):e.jsx(T,{interviewId:m.id,isOpen:!0,onClose:()=>F(!1),inline:!0},z)})]})]})}):null}const{TextArea:F}=v,B=({visible:s,onClose:a,duplicateInterviews:r,phoneNumber:n,onProceed:i,onCloseCreateModal:o})=>{const[d,c]=t.useState(!1),[m,u]=t.useState(null),[x,p]=t.useState(""),[h,g]=t.useState(!1),v=e=>({new_interview:"#108ee9",scheduled:"#87d068",completed:"#2db7f5",selected:"#52c41a",rejected:"#f50",no_show:"#fa8c16",rescheduled:"#722ed1",on_hold:"#faad14",cancelled:"#ff4d4f"}[e]||"#d9d9d9"),I=e=>{if(!e)return"Not set";try{return new Date(e).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid date"}},T=[{title:"#",dataIndex:"index",key:"index",width:50,render:(e,t,s)=>s+1},{title:"Candidate Details",key:"candidate",render:(t,s)=>e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:4},children:[e.jsx(j,{style:{marginRight:8,color:"#1890ff"}}),s.candidate_name]}),e.jsxs("div",{style:{color:"#666",fontSize:"12px"},children:[e.jsx(N,{style:{marginRight:6}}),e.jsxs("span",{style:{fontWeight:s.mobile_number===n?"bold":"normal"},children:["Mobile: ",s.mobile_number]}),s.alternate_number&&e.jsxs("span",{style:{marginLeft:8,fontWeight:s.alternate_number===n?"bold":"normal"},children:["Alt: ",s.alternate_number]})]})]})},{title:"Location & Job",key:"location",render:(t,s)=>e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:4},children:[e.jsx(_,{style:{marginRight:6,color:"#52c41a"}}),s.city,", ",s.state]}),e.jsxs("div",{style:{color:"#666",fontSize:"12px"},children:[e.jsx(C,{style:{marginRight:6}}),s.job_opening]})]})},{title:"Status",dataIndex:"status",key:"status",render:t=>e.jsx(k,{color:v(t),text:t?.replace(/_/g," ").toUpperCase()||"Unknown"})},{title:"Interview Date",key:"interview_date",render:(t,s)=>e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx(S,{style:{marginRight:6,color:"#fa8c16"}}),I(s.interview_date)]})},{title:"Actions",key:"actions",render:(t,s)=>e.jsx(E,{direction:"vertical",size:"small",children:e.jsx(A,{title:"Request reassignment to another user",children:e.jsx(f,{size:"small",type:"primary",ghost:!0,onClick:()=>(async e=>{u(e),p(""),c(!0)})(s),children:"Request Reassignment"})})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(b,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(w,{style:{color:"#fa8c16",marginRight:8,fontSize:"20px"}}),e.jsx("span",{children:"Duplicate Phone Number Detected"})]}),visible:s,onCancel:a,width:1e3,footer:[e.jsx(f,{onClick:a,children:"Cancel Creation"},"cancel"),e.jsx(f,{type:"primary",danger:!0,onClick:i,children:"Proceed Anyway"},"proceed")],children:[e.jsx("div",{style:{marginBottom:16},children:e.jsxs("p",{style:{fontSize:"14px",color:"#666"},children:["The phone number ",e.jsx("strong",{children:n})," already exists in the following interview(s):"]})}),e.jsx(y,{columns:T,dataSource:r?.map((e,t)=>({...e,key:e.id||t})),pagination:!1,size:"middle",scroll:{x:800},style:{marginBottom:16}}),e.jsx("div",{style:{background:"#fff7e6",border:"1px solid #ffd591",borderRadius:"6px",padding:"12px",marginTop:16},children:e.jsxs("p",{style:{margin:0,fontSize:"13px",color:"#d46b08"},children:[e.jsx("strong",{children:"Note:"})," You can proceed with creating a new interview or request reassignment of existing interviews. Reassignment requests require super admin approval."]})})]}),e.jsxs(b,{title:"Request Interview Reassignment",visible:d,onCancel:()=>{c(!1),p(""),u(null)},onOk:async()=>{const e=(()=>{const e=(()=>{const e=localStorage.getItem("userData");return e?JSON.parse(e):null})();return e?.user_id||null})();if(e&&x.trim()){g(!0);try{const t=await l.interviews.requestReassignment(m._id||m.id,e,x);t.success?(O.success("Reassignment request submitted successfully. Awaiting admin approval."),c(!1),p(""),u(null),a(),o&&o()):O.error(t.message||"Failed to submit reassignment request")}catch(t){O.error("Failed to submit reassignment request")}finally{g(!1)}}else O.error("Please provide a reason for reassignment")},confirmLoading:h,okText:"Submit Request",cancelText:"Cancel",children:[m&&e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("h4",{children:"Interview Details:"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Candidate:"})," ",m.candidate_name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," ",m.mobile_number]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",m.status]})]}),e.jsx("div",{style:{background:"#e6f7ff",border:"1px solid #91d5ff",borderRadius:"6px",padding:"12px",marginBottom:16},children:e.jsxs("p",{style:{margin:0,fontSize:"13px",color:"#096dd9"},children:[e.jsx("strong",{children:"Note:"})," This interview will be reassigned to you after admin approval."]})}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:8,fontWeight:"bold"},children:"Reason for Reassignment: *"}),e.jsx(F,{rows:4,placeholder:"Please provide a detailed reason for requesting this reassignment...",value:x,onChange:e=>p(e.target.value),maxLength:500,showCount:!0})]})]})]})},P=[{id:"all",label:"All",count:0},{id:"today",label:"Today Interview",count:0},{id:"upcoming",label:"Upcoming Interview",count:0},{id:"result",label:"Complete Interview",count:0}],U=()=>{const n=s(),[i,d]=t.useState([]),[c,m]=t.useState([]),[u,h]=t.useState(!0),[g,b]=t.useState("all"),[y,f]=t.useState(""),[w,v]=t.useState(!1),[j,N]=t.useState([]),[_,C]=t.useState(P),[k,S]=t.useState(null),E=t.useRef(null),[A,O]=t.useState(!1),[I,T]=t.useState(!1),[M,L]=t.useState([]),[D,F]=t.useState(!1),[B,U]=t.useState(!1),[q,z]=t.useState(!1),[W,G]=t.useState([]),[Y,V]=t.useState(!1),[J,K]=t.useState(!1),[Q,X]=t.useState("status"),[Z,ee]=t.useState({status:[],dateFrom:"",dateTo:"",hrManagerAdmin:"",interviewType:[],jobOpening:[]}),[te,se]=t.useState([]),[ae,re]=t.useState([]),[ne,ie]=t.useState(0),[le,oe]=t.useState([]),[de,ce]=t.useState([]),[me,ue]=t.useState({}),xe=()=>{const e=JSON.parse(localStorage.getItem("userPermissions")||"[]");return pe()?{can_view_all:!0,can_delete:!0,can_add:!0,can_edit:!0}:{can_view_all:(()=>{if(Array.isArray(e))for(const t of e)if(t&&("interview"===t.page||"Interview"===t.page||"interviews"===t.page||"Interviews"===t.page)){if(Array.isArray(t.actions))return t.actions.includes("all")||t.actions.includes("*");if("all"===t.actions||"*"===t.actions)return!0}return!1})(),can_delete:(()=>{if(Array.isArray(e))for(const t of e)if(t&&("interview"===t.page||"Interview"===t.page||"interviews"===t.page||"Interviews"===t.page)){if(Array.isArray(t.actions))return t.actions.includes("delete")||t.actions.includes("all");if("delete"===t.actions||"all"===t.actions||"*"===t.actions)return!0}return!1})(),can_add:!0,can_edit:!0}},pe=()=>{const e=JSON.parse(localStorage.getItem("userPermissions")||"[]"),t=localStorage.getItem("designation")?.toLowerCase(),s=localStorage.getItem("roleName")?.toLowerCase(),a=localStorage.getItem("userRole")?.toLowerCase(),r=localStorage.getItem("role")?.toLowerCase();if("admin"===t||"super admin"===t||"superadmin"===t||"administrator"===t||"admin"===s||"super admin"===s||"superadmin"===s||"administrator"===s||"admin"===a||"super admin"===a||"superadmin"===a||"admin"===r||"super admin"===r||"superadmin"===r)return!0;if(Array.isArray(e))for(const n of e){if(n&&("*"===n.page||"Global"===n.page||"global"===n.page))return!0;if(n&&("interview"===n.page||"Interview"===n.page||"interviews"===n.page||"Interviews"===n.page)&&("*"===n.actions||"all"===n.actions||Array.isArray(n.actions)&&(n.actions.includes("*")||n.actions.includes("all"))))return!0}return!1};t.useEffect(()=>{he()},[]),t.useEffect(()=>{const e=xe();pe()&&(e.can_delete=!0,e.can_view_all=!0,e.can_add=!0,e.can_edit=!0),ue(e)},[]),t.useEffect(()=>{const e=()=>{const e=xe();pe()&&(e.can_delete=!0,e.can_view_all=!0,e.can_add=!0,e.can_edit=!0),ue(e)};return window.addEventListener("permissionsUpdated",e),()=>{window.removeEventListener("permissionsUpdated",e)}},[]),t.useEffect(()=>{const e=()=>{he()};return window.addEventListener("focus",e),()=>window.removeEventListener("focus",e)},[]);const he=async()=>{try{try{const e=await o.getJobOpenings();if(e.success&&e.data&&e.data.length>0){const t=e.data.map(e=>"object"==typeof e&&e.name?e.name:"string"==typeof e?e:e.value?e.value:e.title?e.title:String(e));se(t)}else se(["Software Engineer","Frontend Developer","Backend Developer","Full Stack Developer","Data Analyst","Business Analyst","Project Manager","UI/UX Designer","DevOps Engineer","Quality Assurance","Sales Executive","Marketing Executive","Customer Support","Human Resources","Finance Executive","Operations Manager","Content Writer","Digital Marketing","Business Development","Other"])}catch(e){se(["Software Engineer","Frontend Developer","Backend Developer","Full Stack Developer","Data Analyst","Business Analyst","Project Manager","UI/UX Designer","DevOps Engineer","Quality Assurance","Sales Executive","Marketing Executive","Customer Support","Human Resources","Other"])}try{const e=await o.getInterviewTypes();if(e.success&&e.data&&e.data.length>0){const t=e.data.map(e=>e.name||e.value||e);re(t)}else re(["Technical Interview","HR Interview","Management Round","Final Round","Phone Screening","Video Interview","Walk-in Interview","Group Discussion","Coding Assessment","Behavioral Interview"])}catch(e){re(["Technical Interview","HR Interview","Management Round","Final Round","Phone Screening","Video Interview","Walk-in Interview","Group Discussion"])}try{const e=await o.getSourcePortals();if(e.success&&e.data&&e.data.length>0){const t=e.data.map(e=>e.name||e.value||e);oe(t)}else oe(["LinkedIn","Naukri.com","Indeed","Monster.com","Glassdoor","AngelList","Referral","Company Website","Job Fair","Campus Placement","Social Media","Walk-in","Consultant","Other"])}catch(e){oe(["LinkedIn","Naukri.com","Indeed","Monster.com","Referral","Walk-in","Other"])}try{const t=await o.getStatuses();if(t.success&&t.data){const s=[];for(const r of t.data)try{const e=await o.getSubStatuses(r._id),t={...r,sub_statuses:e.success?e.data:[]};s.push(t)}catch(e){s.push({...r,sub_statuses:[]})}const a=t.data.map(e=>e.name||e.value||e);a.includes("rescheduled")||a.push("rescheduled"),De(a),Fe(s)}else De(["new_interview","selected","rejected","no_show","not_relevant","rescheduled"]),Fe([])}catch(e){De(["new_interview","selected","rejected","no_show","not_relevant","rescheduled"]),Fe([])}}catch(e){re(["Technical Interview","HR Interview","Management Round","Final Round","Phone Screening","Video Interview","Coding Assessment","System Design","Behavioral Interview"]),De(["new_interview","selected","rejected","no_show","not_relevant","rescheduled"])}},[ge,be]=t.useState(null),[ye,fe]=t.useState({top:0,left:0,maxHeight:350}),[we,ve]=t.useState(""),[je,Ne]=t.useState(!0),[_e,Ce]=t.useState(null),[ke,Se]=t.useState(null),[Ee,Ae]=t.useState(!0),[Oe,Ie]=t.useState(null),[Te,Me]=t.useState(""),[Le,De]=t.useState(["new_interview","selected","rejected","no_show","not_relevant","rescheduled"]),[Re,Fe]=t.useState([]),Be=()=>{let e=0;return Z.status&&Z.status.length>0&&e++,(Z.dateFrom||Z.dateTo)&&e++,Z.hrManagerAdmin&&""!==Z.hrManagerAdmin.trim()&&e++,Z.interviewType&&Array.isArray(Z.interviewType)&&Z.interviewType.length>0&&e++,Z.jobOpening&&Array.isArray(Z.jobOpening)&&Z.jobOpening.length>0&&e++,y&&""!==y.trim()&&e++,e},Pe=e=>{switch(e){case"status":return Z.status&&Z.status.length>0?1:0;case"date":return Z.dateFrom||Z.dateTo?1:0;case"hrManagerAdmin":return Z.hrManagerAdmin&&""!==Z.hrManagerAdmin.trim()?1:0;case"interviewType":return Z.interviewType&&Array.isArray(Z.interviewType)&&Z.interviewType.length>0?1:0;case"jobOpening":return Z.jobOpening&&Array.isArray(Z.jobOpening)&&Z.jobOpening.length>0?1:0;default:return 0}},Ue=t.useCallback(async()=>{try{h(!0);const e=await l.interviews.getInterviews(1,1e3).catch(e=>{if(e.message&&e.message.includes("404"))throw new Error("Interviews endpoint not found. Please check if the backend server is running with the interviews module enabled.");throw e});d(e||[])}catch(e){alert(`Failed to load interviews: ${e.message}`),d([])}finally{h(!1)}},[]);t.useEffect(()=>{Ue()},[Ue]);const He=async()=>{try{V(!0);const t=await l.interviews.getAllReassignments();if(t.success&&t.data){let s={};try{const e=await l.users.getUsers();e&&e.length>0&&(s=e.reduce((e,t)=>(e[t._id]=`${t.first_name} ${t.last_name}`.trim(),e),{}))}catch(e){}const a=t.data.map(e=>{const t="Unknown"===e.reassignment_requested_by_name?s[e.reassignment_requested_by]||"Unknown":e.reassignment_requested_by_name||"Unknown",a="Unknown"===e.reassignment_target_user_name?s[e.reassignment_target_user]||"Unknown":e.reassignment_target_user_name||"Unknown";return{...e,requested_by:t,requested_by_id:e.reassignment_requested_by,target_user:a,target_user_id:e.reassignment_target_user,current_assignee:e.current_user_name||"Current User",current_assignee_id:e.current_user_id,reason:e.reassignment_reason,requested_at:e.reassignment_requested_at,reassignment_status:e.reassignment_status||"pending",pending_reassignment:"pending"===e.reassignment_status,interview_date:e.interview_date||e.created_at}});G(a)}else G([])}catch(t){G([])}finally{V(!1)}};t.useEffect(()=>{i.length>0&&(async()=>{try{const e=[...new Set(i.map(e=>e.created_by).filter(e=>e&&""!==e.trim()))];if(e.length>0){const t=e.map(e=>({id:e,username:e,role:"Interview Creator",displayName:e}));ce(t)}else{const e=await l.get("/users");if(e.data){const t=e.data.filter(e=>e.role&&(e.role.toLowerCase().includes("hr_manager")||e.role.toLowerCase().includes("super admin")||e.role.toLowerCase().includes("hr manager")||e.role.toLowerCase().includes("admin"))).map(e=>({id:e._id||e.id,username:e.username,role:e.role,displayName:`${e.username} (${e.role})`}));ce(t)}}}catch(e){ce([])}})()},[i]),t.useEffect(()=>{const e=()=>{document.hidden||Ue()},t=()=>{Ue()};return document.addEventListener("visibilitychange",e),window.addEventListener("focus",t),()=>{document.removeEventListener("visibilitychange",e),window.removeEventListener("focus",t)}},[Ue]);const qe=t.useCallback(e=>{if(!e)return"Open";const t=e.toLowerCase(),s=["select","hired","approved","confirmed_hired","final_select","reject","denied","cancelled","not_interested","declined","completed","finished","closed","done","final"].some(e=>t.includes(e)),a=["new","created","initial","scheduled","rescheduled","pending","waiting","hold","process","progress","ongoing","review","evaluation","interview","assessment","test"].some(e=>t.includes(e));let r;if(s)r="Complete";else if(a)r="Open";else if(Re.length>0){const t=e.includes(":")?e.split(":")[0]:e,s=Re.find(e=>e&&e.name&&e.name.toLowerCase()===t.toLowerCase());r=s?.statusType||"Open"}else r="Open";return r},[Re]),$e=t.useCallback(()=>{const e=i||[];if(0===e.length){const e=P.map(e=>({...e,count:0}));return C(e),void N([])}const t=(new Date).toDateString(),s=e=>{const t=e.toLowerCase();if(t.includes("reject")||t.includes("denied")||t.includes("cancelled"))return"bg-red-500";if(t.includes("select")||t.includes("hired")||t.includes("approved")||t.includes("confirmed"))return"bg-green-500";if(t.includes("reschedule")||t.includes("postpone")||t.includes("delay"))return"bg-purple-500";if(t.includes("pending")||t.includes("waiting")||t.includes("hold"))return"bg-yellow-500";if(t.includes("new")||t.includes("created")||t.includes("initial"))return"bg-blue-500";if(t.includes("process")||t.includes("progress")||t.includes("ongoing"))return"bg-indigo-500";if(t.includes("review")||t.includes("evaluation"))return"bg-orange-500";{const t=["bg-gray-500","bg-pink-500","bg-teal-500","bg-cyan-500","bg-emerald-500","bg-violet-500"],s=e.split("").reduce((e,t)=>(e=(e<<5)-e+t.charCodeAt(0))&e,0);return t[Math.abs(s)%t.length]}},a=Le.map((t,a)=>{const r=e.filter(e=>e.status===t);return{label:t.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase()),count:r.length,color:s(t)}});N(a);const r=P.map(s=>{let a=0;return"today"===s.id?a=e.filter(e=>new Date(e.interview_date).toDateString()===t&&"Open"===qe(e.status)).length:"upcoming"===s.id?a=e.filter(e=>new Date(e.interview_date)>new Date&&"Open"===qe(e.status)).length:"result"===s.id?a=e.filter(e=>"Complete"===qe(e.status)).length:"all"===s.id&&(a=e.length),{...s,count:a}});C(r)},[i,Re,qe]);t.useEffect(()=>{$e()},[i,$e]),t.useEffect(()=>{Re.length>0&&i.length>0&&$e()},[Re,$e,i]),t.useEffect(()=>{ze()},[c]),t.useEffect(()=>{},[g]),t.useEffect(()=>{let e=[...i];const t=(new Date).toDateString();if(i.length>0&&i[i.length-1],"today"===g)e.length,e=e.filter(e=>{const s=new Date(e.interview_date).toDateString()===t,a=qe(e.status);return s&&"Open"===a});else if("upcoming"===g){e.length;const t=new Date;e=e.filter(e=>{const s=new Date(e.interview_date)>t,a=qe(e.status);return s&&"Open"===a})}else"result"===g&&(e.length,e=e.filter(e=>"Complete"===qe(e.status)));Z.status&&Z.status.length>0&&(e=e.filter(e=>{const t=e.status?.toLowerCase();return Z.status.some(e=>{const s=e.toLowerCase();if(t===s)return!0;if(t&&t.includes(":")){const[e,a]=t.split(":");return`${e}:${a}`===s}return!1})})),(Z.dateFrom||Z.dateTo)&&(e=e.filter(e=>{const t=new Date(e.interview_date),s=Z.dateFrom?new Date(Z.dateFrom):null,a=Z.dateTo?new Date(Z.dateTo):null;let r=!0;return s&&(r=r&&t>=s),a&&(r=r&&t<=a),r})),Z.hrManagerAdmin&&""!==Z.hrManagerAdmin.trim()&&(e=e.filter(e=>e.created_by?.toLowerCase()===Z.hrManagerAdmin.toLowerCase()||e.created_by_name?.toLowerCase()===Z.hrManagerAdmin.toLowerCase())),Z.interviewType&&Array.isArray(Z.interviewType)&&Z.interviewType.length>0&&(e=e.filter(e=>Z.interviewType.some(t=>e.interview_type?.toLowerCase().includes(t.toLowerCase())))),Z.jobOpening&&Array.isArray(Z.jobOpening)&&Z.jobOpening.length>0&&(e=e.filter(e=>Z.jobOpening.some(t=>e.job_opening?.toLowerCase().includes(t.toLowerCase())))),y&&(e=e.filter(e=>e.candidate_name?.toLowerCase().includes(y.toLowerCase())||e.mobile_number?.includes(y)||e.job_opening?.toLowerCase().includes(y.toLowerCase())||e.city?.toLowerCase().includes(y.toLowerCase()))),i.length>e.length&&i.filter(t=>!e.includes(t)),m(e)},[i,g,y,Z,qe,ne,Re]);const ze=()=>{if(E.current){const{scrollLeft:e,scrollWidth:t,clientWidth:s}=E.current;O(e>0),T(e<t-s-1)}},We=()=>{if(D)L([]),F(!1);else{const e=c.map(e=>e._id);L(e),F(!0)}},Ge=e=>{const t=Re.find(t=>t.name===e);return t?.sub_statuses||[]},Ye=()=>{const e={status:[],interviewType:[...ae],jobOpening:[...te]};return Le.forEach(t=>{e.status.push({type:"main",value:t,label:t.replace("_"," ").toUpperCase(),isHierarchical:Ge(t).length>0})}),Re.forEach(t=>{t.sub_statuses&&t.sub_statuses.length>0&&t.sub_statuses.forEach(s=>{const a=`${t.name}:${s.name}`;e.status.push({type:"sub",value:a,label:`${t.name.replace("_"," ").toUpperCase()} â†’ ${s.name}`,mainStatus:t.name,subStatusName:s.name})})}),e};t.useEffect(()=>{Ye()},[Le,Re,ae,te]);const Ve=()=>{if(Te){const e=[];return Le.forEach(t=>{(t.toLowerCase().includes(Te.toLowerCase())||t.replace("_"," ").toLowerCase().includes(Te.toLowerCase()))&&e.push({type:"main",value:t,label:t.replace("_"," ").toUpperCase(),isHierarchical:Ge(t).length>0})}),Re.forEach(t=>{t.sub_statuses&&t.sub_statuses.length>0&&t.sub_statuses.forEach(s=>{const a=s.name||s;if(a.toLowerCase().includes(Te.toLowerCase())||t.name.toLowerCase().includes(Te.toLowerCase())){const s=`${t.name}:${a}`;e.push({type:"sub",value:s,label:`${t.name.replace("_"," ").toUpperCase()} â†’ ${a}`,mainStatus:t.name,subStatusName:a})}})}),e}if(Ee)return Le.map(e=>({type:"main",value:e,label:e.replace("_"," ").toUpperCase(),isHierarchical:Ge(e).length>0}));if(Oe){const e=Re.find(e=>e.name===Oe);if(e&&e.sub_statuses)return e.sub_statuses.map(e=>({type:"sub",value:`${Oe}:${e.name}`,label:e.name,mainStatus:Oe,subStatusName:e.name}))}return[]};return a.useEffect(()=>{const e=e=>{null===ge||e.target.closest(".status-dropdown-container")||e.target.closest(".status-dropdown-menu")||be(null)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[ge]),u?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-lg text-gray-600",children:"Loading interviews..."})}):e.jsxs(e.Fragment,{children:[e.jsx("style",{children:"\n    .sticky-table-container {\n      max-height: 600px;\n      overflow-y: auto;\n      overflow-x: auto;\n      border-radius: 12px;\n    }\n    \n    .sticky-header {\n      position: sticky;\n      top: 0;\n      background: white;\n      z-index: 10;\n      box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    }\n    \n    .sticky-th {\n      position: sticky;\n      top: 0;\n      background: white;\n      z-index: 10;\n      border-bottom: 2px solid #e5e7eb;\n    }\n  "}),e.jsxs("div",{className:"p-6 bg-black min-h-screen",children:[e.jsxs("div",{className:"flex justify-end items-center mb-6 gap-3",children:[(()=>{const e=x(),t=p(e,"interview","settings"),s=p(e,"*","*");return t||s})()&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>n("/interview-settings"),className:"bg-gray-600 hover:bg-gray-700 text-white px-3 py-2 rounded-lg font-medium transition-colors flex items-center gap-2",title:"Manage Job Opening Options",children:[e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Settings"]}),e.jsxs("button",{onClick:async()=>{z(!0),await He()},className:"bg-purple-600 hover:bg-purple-700 text-white px-3 py-2 rounded-lg font-medium transition-colors flex items-center gap-2",title:"View Reassignment Requests",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),"Reassignments"]})]}),e.jsx("button",{onClick:async()=>{try{await he(),v(!0)}catch(e){alert(`Failed to open create interview modal: ${e.message}`)}},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:"Create Interview"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-2 sm:gap-3 md:gap-4 mb-6",children:j.map((t,s)=>e.jsxs("div",{className:r("p-3 sm:p-4 rounded-lg text-white shadow-lg",t.color),children:[e.jsx("h3",{className:"text-sm sm:text-base lg:text-lg font-semibold truncate",children:t.label}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold",children:t.count})]},s))}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-6 items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[null,(me?.can_delete||pe())&&(B?e.jsxs("div",{className:"flex items-center gap-6 bg-gray-900 rounded-lg p-3",children:[e.jsxs("label",{className:"flex items-center cursor-pointer text-[#03B0F5] font-bold",children:[e.jsx("input",{type:"checkbox",className:"accent-blue-500 mr-2 cursor-pointer",checked:D,onChange:We,style:{width:18,height:18}}),"Select All"]}),e.jsxs("span",{className:"text-white font-semibold",children:[M.length," interview",1!==M.length?"s":""," selected"]}),e.jsxs("button",{className:"px-3 py-1 bg-red-600 text-white rounded font-bold hover:bg-red-700 transition",onClick:async()=>{if(0===M.length)return void toast.warning("Please select interviews to delete");if(!window.confirm(`Are you sure you want to delete ${M.length} interview(s)? This action cannot be undone.`))return;let e=0,t=0;const s=[];try{h(!0);const r=localStorage.getItem("token");for(const n of M)try{const a=await fetch(`/api/interviews/${n}`,{method:"DELETE",headers:{Authorization:`Bearer ${r}`}});a.ok?e++:(t++,s.push(`Interview ${n}: ${a.statusText}`))}catch(a){t++,s.push(`Interview ${n}: ${a.message}`)}e>0&&0===t?toast.success(`Successfully deleted ${e} interview(s)`):e>0&&t>0?toast.warning(`Deleted ${e} interview(s), but ${t} failed. Check console for details.`):t>0&&toast.error("Failed to delete interviews. Check console for details."),L([]),F(!1),U(!1),await Ue()}catch(a){toast.error("Failed to delete interviews")}finally{h(!1)}},disabled:0===M.length,children:["Delete (",M.length,")"]}),e.jsx("button",{className:"px-3 py-1 bg-gray-600 text-white rounded font-bold hover:bg-gray-700 transition",onClick:()=>{L([]),F(!1),U(!1)},children:"Cancel"})]}):e.jsx("button",{className:"bg-[#03B0F5] text-white px-5 py-3 rounded-lg font-bold shadow hover:bg-[#0280b5] transition text-base",onClick:()=>{U(!0)},children:"Select"}))]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{className:"px-5 py-3 rounded-lg font-bold shadow transition relative flex items-center gap-3 text-base "+(Be()>0?"bg-orange-500 text-white hover:bg-orange-600":"bg-gray-600 text-white hover:bg-gray-700"),onClick:()=>{K(!0),Ae(!0),Ie(null),Me("")},children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filter",Be()>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-sm rounded-full h-6 w-6 flex items-center justify-center",children:Be()})]}),e.jsxs("div",{className:"relative w-[320px]",children:[e.jsx("input",{type:"text",placeholder:"Search interviews...",value:y,onChange:e=>f(e.target.value),className:"w-full py-3 pl-10 pr-4 bg-[#1b2230] text-gray-300 rounded-lg focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 text-base placeholder-gray-500"}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),y&&e.jsx("button",{onClick:()=>f(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-300",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})]})]}),e.jsx("div",{className:"flex space-x-4 mb-6 border-b border-gray-600",children:_.map(t=>e.jsxs("button",{onClick:()=>{b(t.id)},className:r("px-4 py-2 font-medium transition-colors border-b-2",g===t.id?"border-blue-500 text-blue-400":"border-transparent text-gray-400 hover:text-gray-200"),children:[t.label," (",t.count,")"]},t.id))}),e.jsx(H,{interviews:c,onRowClick:async e=>{try{if(!e)throw new Error("No interview data provided");S(e)}catch(t){alert("Failed to open interview details: "+t.message)}},showStatusDropdown:ge,handleStatusDropdownClick:(e,t)=>{if(t.stopPropagation(),t.preventDefault(),ge===e)return void be(null);const s=t.currentTarget.getBoundingClientRect(),a=window.innerHeight-s.bottom,r=s.top,n=350;let i=s.bottom+window.scrollY,l=n;a<n&&r>a?(i=s.top+window.scrollY-n,l=Math.min(n,r-10)):l=Math.min(n,a-10),fe({top:i,left:s.left+window.scrollX,maxHeight:l}),be(e),ve(""),Ne(!0),Ce(null),Se(null)},dropdownPosition:ye,statusSearchTerm:we,setStatusSearchTerm:ve,handleStatusChange:async(e,t,s=!1)=>{try{if(s&&Ge(t).length>0)return Ce(t),Ne(!1),void ve("");const a=c[e];let r=t;"object"==typeof t&&null!==t&&(r=t.name?t.name:t.value?t.value:String(t)),await l.interviews.updateInterview(a._id,{status:r}),d(e=>e.map(e=>e._id===a._id?{...e,status:r}:e)),ie(e=>e+1),be(null),Ne(!0),Ce(null),ve(""),setTimeout(()=>{Ue()},100)}catch(a){let e="Unknown error occurred";if("string"==typeof a)e=a;else if(a?.message)e=a.message;else if(a?.error)e=a.error;else if(a?.detail)e=a.detail;else if(a?.response?.data?.error)e=a.response.data.error;else if(a?.response?.data?.detail)e=a.response.data.detail;else if(a?.response?.data?.message)e=a.response.data.message;else if("object"==typeof a)try{e=JSON.stringify(a)}catch(r){e="Error occurred but could not extract details"}alert("Failed to update interview status: "+e)}},getFilteredStatusOptions:()=>{if(we){const e=[];return Le.forEach(t=>{(t.toLowerCase().includes(we.toLowerCase())||t.replace("_"," ").toLowerCase().includes(we.toLowerCase()))&&e.push(t)}),Re.forEach(t=>{t.sub_statuses&&t.sub_statuses.length>0&&t.sub_statuses.forEach(s=>{((s.name||s).toLowerCase().includes(we.toLowerCase())||t.name.toLowerCase().includes(we.toLowerCase()))&&e.push(s)})}),e}if(je)return Le;if(_e){const e=Re.find(e=>e.name===_e);if(e&&e.sub_statuses)return e.sub_statuses}return Le},formatStatusDisplay:e=>{if(!e)return"Select Status";if(e.includes(":")){const[t,s]=e.split(":");return`${t.replace("_"," ").toUpperCase()} â†’ ${s}`}return e.replace("_"," ").toUpperCase()},showMainStatuses:je,selectedMainStatus:_e,handleBackToMainStatuses:()=>{Ne(!0),Ce(null),ve("")},getSubStatusesForMainStatus:Ge,clickedStatusOption:ke,setClickedStatusOption:Se,selectedInterviews:M,selectAll:D,onSelectInterview:e=>{L(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},onSelectAll:We,checkboxVisible:B,scrollTable:e=>{if(E.current){const t=300,s=E.current.scrollLeft,a="left"===e?s-t:s+t;E.current.scrollTo({left:a,behavior:"smooth"})}},updateScrollButtons:ze,tableScrollRef:E,canScrollLeft:A,canScrollRight:I}),w&&e.jsx(a.Suspense,{fallback:e.jsx("div",{children:"Loading modal..."}),children:e.jsx($,{onClose:()=>{v(!1)},onInterviewCreated:async e=>{try{v(!1),await Ue(),await he(),b("all"),f(""),ee({status:[],dateFrom:"",dateTo:"",hrManagerAdmin:"",interviewType:[],jobOpening:[]})}catch(t){d(t=>[...t,e])}},jobOpeningOptions:te,interviewTypeOptions:ae,statusOptions:Le,statusOptionsWithSubs:Re,sourcePortalOptions:le,existingInterviews:i})}),k&&e.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center bg-transparent justify-center",style:{backdropFilter:"blur(3px)"},children:e.jsx("div",{className:"w-full max-w-4xl mx-auto",children:e.jsx(R,{interview:k,onSave:async(e,t)=>{try{const s=await l.interviews.updateInterview(e,t);if(!s)throw new Error("Failed to update interview - no response from server");return await new Promise(e=>setTimeout(e,500)),await Ue(),await he(),s&&k&&S(s),d(t=>s?t.map(t=>t._id===e||t.id===e?s:t):[...t]),s}catch(s){try{await Ue(),await he()}catch(a){}throw s}},onClose:()=>{S(null)},jobOpeningOptions:te,interviewTypeOptions:ae,sourcePortalOptions:le})})}),J&&e.jsx("div",{className:"fixed inset-0 bg-transparent bg-opacity-50 flex items-center justify-center z-[1000]",children:e.jsxs("div",{className:"bg-[#1b2230] border border-gray-600 rounded-lg p-6 w-[700px] max-w-[90vw] h-[560px] flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Filter Interviews"}),e.jsx("button",{onClick:()=>K(!1),className:"text-gray-400 hover:text-white text-2xl",children:"Ã—"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-6 flex-1 overflow-hidden",children:[e.jsxs("div",{className:"col-span-1 border-r border-gray-600 pr-4",children:[e.jsx("h3",{className:"text-base font-medium text-gray-300 mb-4",children:"Filter Categories"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>{X("status"),Ae(!0),Ie(null),Me("")},className:"w-full text-left px-4 py-3 rounded-lg transition-colors "+("status"===Q?"bg-blue-600 text-white":"text-gray-300 hover:bg-[#2a3441]"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-base",children:"Status"})]}),Pe("status")>0&&e.jsx("span",{className:"bg-red-500 text-white text-sm rounded-full h-6 w-6 flex items-center justify-center",children:Pe("status")})]})}),e.jsx("button",{onClick:()=>X("date"),className:"w-full text-left px-3 py-2 rounded-lg transition-colors "+("date"===Q?"bg-blue-600 text-white":"text-gray-300 hover:bg-[#2a3441]"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Interview Date"]}),Pe("date")>0&&e.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:Pe("date")})]})}),e.jsx("button",{onClick:()=>X("hrManagerAdmin"),className:"w-full text-left px-3 py-2 rounded-lg transition-colors "+("hrManagerAdmin"===Q?"bg-blue-600 text-white":"text-gray-300 hover:bg-[#2a3441]"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Interview Creator"]}),Pe("hrManagerAdmin")>0&&e.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:Pe("hrManagerAdmin")})]})}),e.jsx("button",{onClick:()=>X("interviewType"),className:"w-full text-left px-3 py-2 rounded-lg transition-colors "+("interviewType"===Q?"bg-blue-600 text-white":"text-gray-300 hover:bg-[#2a3441]"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),"Interview Type"]}),Pe("interviewType")>0&&e.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:Pe("interviewType")})]})}),e.jsx("button",{onClick:()=>X("jobOpening"),className:"w-full text-left px-3 py-2 rounded-lg transition-colors "+("jobOpening"===Q?"bg-blue-600 text-white":"text-gray-300 hover:bg-[#2a3441]"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2-2v2m8 0H8m8 0v2a2 2 0 01-2 2H10a2 2 0 01-2-2V6"})}),"Job Opening"]}),Pe("jobOpening")>0&&e.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:Pe("jobOpening")})]})})]})]}),e.jsxs("div",{className:"col-span-2 pl-4 overflow-y-auto",children:[e.jsxs("h3",{className:"text-base font-medium text-gray-300 mb-4",children:["status"===Q&&"Interview Status","date"===Q&&"Interview Date Range","hrManagerAdmin"===Q&&"Interview Creator","interviewType"===Q&&"Interview Type","jobOpening"===Q&&"Job Opening"]}),e.jsxs("div",{className:"space-y-4",children:["status"===Q&&e.jsxs("div",{className:"space-y-3",children:[!Ee&&Oe&&e.jsxs("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-600",children:[e.jsxs("button",{onClick:()=>{Ae(!0),Ie(null),Me("")},className:"flex items-center text-blue-400 hover:text-blue-300 text-sm font-medium",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"Back to Main Statuses"]}),e.jsx("span",{className:"text-xs text-gray-400 font-medium",children:Oe.replace("_"," ").toUpperCase()})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",className:"w-full pl-10 pr-3 py-2 bg-[#2a3441] border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-blue-500",placeholder:Ee?"Search statuses and sub-statuses...":"Search sub-statuses...",value:Te,onChange:e=>Me(e.target.value)})]}),Ve().map(t=>{const s=Ee&&!Te,a="main"===t.type&&t.isHierarchical&&s;return e.jsxs("div",{className:"flex items-center space-x-3 cursor-pointer hover:bg-[#2a3441] p-2 rounded-lg transition-colors "+(a?"hover:bg-blue-900/20":""),onClick:()=>(e=>{if("main"===e.type&&e.isHierarchical&&Ee&&!Te)return Ie(e.value),Ae(!1),void Me("");const t=e.value;Z.status.includes(t)?ee(e=>({...e,status:e.status.filter(e=>e!==t)})):ee(e=>({...e,status:[...e.status,t]}))})(t),children:[!a&&e.jsx("input",{type:"checkbox",checked:Z.status.includes(t.value),onChange:()=>{},className:"w-4 h-4 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500 pointer-events-none"}),e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("span",{className:"text-gray-300 "+("sub"===t.type?"text-sm":""),children:["main"===t.type&&t.isHierarchical&&"ðŸ“‹ ","sub"===t.type&&"â†³ ",t.label,"sub"===t.type&&!Ee&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Main Status: ",t.mainStatus.replace("_"," ").toUpperCase()]})]}),a&&e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})]}),a&&Ge(t.value).length>0&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[Ge(t.value).length," sub-status",1!==Ge(t.value).length?"es":""]})]},t.value)}),0===Ve().length&&e.jsx("p",{className:"text-gray-400 text-sm text-center py-4",children:Te?`No results found for "${Te}"`:"No status options available"})]}),"date"===Q&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"From Date"}),e.jsx("input",{type:"date",value:Z.dateFrom,onChange:e=>ee(t=>({...t,dateFrom:e.target.value})),className:"w-full px-3 py-2 bg-[#2a3441] border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"To Date"}),e.jsx("input",{type:"date",value:Z.dateTo,onChange:e=>ee(t=>({...t,dateTo:e.target.value})),className:"w-full px-3 py-2 bg-[#2a3441] border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-blue-500"})]})]}),"hrManagerAdmin"===Q&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Select Interview Creator"}),e.jsxs("select",{value:Z.hrManagerAdmin,onChange:e=>ee(t=>({...t,hrManagerAdmin:e.target.value})),className:"w-full px-3 py-2 bg-[#2a3441] border border-gray-600 rounded-lg text-white focus:outline-none focus:border-blue-500",children:[e.jsx("option",{value:"",children:"All Interview Creators"}),de.map(t=>e.jsx("option",{value:t.username,children:t.username},t.username))]})]}),"interviewType"===Q&&e.jsxs("div",{className:"space-y-3",children:[Ye().interviewType.map(t=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:Z.interviewType.includes&&Z.interviewType.includes(t),onChange:e=>{e.target.checked?ee(e=>({...e,interviewType:Array.isArray(e.interviewType)?[...e.interviewType,t]:[t]})):ee(e=>({...e,interviewType:Array.isArray(e.interviewType)?e.interviewType.filter(e=>e!==t):[]}))},className:"w-4 h-4 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-gray-300",children:t})]},t)),0===Ye().interviewType.length&&e.jsx("p",{className:"text-gray-400 text-sm",children:"No interview types available. Add them in settings."})]}),"jobOpening"===Q&&e.jsxs("div",{className:"space-y-3",children:[0===te.length?e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-gray-400 text-sm",children:"Loading job openings..."})}):te.map(t=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:Z.jobOpening&&Array.isArray(Z.jobOpening)&&Z.jobOpening.includes(t),onChange:e=>{e.target.checked?ee(e=>({...e,jobOpening:Array.isArray(e.jobOpening)?[...e.jobOpening,t]:[t]})):ee(e=>({...e,jobOpening:Array.isArray(e.jobOpening)?e.jobOpening.filter(e=>e!==t):[]}))},className:"w-4 h-4 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-gray-300",children:t})]},t)),0===te.length&&e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"No job openings available."}),e.jsx("p",{className:"text-gray-500 text-xs mt-1",children:"Add job openings in settings to see them here."})]})]})]})]})]}),e.jsxs("div",{className:"flex justify-between mt-6 pt-4 border-t border-gray-600",children:[e.jsx("button",{onClick:()=>{ee({status:[],dateFrom:"",dateTo:"",hrManagerAdmin:"",interviewType:[],jobOpening:[]})},className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition",children:"Clear All Filters"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>K(!1),className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition",children:"Cancel"}),e.jsx("button",{onClick:()=>{K(!1)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Apply Filters"})]})]})]})}),q&&e.jsx("div",{className:"fixed inset-0 bg-transparent bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-[#1a2332] rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 bg-purple-600 text-white flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Interview Reassignment Requests"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:He,className:"px-4 py-2 bg-purple-700 text-white rounded-lg hover:bg-purple-800 transition-colors font-medium",disabled:Y,children:Y?"Refreshing...":"Refresh"}),e.jsx("button",{onClick:()=>z(!1),className:"text-white hover:text-gray-200 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})]}),e.jsx("div",{className:"p-6 overflow-y-auto",style:{maxHeight:"calc(90vh - 80px)"},children:Y?e.jsx("div",{className:"text-center py-12 text-gray-400",children:e.jsx("div",{className:"text-lg",children:"Loading reassignment requests..."})}):0===W.length?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6M9 16h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h10a2 2 0 012 2v14a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-lg",children:"No reassignment requests found"}),e.jsx("p",{className:"text-sm",children:"Reassignment requests will appear here when users request interview reassignments."})]}):e.jsx("div",{className:"bg-[#2a3441] rounded-lg border border-gray-600 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-white",children:[e.jsx("thead",{className:"bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Interview"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Current Assignee"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Requested By"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Target User"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Reason"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Requested At"}),e.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-300",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:W.map((t,s)=>e.jsxs("tr",{className:"hover:bg-gray-800/50 transition-colors",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:t.candidate_name}),e.jsx("div",{className:"text-sm text-gray-400",children:t.mobile_number}),e.jsxs("div",{className:"text-xs text-gray-500",children:[t.job_opening," â€¢ ",t.status,t.sub_status&&` â€¢ ${t.sub_status}`]}),t.interview_date&&e.jsx("div",{className:"text-xs text-blue-400",children:new Date(t.interview_date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("div",{className:"text-white",children:t.current_assignee})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("div",{className:"text-white",children:t.requested_by})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("div",{className:"text-white",children:t.target_user})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("div",{className:"text-sm text-gray-300 max-w-xs",children:t.reason||"No reason provided"})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("div",{className:"text-sm text-gray-400",children:t.requested_at?new Date(t.requested_at).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Unknown"})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"text-center",children:["pending"===t.reassignment_status?e.jsx("span",{className:"px-2 py-1 bg-yellow-600 text-white text-xs rounded-full",children:"Pending"}):"approved"===t.reassignment_status?e.jsx("span",{className:"px-2 py-1 bg-green-600 text-white text-xs rounded-full",children:"Approved"}):"rejected"===t.reassignment_status?e.jsx("span",{className:"px-2 py-1 bg-red-600 text-white text-xs rounded-full",children:"Rejected"}):e.jsx("span",{className:"px-2 py-1 bg-yellow-600 text-white text-xs rounded-full",children:t.reassignment_status||"Pending"}),t.reassignment_remarks&&e.jsx("div",{className:"text-xs text-gray-400 mt-1",title:t.reassignment_remarks,children:t.reassignment_remarks.length>20?`${t.reassignment_remarks.substring(0,20)}...`:t.reassignment_remarks})]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex justify-center gap-2",children:["pending"===t.reassignment_status&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>(async e=>{try{const t=localStorage.getItem("userId"),s=await l.interviews.approveReassignment(e,t);s.success?(alert("Reassignment request approved successfully!"),await He(),await Ue()):alert("Failed to approve reassignment: "+(s.message||"Unknown error"))}catch(t){alert("Error approving reassignment: "+t.message)}})(t._id),className:"px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700 transition-colors",title:"Approve reassignment",children:"Approve"}),e.jsx("button",{onClick:()=>(async e=>{try{const t=prompt("Please provide a reason for rejection (optional):"),s=localStorage.getItem("userId"),a=await l.interviews.rejectReassignment(e,s,t||"");a.success?(alert("Reassignment request rejected successfully!"),await He()):alert("Failed to reject reassignment: "+(a.message||"Unknown error"))}catch(t){alert("Error rejecting reassignment: "+t.message)}})(t._id),className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors",title:"Reject reassignment",children:"Reject"})]}),"pending"!==t.reassignment_status&&e.jsx("span",{className:"text-xs text-gray-500",children:"approved"===t.reassignment_status?"Already Approved":"Already Rejected"})]})})]},t._id))})]})})})})]})})]})]})},H=({interviews:t,onRowClick:s,showStatusDropdown:a,handleStatusDropdownClick:r,dropdownPosition:n,statusSearchTerm:l,setStatusSearchTerm:o,handleStatusChange:d,getFilteredStatusOptions:c,formatStatusDisplay:m,showMainStatuses:u,selectedMainStatus:x,handleBackToMainStatuses:p,getSubStatusesForMainStatus:b,clickedStatusOption:y,setClickedStatusOption:f,selectedInterviews:w,selectAll:v,onSelectInterview:j,onSelectAll:N,checkboxVisible:_,scrollTable:C,updateScrollButtons:k,tableScrollRef:S,canScrollLeft:E,canScrollRight:A})=>0===t.length?e.jsx("div",{className:"overflow-x-auto bg-black rounded-lg",children:e.jsx("div",{className:"py-20 text-center text-gray-400 text-lg bg-black",children:e.jsx("p",{className:"text-xl font-semibold",children:"No interviews found"})})}):e.jsx("div",{className:"w-full bg-black",style:{marginLeft:0},children:e.jsxs("div",{className:"relative",children:[E&&e.jsx("button",{onClick:()=>C("left"),className:"absolute left-2 top-1/2 transform -translate-y-1/2 z-50 text-white p-4 rounded-full shadow-lg transition-all duration-200 opacity-20 hover:opacity-100",style:{backgroundColor:"rgba(37, 99, 235, 1)"},onMouseEnter:e=>e.target.style.backgroundColor="rgba(29, 78, 216, 1)",onMouseLeave:e=>e.target.style.backgroundColor="rgba(37, 99, 235, 1)","aria-label":"Scroll left",children:e.jsx(h,{className:"w-9 h-9"})}),A&&e.jsx("button",{onClick:()=>C("right"),className:"absolute right-2 top-1/2 transform -translate-y-1/2 z-50 text-white p-4 rounded-full shadow-lg transition-all duration-200 opacity-20 hover:opacity-100",style:{backgroundColor:"rgba(37, 99, 235, 1)"},onMouseEnter:e=>e.target.style.backgroundColor="rgba(29, 78, 216, 1)",onMouseLeave:e=>e.target.style.backgroundColor="rgba(37, 99, 235, 1)","aria-label":"Scroll right",children:e.jsx(g,{className:"w-9 h-9"})}),e.jsx("div",{ref:S,className:"bg-black rounded-lg overflow-x-auto max-h-[calc(100vh-200px)] overflow-y-auto",onScroll:k,children:e.jsxs("table",{className:"min-w-[2400px] w-full bg-black relative",children:[e.jsx("thead",{className:"bg-white sticky top-0 z-50 shadow-lg border-b-2 border-gray-200",children:e.jsxs("tr",{children:[_&&e.jsx("th",{className:"bg-white px-4 py-3 text-md font-extrabold text-[#03b0f5] uppercase tracking-wider sticky top-0 z-50 shadow-sm border-b border-gray-200",children:e.jsx("input",{type:"checkbox",checked:v,onChange:N,className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"})}),e.jsx("th",{className:"bg-white px-4 py-3 text-md font-extrabold text-[#03b0f5] uppercase tracking-wider sticky top-0 z-50 shadow-sm border-b border-gray-200",children:"#"}),e.jsx("th",{className:"bg-white px-4 py-3 text-md font-extrabold text-[#03b0f5] uppercase tracking-wider sticky top-0 z-50 shadow-sm border-b border-gray-200",children:"Date & Time"}),e.jsx("th",{className:"bg-white px-4 py-3 text-md font-extrabold text-[#03b0f5] uppercase tracking-wider sticky top-0 z-50 shadow-sm border-b border-gray-200",children:"Created By"}),e.jsx("th",{className:"bg-white px-4 py-3 text-md font-extrabold text-[#03b0f5] uppercase tracking-wider sticky top-0 z-50 shadow-sm border-b border-gray-200",children:"Candidate Name"}),e.jsx("th",{className:"bg-white px-4 py-3 text-md font-extrabold text-[#03b0f5] uppercase tracking-wider sticky top-0 z-50 shadow-sm border-b border-gray-200",children:"Status"}),e.jsx("th",{className:"bg-white px-4 py-3 text-md font-extrabold text-[#03b0f5] uppercase tracking-wider sticky top-0 z-50 shadow-sm border-b border-gray-200",children:"Gender"}),e.jsx("th",{className:"bg-white px-4 py-3 text-md font-extrabold text-[#03b0f5] uppercase tracking-wider sticky top-0 z-50 shadow-sm border-b border-gray-200",children:"Qualification"}),e.jsx("th",{className:"bg-white px-4 py-3 text-md font-extrabold text-[#03b0f5] uppercase tracking-wider sticky top-0 z-50 shadow-sm border-b border-gray-200",children:"Job Applied"}),e.jsx("th",{className:"bg-white px-4 py-3 text-md font-extrabold text-[#03b0f5] uppercase tracking-wider sticky top-0 z-50 shadow-sm border-b border-gray-200",children:"Age"}),e.jsx("th",{className:"bg-white px-4 py-3 text-md font-extrabold text-[#03b0f5] uppercase tracking-wider sticky top-0 z-50 shadow-sm border-b border-gray-200",children:"Experience Type"}),e.jsx("th",{className:"bg-white px-4 py-3 text-md font-extrabold text-[#03b0f5] uppercase tracking-wider sticky top-0 z-50 shadow-sm border-b border-gray-200",children:"Source/Portal"}),e.jsx("th",{className:"bg-white px-4 py-3 text-md font-extrabold text-[#03b0f5] uppercase tracking-wider sticky top-0 z-50 shadow-sm border-b border-gray-200",children:"Monthly Salary Offered"}),e.jsx("th",{className:"bg-white px-4 py-3 text-md font-extrabold text-[#03b0f5] uppercase tracking-wider sticky top-0 z-50 shadow-sm border-b border-gray-200",children:"Interview Date"}),e.jsx("th",{className:"bg-white px-4 py-3 text-md font-extrabold text-[#03b0f5] uppercase tracking-wider sticky top-0 z-50 shadow-sm border-b border-gray-200",children:"Interview Time"})]})}),e.jsx("tbody",{className:"bg-black",children:t.map((t,m)=>e.jsxs("tr",{className:"border-b border-gray-800 hover:bg-gray-900/50 transition bg-black cursor-pointer",onClick:()=>s(t),children:[_&&e.jsx("td",{className:"text-md font-semibold py-2 px-4 whitespace-nowrap text-white",onClick:e=>e.stopPropagation(),children:e.jsx("input",{type:"checkbox",checked:w.includes(t._id),onChange:()=>j(t._id),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"})}),e.jsx("td",{className:"text-md font-semibold py-2 px-4 whitespace-nowrap text-white",children:m+1}),e.jsx("td",{className:"text-md font-semibold py-2 px-4 whitespace-nowrap text-white",children:t.created_at?i(t.created_at):"N/A"}),e.jsx("td",{className:"text-md font-semibold py-2 px-4 whitespace-nowrap text-white",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-green-500 to-blue-600 flex items-center justify-center text-white font-bold text-sm",children:t.created_by?t.created_by.charAt(0).toUpperCase():"?"}),e.jsx("span",{className:"text-md",children:t.created_by||"-"})]})}),e.jsx("td",{className:"text-md font-semibold py-2 px-4 whitespace-nowrap text-white",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-sm",children:t.candidate_name?t.candidate_name.charAt(0).toUpperCase():"?"}),e.jsx("div",{children:e.jsx("div",{className:"text-md font-semibold",children:t.candidate_name||"-"})})]})}),e.jsxs("td",{className:"text-md font-semibold py-2 px-4 whitespace-nowrap text-white relative",onClick:e=>e.stopPropagation(),children:[e.jsx("div",{className:"relative status-dropdown-container",children:e.jsxs("button",{className:"bg-gray-800 text-white py-2 px-3 rounded-md border border-gray-600 hover:bg-gray-700 transition-colors w-full min-w-[150px] flex justify-between items-center status-dropdown-button",onClick:e=>r(m,e),children:[e.jsx("div",{className:"font-medium text-white truncate w-full text-sm text-left",children:(()=>{if(t.status&&t.status.includes(":")){const[s,a]=t.status.split(":");return e.jsxs("div",{children:[e.jsx("div",{children:a}),e.jsx("div",{className:"text-xs text-gray-400",children:s.replace("_"," ").toUpperCase()})]})}return t.status?t.status.replace("_"," ").toUpperCase():"Select Status"})()}),e.jsx("svg",{className:"w-5 h-5 transition-transform "+(a===m?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),a===m&&e.jsxs("div",{className:"fixed bg-white border border-gray-300 rounded-lg shadow-xl z-[9999] status-dropdown-menu flex flex-col",style:{top:`${n.top}px`,left:`${n.left}px`,minWidth:"280px",maxWidth:"400px",maxHeight:`${n.maxHeight}px`,backgroundColor:"white",zIndex:9999,overflowY:"hidden"},onClick:e=>{e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},children:[e.jsxs("div",{className:"p-3 border-b border-gray-200 bg-white sticky top-0 z-10 rounded-t-lg",children:[!u&&x&&e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("button",{onClick:e=>{e.stopPropagation(),p()},className:"flex items-center text-blue-600 hover:text-blue-800 text-sm font-medium",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"Back to Main Statuses"]}),e.jsx("span",{className:"text-xs text-gray-600 font-medium",children:x.replace("_"," ").toUpperCase()})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg text-black focus:outline-none focus:border-sky-400",placeholder:u?"Search statuses and sub-statuses...":"Search sub-statuses...",value:l,onChange:e=>o(e.target.value),onClick:e=>e.stopPropagation(),autoFocus:!0})]})]}),e.jsx("div",{className:"overflow-y-auto bg-white rounded-b-lg flex-1",style:{overflowY:"auto",maxHeight:"calc(100% - 80px)",scrollbarWidth:"thin",scrollbarColor:"#888 transparent"},onClick:e=>e.stopPropagation(),children:c().length>0?c().map((s,a)=>{const r="object"==typeof s?s.name:s,n=u&&!l,i=!u||l,o=l,c=b(r).length>0,p=t.status===r||t.status&&t.status.includes(":")&&(t.status.split(":")[0]===r||t.status.split(":")[1]===r),h=n&&!o&&c;return e.jsxs("div",{className:"px-4 py-3 cursor-pointer text-black hover:bg-blue-200 transition-colors border-b border-gray-100 last:border-b-0 text-left "+(y===r?"font-bold shadow-lg":""),style:{backgroundColor:y===r||p?"#FFFF00":"",color:"#000000",fontWeight:p?"bold":"normal"},onClick:e=>{e.stopPropagation(),e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),f(r),setTimeout(()=>{let e=r;i&&x&&!h&&(e=`${x}:${r}`),d(m,e,h),setTimeout(()=>{f(null)},100)},150)},onMouseDown:e=>e.preventDefault(),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm font-medium text-left select-none",children:[r.replace("_"," ").toUpperCase(),i&&x&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Main Status: ",x.replace("_"," ").toUpperCase()]})]}),h&&e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})]}),h&&b(r).length>0&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[b(r).length," sub-status",1!==b(r).length?"es":""]})]},`status-${a}-${r}`)}):e.jsx("div",{className:"px-4 py-6 text-gray-500 text-center text-sm",children:l?e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2",children:['No results found for "',e.jsx("span",{className:"font-semibold text-gray-700",children:l}),'"']}),e.jsx("div",{className:"text-xs text-gray-400",children:"Try searching with different terms or clear the search"})]}):e.jsxs("div",{children:[e.jsx("div",{className:"mb-2",children:"No status options available"}),e.jsx("div",{className:"text-xs text-gray-400",children:"Status data may still be loading..."})]})})})]})]}),e.jsx("td",{className:"text-md font-semibold py-2 px-4 whitespace-nowrap text-white",children:t.gender||"-"}),e.jsx("td",{className:"text-md font-semibold py-2 px-4 whitespace-nowrap text-white",children:t.qualification||"-"}),e.jsx("td",{className:"text-md font-semibold py-2 px-4 whitespace-nowrap text-white",children:t.job_opening||"-"}),e.jsx("td",{className:"text-md font-semibold py-2 px-4 whitespace-nowrap text-white",children:t.age||"-"}),e.jsx("td",{className:"text-md font-semibold py-2 px-4 whitespace-nowrap text-white",children:t.experience_type||"-"}),e.jsx("td",{className:"text-md font-semibold py-2 px-4 whitespace-nowrap text-white",children:t.source_portal||"-"}),e.jsx("td",{className:"text-md font-semibold py-2 px-4 whitespace-nowrap text-white",children:t.monthly_salary_offered||"-"}),e.jsx("td",{className:"text-md font-semibold py-2 px-4 whitespace-nowrap text-white",children:t.interview_date?new Date(t.interview_date).toLocaleDateString():"-"}),e.jsx("td",{className:"text-md font-semibold py-2 px-4 whitespace-nowrap text-white",children:t.interview_time||"-"})]},t._id||m))})]})})]})}),q=({value:s,onChange:a,options:r,placeholder:n="Select option",className:i="",required:l=!1,name:o,disabled:d=!1})=>{const[c,m]=t.useState(!1),[u,x]=t.useState(""),p=t.useRef(null),h=r.filter(e=>e.toLowerCase().includes(u.toLowerCase()));t.useEffect(()=>{const e=e=>{p.current&&!p.current.contains(e.target)&&(m(!1),x(""))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const g=s||n;return e.jsxs("div",{className:"relative",ref:p,children:[e.jsxs("div",{className:`w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold cursor-pointer flex justify-between items-center ${i} ${d?"bg-gray-100 cursor-not-allowed":"bg-white"}`,onClick:()=>!d&&m(!c),children:[e.jsx("span",{className:s?"text-black":"text-gray-500",children:g}),e.jsx("svg",{className:"w-4 h-4 transition-transform "+(c?"transform rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),c&&!d&&e.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-auto",children:[e.jsx("div",{className:"p-2 border-b border-gray-200",children:e.jsx("input",{type:"text",placeholder:"Search options...",value:u,onChange:e=>x(e.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm text-black focus:outline-none focus:ring-2 focus:ring-cyan-500",onClick:e=>e.stopPropagation()})}),e.jsx("div",{className:"max-h-48 overflow-y-auto",children:h.length>0?h.map((t,s)=>e.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-cyan-50 hover:text-cyan-700 text-black",onClick:()=>(e=>{a({target:{name:o,value:e}}),m(!1),x("")})(t),children:t},s)):e.jsx("div",{className:"px-3 py-2 text-gray-500 text-sm",children:"No options found"})})]})]})},$=({onClose:s,onInterviewCreated:a,jobOpeningOptions:n,interviewTypeOptions:i,statusOptions:o,statusOptionsWithSubs:d=[],sourcePortalOptions:c=[],existingInterviews:m=[]})=>{const u=()=>{const e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}T${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`},[x,p]=t.useState({candidate_name:"",mobile_number:"",alternate_number:"",gender:"",qualification:"",job_opening:"",marital_status:"",age:"",city:"",state:"",experience_type:"fresher",total_experience:"",old_salary:"",offer_salary:"",living_arrangement:"",primary_earning_member:"",type_of_business:"",banking_experience:"",interview_type:"",source_portal:"",monthly_salary_offered:"",interview_date:u().split("T")[0],interview_time:u().split("T")[1],date_time:u(),created_by:localStorage.getItem("userName")||localStorage.getItem("user_name")||"User"}),[h,g]=t.useState(!1),[b,y]=t.useState({}),[f,w]=t.useState(!1),[v,j]=t.useState([]),[N,_]=t.useState(""),[C,k]=t.useState(null),[S,E]=t.useState([]);t.useEffect(()=>{(async()=>{try{const e=await l.users.getUsers();e.success&&e.data&&E(e.data)}catch(e){}})()},[]);const A=e=>{const{name:t,value:s}=e.target,a=["mobile_number","alternate_number","total_experience","old_salary","monthly_salary_offered","experience_type","gender","interview_type","status","qualification","marital_status","living_arrangement","primary_earning_member","type_of_business","banking_experience","source_portal","age","interview_date","interview_time","date_time","job_opening"].includes(t)||"string"!=typeof s?s:s.toUpperCase();p(e=>({...e,[t]:a})),b[t]&&y(e=>({...e,[t]:""}))},O=(e,t="w-full px-3 py-2 border rounded text-black font-bold")=>b[e]?`${t} border-red-500 bg-red-50 focus:border-red-500 focus:ring-red-200`:`${t} border-cyan-400 focus:border-cyan-500 focus:ring-cyan-200`,I=async e=>{try{const t=await l.interviews.createInterview(e);alert(`Interview created successfully for ${e.candidate_name}!`),a(t),s()}catch(t){throw alert("Error creating interview: "+t.message),t}finally{g(!1)}};return e.jsxs("div",{className:"bg-transparent bg-opacity-50 fixed inset-0 z-[1000] flex items-center justify-center",children:[e.jsxs("div",{className:"relative bg-white p-6 rounded-xl shadow-2xl w-full max-w-4xl mx-auto space-y-6 max-h-[90vh] overflow-y-auto",children:[e.jsx("button",{className:"absolute right-2 top-2 text-gray-500 hover:text-red-500 transition text-2xl font-bold",onClick:s,"aria-label":"Close",type:"button",children:"Ã—"}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return x.candidate_name?.trim()||(e.candidate_name="Candidate name is required"),x.mobile_number?.trim()?10!==x.mobile_number.trim().length&&(e.mobile_number="Mobile number must be 10 digits"):e.mobile_number="Mobile number is required",x.alternate_number?.trim()&&(x.alternate_number.trim()===x.mobile_number?.trim()?e.alternate_number="Alternate number cannot be same as mobile number":10!==x.alternate_number.trim().length&&(e.alternate_number="Alternate number must be 10 digits")),x.gender||(e.gender="Gender is required"),x.qualification||(e.qualification="Qualification is required"),x.job_opening?.trim()||(e.job_opening="Job opening is required"),x.interview_type||(e.interview_type="Interview type is required"),x.date_time||(e.date_time="Date and time is required"),y(e),0===Object.keys(e).length})()){g(!0);try{const e=JSON.parse(localStorage.getItem("userData")||"{}"),s=e.user_id||localStorage.getItem("userId")||"",a=e.name||e.username||localStorage.getItem("userName")||"User";if(!s)return alert("Please login first"),void g(!1);const r={candidate_name:x.candidate_name,mobile_number:x.mobile_number,gender:x.gender,job_opening:x.job_opening,interview_type:x.interview_type,alternate_number:x.alternate_number||"",city:x.city?.trim()||"Not Specified",state:x.state?.trim()||"Not Specified",qualification:x.qualification||"",experience_type:x.experience_type||"fresher",total_experience:x.total_experience||"",old_salary:x.old_salary?.trim()?parseFloat(x.old_salary):null,offer_salary:x.offer_salary?.trim()?parseFloat(x.offer_salary):null,monthly_salary_offered:x.monthly_salary_offered?.trim()?parseFloat(x.monthly_salary_offered):null,marital_status:x.marital_status||"",age:x.age||"",living_arrangement:x.living_arrangement||"",primary_earning_member:x.primary_earning_member||"",type_of_business:x.type_of_business||"",banking_experience:x.banking_experience||"",interview_date:new Date(x.date_time).toISOString().split("T")[0],interview_time:x.date_time.split("T")[1]||"10:00",date_time:x.date_time,source_portal:x.source_portal||"",status:"new_interview",created_by:a,user_id:s,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()};null===r.old_salary&&delete r.old_salary,null===r.offer_salary&&delete r.offer_salary,null===r.monthly_salary_offered&&delete r.monthly_salary_offered;const n=[x.mobile_number];x.alternate_number?.trim()&&n.push(x.alternate_number.trim());let i=!1,o=[];for(const d of n)try{const e=await l.interviews.checkDuplicatePhone(d);if(e.success&&e.data&&e.data.length>0&&(i=!0,o=[...o,...e.data]),m&&m.length>0){const e=m.filter(e=>{const t=e.mobile_number?.trim(),s=e.alternate_number?.trim(),a=d.trim();return t&&t===a||s&&s===a});e.length>0&&(i=!0,o=[...o,...e])}}catch(t){}if(i&&o.length>0){const e=o.filter((e,t,s)=>t===s.findIndex(t=>(t._id||t.id)===(e._id||e.id)));return k(r),j(e),_(n.join(", ")),w(!0),void g(!1)}await I(r)}catch(t){alert(`Failed to create interview: ${t.message}`),g(!1)}}else alert("Please fill all required fields")},className:"space-y-6",children:[Object.keys(b).length>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("svg",{className:"w-5 h-5 text-red-500 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),e.jsx("h3",{className:"text-red-800 font-bold",children:"Please fix the following errors:"})]}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:Object.entries(b).map(([t,s])=>e.jsxs("li",{className:"text-red-700 text-sm",children:[e.jsxs("span",{className:"font-medium",children:[t.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),":"]})," ",s]},t))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block font-bold text-gray-700 mb-1",children:["Date & Time ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"datetime-local",name:"date_time",value:x.date_time,onChange:A,className:O("date_time"),required:!0}),b.date_time&&e.jsx("p",{className:"text-red-500 text-sm mt-1 font-medium",children:b.date_time})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",children:"Created By"}),e.jsx("input",{type:"text",name:"created_by",value:x.created_by,onChange:A,className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold bg-gray-100",readOnly:!0})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-cyan-500 rounded-full flex items-center justify-center mr-3",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})}),e.jsx("h3",{className:"text-lg font-bold text-cyan-600",children:"Candidate Details"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block font-bold text-gray-700 mb-1",children:["Candidate Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"candidate_name",value:x.candidate_name,onChange:A,className:O("candidate_name"),placeholder:"Enter candidate name",required:!0}),b.candidate_name&&e.jsx("p",{className:"text-red-500 text-sm mt-1 font-medium",children:b.candidate_name})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block font-bold text-gray-700 mb-1",children:["Mobile Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",name:"mobile_number",value:x.mobile_number,onChange:A,className:O("mobile_number"),placeholder:"Enter mobile number",required:!0}),b.mobile_number&&e.jsx("p",{className:"text-red-500 text-sm mt-1 font-medium",children:b.mobile_number})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",children:"Alternate Number"}),e.jsx("input",{type:"tel",name:"alternate_number",value:x.alternate_number,onChange:A,className:O("alternate_number"),placeholder:"Enter alternate number"}),b.alternate_number&&e.jsx("p",{className:"text-red-500 text-sm mt-1 font-medium",children:b.alternate_number})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block font-bold text-gray-700 mb-1",children:["Gender ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(q,{name:"gender",value:x.gender,onChange:A,options:["Male","Female","Other"],placeholder:"Select Gender",className:O("gender"),required:!0}),b.gender&&e.jsx("p",{className:"text-red-500 text-sm mt-1 font-medium",children:b.gender})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block font-bold text-gray-700 mb-1",children:["Qualification ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(q,{name:"qualification",value:x.qualification,onChange:A,options:["BELOW 10TH","10TH PASS","12TH PASS","ITI - INDUSTRIAL TRAINING INSTITUTE","D.ED - DIPLOMA IN EDUCATION","D.PHARM - DIPLOMA IN PHARMACY","GNM / ANM - DIPLOMA IN NURSING","B.A - BACHELOR OF ARTS","B.SC - BACHELOR OF SCIENCE","B.COM - BACHELOR OF COMMERCE","B.E / B.TECH - BACHELOR OF ENGINEERING / TECHNOLOGY","BBA - BACHELOR OF BUSINESS ADMINISTRATION","BCA - BACHELOR OF COMPUTER APPLICATIONS","LLB - BACHELOR OF LAWS","MBBS - BACHELOR OF MEDICINE, BACHELOR OF SURGERY","BDS - BACHELOR OF DENTAL SURGERY","BAMS - BACHELOR OF AYURVEDIC MEDICINE AND SURGERY","BHMS - BACHELOR OF HOMEOPATHIC MEDICINE AND SURGERY","B.PHARM - BACHELOR OF PHARMACY","B.ARCH - BACHELOR OF ARCHITECTURE","B.DES - BACHELOR OF DESIGN","BHM - BACHELOR OF HOTEL MANAGEMENT","B.ED - BACHELOR OF EDUCATION","B.P.ED - BACHELOR OF PHYSICAL EDUCATION","BFA - BACHELOR OF FINE ARTS","M.A - MASTER OF ARTS","M.SC - MASTER OF SCIENCE","M.COM - MASTER OF COMMERCE","M.E / M.TECH - MASTER OF ENGINEERING / TECHNOLOGY","MBA - MASTER OF BUSINESS ADMINISTRATION","PGDM - POST GRADUATE DIPLOMA IN MANAGEMENT","MCA - MASTER OF COMPUTER APPLICATIONS","LLM - MASTER OF LAWS","MD - DOCTOR OF MEDICINE","MS - MASTER OF SURGERY","M.PHARM - MASTER OF PHARMACY","M.ARCH - MASTER OF ARCHITECTURE","M.DES - MASTER OF DESIGN","M.ED - MASTER OF EDUCATION","M.PHIL - MASTER OF PHILOSOPHY","PHD - DOCTOR OF PHILOSOPHY","CA - CHARTERED ACCOUNTANT","CS - COMPANY SECRETARY","CMA - COST AND MANAGEMENT ACCOUNTANT","OTHER QUALIFICATION"],placeholder:"Select Qualification",className:O("qualification"),required:!0}),b.qualification&&e.jsx("p",{className:"text-red-500 text-sm mt-1 font-medium",children:b.qualification})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block font-bold text-gray-700 mb-1",children:["Job Applied ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(q,{name:"job_opening",value:x.job_opening,onChange:A,options:n,placeholder:"Select Job Applied",className:O("job_opening"),required:!0}),b.job_opening&&e.jsx("p",{className:"text-red-500 text-sm mt-1 font-medium",children:b.job_opening})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",children:"Marital Status"}),e.jsx(q,{name:"marital_status",value:x.marital_status,onChange:A,options:["Single","Married","Divorced","Widowed"],placeholder:"Select status",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",children:"Age"}),e.jsx("input",{type:"number",name:"age",value:x.age,onChange:A,className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold",placeholder:"Enter age",min:"18",max:"65"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",children:"City"}),e.jsx("input",{type:"text",name:"city",value:x.city,onChange:A,className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold",placeholder:"Enter city"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",children:"Experience Type"}),e.jsx(q,{name:"experience_type",value:x.experience_type,onChange:A,options:["fresher","experienced"],placeholder:"Select Experience Type",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold"})]})})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-cyan-500 rounded-full flex items-center justify-center mr-3",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.031 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),e.jsx("h3",{className:"text-lg font-bold text-cyan-600",children:"Family & Living Situation"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",children:"Living Arrangement"}),e.jsx(q,{name:"living_arrangement",value:x.living_arrangement,onChange:A,options:["With Family","PG/Hostel","Rented Alone","Shared Apartment","Own House"],placeholder:"Select living arrangement",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",children:"Primary Earning Member"}),e.jsx(q,{name:"primary_earning_member",value:x.primary_earning_member,onChange:A,options:["Father","Mother","Both Parents","Self","Spouse","Sibling","Other"],placeholder:"Select primary earner",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",children:"Type of Business/Work"}),e.jsx(q,{name:"type_of_business",value:x.type_of_business,onChange:A,options:["Salaried Job","Government Job","Private Business","Shop/Retail Business","Manufacturing Business","Service Business","Farming/Agriculture","Professional Practice","Other"],placeholder:"Select work type",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",children:"Banking/Finance Experience"}),e.jsx(q,{name:"banking_experience",value:x.banking_experience,onChange:A,options:["No Experience","Loan Sales","Credit Card Sales","Collection/Recovery","Bank Operations","Insurance Sales","Investment/Mutual Funds","Other Finance"],placeholder:"Select experience",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold"})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-cyan-500 rounded-full flex items-center justify-center mr-3",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z",clipRule:"evenodd"})})}),e.jsx("h3",{className:"text-lg font-bold text-cyan-600",children:"Interview Details"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block font-bold text-gray-700 mb-1",children:["Interview Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(q,{name:"interview_type",value:x.interview_type,onChange:A,options:i,placeholder:"Select Interview Type",className:O("interview_type"),required:!0}),b.interview_type&&e.jsx("p",{className:"text-red-500 text-sm mt-1 font-medium",children:b.interview_type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",children:"Source/Portal"}),e.jsx(q,{name:"source_portal",value:x.source_portal,onChange:A,options:c,placeholder:"Select Source/Portal",className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-bold text-gray-700 mb-1",children:"Monthly Salary Offered"}),e.jsx("input",{type:"number",name:"monthly_salary_offered",value:x.monthly_salary_offered,onChange:A,className:"w-full px-3 py-2 border border-cyan-400 rounded text-black font-bold",placeholder:"Enter monthly salary",step:"0.1"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block font-bold text-gray-700 mb-1",children:["Interview Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",name:"interview_date",value:x.interview_date,onChange:A,className:O("date_time"),required:!0}),b.date_time&&e.jsx("p",{className:"text-red-500 text-sm mt-1 font-medium",children:b.date_time})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block font-bold text-gray-700 mb-1",children:["Interview Time ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"time",name:"interview_time",value:x.interview_time,onChange:A,className:O("date_time"),required:!0})]})]})]}),e.jsxs("div",{className:"flex gap-4 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 px-6 py-3 bg-gray-500 text-white font-bold rounded shadow-md hover:bg-gray-600 transition-colors duration-200",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:h,className:r("flex-1 px-6 py-3 bg-cyan-500 text-white font-bold rounded shadow-md transition-colors duration-200",h?"opacity-50 cursor-not-allowed bg-cyan-400":"hover:bg-cyan-600"),children:h?"Creating Interview...":"Create Interview"})]})]})]}),e.jsx(B,{visible:f,onClose:()=>{w(!1),k(null),j([]),_(""),g(!1)},duplicateInterviews:v,phoneNumber:N,onProceed:async()=>{if(C){w(!1);try{await I(C)}catch(e){alert(`Failed to create interview: ${e.message}`)}k(null),j([]),_("")}},onCloseCreateModal:s})]})};export{U as default};
