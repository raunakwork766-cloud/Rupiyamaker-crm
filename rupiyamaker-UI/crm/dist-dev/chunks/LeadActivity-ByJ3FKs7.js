import{j as e}from"./vendor-mui-C1GmDdcn.js";import{r as s}from"./vendor-react-EzoxUMNY.js";import{A as a,F as t,t as i,U as d}from"./lead-components-DjdRUJ-t.js";import"./vendor-utils-QXd9EeNt.js";import"./vendor-antd-BB3a0mYC.js";function l({leadId:l,userId:n,leadData:r,formatDate:c}){const[o,m]=s.useState([]),[u,p]=s.useState(!1),[_,h]=s.useState(""),[g,x]=s.useState("all"),[y,f]=s.useState(""),b=()=>{if(n)return String(n);const e=localStorage.getItem("userId")||localStorage.getItem("user_id");if(e)return String(e);try{const e=localStorage.getItem("user");if(e){const s=JSON.parse(e);if(s._id)return String(s._id);if(s.id)return String(s.id)}}catch(s){}return null},j=()=>l?String(l):r?._id?String(r._id):r?.id?String(r.id):null,N=j(),v=b();s.useEffect(()=>{N?v?k():h("User ID is missing"):h("Lead ID is missing")},[N,v]);const k=async()=>{const e=j(),s=b();if(e)if(s)try{p(!0),h("");const a=localStorage.getItem("token"),t=r&&(r.original_lead_id||r.login_created_at)?`/api/lead-login/login-leads/${e}/activities?user_id=${s}`:`/api/leads/${e}/activities?user_id=${s}`,i=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json",...a&&{Authorization:`Bearer ${a}`}}});if(i.ok){let s=await i.json();if(r&&(!s||!s.some(e=>"create"===e.activity_type||"created"===e.activity_type||"create"===e.action||"created"===e.action))){const a={_id:`synthetic_${e}_created`,activity_type:"create",user_name:r.created_by_name||r.createdByName||"System",created_at:r.created_at||r.createdAt||r.lead_date||(new Date).toISOString(),description:`Lead created by ${r.created_by_name||r.createdByName||"System"}`,details:{customer_name:r.customer_name||r.customerName,mobile_number:r.mobile_number||r.mobileNumber}};s=[...s||[],a]}m(s||[])}else{const e=`Failed to load activities (Status: ${i.status})`;h(e)}}catch(a){const e=`Failed to load activities: ${a.message}`;h(e)}finally{p(!1)}else h("User ID is missing");else h("Lead ID is missing")},S=e=>{switch(e){case"create":case"created":return"ðŸŽ¯";case"update":case"updated":return"âœï¸";case"field_update":case"login_form_updated":case"file_sent_to_login":return"ðŸ“";case"status_changed":case"status_change":return"ðŸ”„";case"sub_status_change":case"transfer":case"transferred":return"ðŸ”€";case"assignment":case"assigned":return"ðŸ‘¤";case"remark_added":case"note":return"ðŸ’¬";case"attachment_uploaded":case"document":return"ðŸ“Ž";case"question_validation":return"â“";case"task_added":return"âœ…";case"task_updated":default:return"ðŸ“‹";case"task_completed":return"ðŸŽ‰"}},w=e=>{switch(e){case"create":case"created":return"border-green-500 bg-green-900/20";case"update":case"updated":return"border-blue-500 bg-blue-900/20";case"field_update":case"document":case"attachment_uploaded":return"border-indigo-500 bg-indigo-900/20";case"status_changed":case"status_change":return"border-purple-500 bg-purple-900/20";case"sub_status_change":return"border-violet-500 bg-violet-900/20";case"assignment":case"assigned":return"border-yellow-500 bg-yellow-900/20";case"transfer":case"transferred":return"border-orange-500 bg-orange-900/20";case"note":case"remark_added":return"border-cyan-500 bg-cyan-900/20";case"question_validation":return"border-rose-500 bg-rose-900/20";case"task_added":case"task_updated":return"border-emerald-500 bg-emerald-900/20";case"task_completed":return"border-pink-500 bg-pink-900/20";case"login_form_updated":case"file_sent_to_login":return"border-amber-500 bg-amber-900/20";default:return"border-gray-500 bg-gray-900/20"}},$=e=>{const s=e.action||e.activity_type;switch(s){case"create":case"created":return`Lead created by ${e.user_name||"System"}`;case"update":case"updated":return`Lead details updated by ${e.user_name||"System"}`;case"field_update":return e.details?.field_display_name||e.details?.field_name||"Field updated";case"status_changed":case"status_change":return`Status changed from "${e.details?.from_status||e.details?.old_status||"N/A"}" to "${e.details?.to_status||e.details?.new_status||"N/A"}" by ${e.user_name||"System"}`;case"sub_status_change":return`Sub-status changed from "${e.details?.from_sub_status||"N/A"}" to "${e.details?.to_sub_status||"N/A"}" by ${e.user_name||"System"}`;case"assignment":case"assigned":return e.details?.from_user_name&&e.details?.to_user_name?`Lead assigned from ${e.details.from_user_name} to ${e.details.to_user_name}`:`Lead assigned to ${e.details?.assigned_to_name||e.details?.to_user_name||"Unknown"} by ${e.user_name||"System"}`;case"note":case"remark_added":return`Note added by ${e.user_name||"System"}`;case"document":case"attachment_uploaded":let a="Unknown";return e.details?.filename?a=e.details.filename:e.details?.document_name?a=e.details.document_name:e.description&&e.description.includes("Document uploaded:")?a=e.description.replace("Document uploaded:","").trim():e.description&&(a=e.description),`Document "${a}" uploaded by ${e.user_name||"System"}`;case"question_validation":const t=e.details?.questions_validated||1;return`${t} important question${t>1?"s":""} validated by ${e.user_name||"System"}`;case"task_added":return`Task "${e.details?.task_title||e.details?.title||"Unknown"}" added by ${e.user_name||"System"}`;case"task_completed":return`Task "${e.details?.task_title||e.details?.title||"Unknown"}" completed by ${e.user_name||"System"}`;case"task_updated":return`Task "${e.details?.task_title||e.details?.title||"Unknown"}" updated by ${e.user_name||"System"}`;case"login_form_updated":case"file_sent_to_login":return`File sent to login by ${e.user_name||"System"}`;case"transfer":case"transferred":return`Lead transferred to ${e.details?.department||e.details?.to_department_name||"Unknown Department"} by ${e.user_name||"System"}`;default:return e.description||`${s} by ${e.user_name||"System"}`}},D=[{value:"all",label:"All Activities"},{value:"created",label:"Created"},{value:"updated",label:"Updated"},{value:"field_update",label:"Field Changes"},{value:"status_changed",label:"Status Changes"},{value:"sub_status_change",label:"Sub-Status Changes"},{value:"assigned",label:"Assignments"},{value:"note",label:"Notes"},{value:"document",label:"Documents"},{value:"question_validation",label:"Question Validation"}],A=(e=>e&&0!==e.length?e.reduce((e,s)=>{try{const a=s.created_at||s.createdAt||s.timestamp;if(!a)return e;const t=new Date(a);if(isNaN(t.getTime()))return e;const i=t.toLocaleDateString("en-IN",{day:"2-digit",month:"long",year:"numeric"});e[i]||(e[i]={});const d=t.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0});e[i][d]||(e[i][d]=[]),e[i][d].push(s)}catch(_){}return e},{}):{})(o.filter(e=>{if("all"!==g){const s=e.action||e.activity_type;if(g!==s){let a=!1;switch(g){case"created":a="created"===s||"create"===s;break;case"updated":a="updated"===s||"update"===s;break;case"field_update":a="field_update"===s;break;case"assigned":a="assigned"===s||"assignment"===s;break;case"transferred":a="transferred"===s||"transfer"===s;break;case"status_changed":a="status_changed"===s||"status_change"===s||"sub_status_change"===s;break;case"document":a="document"===s||"attachment_uploaded"===s||e.description&&e.description.toLowerCase().includes("document uploaded");break;case"note":a="note"===s||"remark_added"===s||e.details&&e.details.note_text;break;case"task_added":a="task_added"===s||"task"===s&&e.description&&e.description.includes("added");break;case"task_completed":a="task_completed"===s||"task"===s&&e.description&&e.description.includes("completed");break;case"task_updated":a="task_updated"===s||"task"===s&&e.description&&e.description.includes("updated");break;case"file_sent_to_login":a="file_sent_to_login"===s||"login_form_updated"===s;break;case"question_validation":a="question_validation"===s;break;case"sub_status_change":a="sub_status_change"===s;break;default:a=!1}if(!a)return!1}}if(y.trim()){const s=y.toLowerCase();return(e.details?.field_display_name||e.details?.field_name||e.description||"").toLowerCase().includes(s)}return!0}));return u?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"space-y-4 bg-white p-4 rounded-lg overflow-x-hidden break-words",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[e.jsxs("h3",{className:"text-xl font-semibold text-black flex items-center",children:[e.jsx(a,{className:"w-6 h-6 mr-2"}),"Activities Timeline"]}),e.jsxs("div",{className:"flex items-center space-x-2 flex-wrap gap-2",children:[e.jsx(t,{className:"w-4 h-4 text-gray-600"}),e.jsx("select",{value:g,onChange:e=>x(e.target.value),className:"bg-gray-100 border border-gray-300 rounded-lg px-3 py-1 text-black text-sm focus:outline-none focus:border-blue-500",children:D.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(i,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by field name...",value:y,onChange:e=>f(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-50 border border-gray-300 rounded-lg text-sm text-black placeholder-gray-500 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"}),y&&e.jsx("button",{onClick:()=>f(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:"âœ•"})]}),_&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg",children:[e.jsx("div",{className:"font-bold mb-2",children:"âš ï¸ Error Loading Activities"}),e.jsx("div",{className:"mb-2",children:_}),e.jsxs("div",{className:"text-sm mt-3 bg-red-50 p-3 rounded border-l-4 border-red-600",children:[e.jsx("div",{className:"font-semibold mb-1",children:"Debug Information:"}),e.jsxs("div",{className:"space-y-1 font-mono text-xs",children:[e.jsxs("div",{children:["Lead ID (prop): ",l||"undefined"]}),e.jsxs("div",{children:["User ID (prop): ",n||"undefined"]}),e.jsxs("div",{children:["Resolved Lead ID: ",N||"undefined"]}),e.jsxs("div",{children:["Resolved User ID: ",v||"undefined"]}),e.jsxs("div",{children:["Lead Data: ",r?"Present":"Missing"]}),e.jsxs("div",{className:"mt-2 pt-2 border-t border-red-300",children:[e.jsxs("div",{children:["localStorage.userId: ",localStorage.getItem("userId")||"undefined"]}),e.jsxs("div",{children:["localStorage.user_id: ",localStorage.getItem("user_id")||"undefined"]})]})]}),e.jsx("button",{onClick:()=>{k()},className:"mt-2 bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm",children:"Retry Loading Activities"})]})]}),e.jsx("div",{className:"space-y-6 max-h-[calc(100vh-300px)] overflow-y-auto overflow-x-hidden pr-2 break-words",children:0===Object.keys(A).length?e.jsxs("div",{className:"text-center py-8 text-gray-600",children:[e.jsx(a,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"all"===g?"No activities yet.":`No ${D.find(e=>e.value===g)?.label.toLowerCase()||g} activities.`})]}):Object.entries(A).sort((e,s)=>new Date(s[0])-new Date(e[0])).map(([s,a])=>e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-medium text-black border-b border-gray-300 pb-2",children:s}),e.jsx("div",{className:"relative",children:Object.entries(a).sort((e,s)=>new Date(s[1][0].created_at)-new Date(e[1][0].created_at)).map(([s,a],t,i)=>(a[0].action||a[0].activity_type,e.jsxs("div",{className:"relative flex items-start space-x-4 pb-4",children:[e.jsxs("div",{className:"w-24 flex-shrink-0 text-right",children:[e.jsx("div",{className:"text-sm text-gray-600",children:s}),e.jsxs("div",{className:"relative flex justify-end",children:[(()=>{const s=a[0].action||a[0].activity_type;return e.jsx("div",{className:`z-10 w-6 h-6 rounded-full border-2 ${w(s)} flex items-center justify-center mt-2`,children:e.jsx("span",{className:"text-sm",children:S(s)})})})(),t!==i.length-1&&e.jsx("div",{className:"absolute top-8 right-2.5 w-0.5 h-full bg-gray-300"})]})]}),e.jsx("div",{className:"flex-1 space-y-2",children:a.map((s,a)=>e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-black",children:$(s)}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center",children:[e.jsx(d,{className:"w-3 h-3 mr-1"}),s.user_name||"System"]})]}),("field_update"===s.action||"field_update"===s.activity_type)&&s.details&&e.jsx("div",{className:"text-sm mt-2",children:"check_eligibility"!==s.details.field_name&&"Check Eligibility"!==s.description||!s.details.old_value?.includes("\n")&&!s.details.new_value?.includes("\n")?e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-blue-600",children:"FROM:"}),e.jsx("span",{className:"ml-2 "+(s.details.old_value?"text-red-600":"text-gray-400"),children:s.details.old_value||"Empty"}),e.jsx("span",{className:"mx-2",children:"â†’"}),e.jsx("span",{className:"font-medium text-blue-600",children:"TO:"}),e.jsx("span",{className:"ml-2 text-green-600",children:s.details.new_value})]}):e.jsx("div",{className:"space-y-2",children:(()=>{const a=s.details.old_value?.split("\n")||[],t=s.details.new_value?.split("\n")||[],i=Math.max(a.length,t.length);return Array.from({length:i}).map((s,i)=>{const d=a[i]||"",l=t[i]||"",n=e=>e.split(":")[0]?.trim()||"",r=n(l)||n(d);return d||l?e.jsxs("div",{className:"border-l-2 border-blue-300 pl-3 py-1",children:[e.jsx("div",{className:"font-medium text-gray-700 text-xs mb-1",children:r}),e.jsxs("div",{className:"flex items-center flex-wrap gap-2",children:[e.jsx("span",{className:"font-medium text-blue-600",children:"FROM:"}),e.jsx("span",{className:d?"text-red-600":"text-gray-400",children:d.split(":")[1]?.trim()||"Empty"}),e.jsx("span",{children:"â†’"}),e.jsx("span",{className:"font-medium text-blue-600",children:"TO:"}),e.jsx("span",{className:"text-green-600",children:l.split(":")[1]?.trim()||"Empty"})]})]},i):null})})()})}),!("field_update"===s.action||"field_update"===s.activity_type)&&s.details&&Object.keys(s.details).length>0&&e.jsxs("div",{className:"text-sm text-gray-600 mt-2",children:[s.details.comment&&e.jsxs("p",{className:"italic",children:['"',s.details.comment,'"']}),s.details.note_text&&e.jsxs("p",{className:"italic",children:['"',s.details.note_text,'"']}),("document"===s.action||"document"===s.activity_type||"attachment_uploaded"===s.action||"attachment_uploaded"===s.activity_type)&&e.jsx("div",{className:"mt-2 bg-gray-100 p-2 rounded-md",children:e.jsxs("ul",{className:"list-disc list-inside ml-1 space-y-1",children:[s.description&&s.description.includes("Document uploaded:")&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"File:"})," ",s.description.replace("Document uploaded:","").trim()]}),s.details.filename&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"File:"})," ",s.details.filename]}),s.details.document_name&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Document:"})," ",s.details.document_name]}),s.details.document_id&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Document ID:"})," ",s.details.document_id]}),s.details.document_type&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Type:"})," ",s.details.document_type]}),s.details.category&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Category:"})," ",s.details.category]}),s.details.file_size&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Size:"})," ",s.details.file_size]})]})}),("task_added"===s.action||"task_added"===s.activity_type||"task_updated"===s.action||"task_updated"===s.activity_type||"task_completed"===s.action||"task_completed"===s.activity_type)&&e.jsx("div",{className:"mt-2 bg-gray-100 p-2 rounded-md",children:e.jsxs("ul",{className:"list-disc list-inside ml-1 space-y-1",children:[s.details.task_title&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Task:"})," ",s.details.task_title]}),s.details.title&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Task:"})," ",s.details.title]}),s.details.description&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Description:"})," ",s.details.description]}),s.details.due_date&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Due Date:"})," ",new Date(s.details.due_date).toLocaleDateString()]}),s.details.priority&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Priority:"})," ",s.details.priority]}),s.details.status&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Status:"})," ",s.details.status]})]})}),("assigned"===s.action||"assigned"===s.activity_type||"assignment"===s.action||"assignment"===s.activity_type)&&e.jsx("div",{className:"mt-2 bg-gray-100 p-2 rounded-md",children:e.jsxs("ul",{className:"list-disc list-inside ml-1 space-y-1",children:[s.details.assigned_to_name&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Assigned To:"})," ",s.details.assigned_to_name]}),s.details.from_user_name&&s.details.to_user_name&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Reassigned:"})," From ",s.details.from_user_name," to ",s.details.to_user_name]})]})}),("transferred"===s.action||"transferred"===s.activity_type||"transfer"===s.action||"transfer"===s.activity_type)&&e.jsx("div",{className:"mt-2 bg-gray-100 p-2 rounded-md",children:e.jsxs("ul",{className:"list-disc list-inside ml-1 space-y-1",children:[s.details.to_department_name&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Department:"})," ",s.details.to_department_name]}),s.details.from_department_name&&s.details.to_department_name&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Transferred:"})," From ",s.details.from_department_name," to ",s.details.to_department_name]}),s.details.reason&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Reason:"})," ",s.details.reason]})]})}),("login_form_updated"===s.action||"login_form_updated"===s.activity_type||"file_sent_to_login"===s.action||"file_sent_to_login"===s.activity_type)&&e.jsx("div",{className:"mt-2 bg-gray-100 p-2 rounded-md",children:e.jsxs("ul",{className:"list-disc list-inside ml-1 space-y-1",children:[s.details.form_type&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Form Type:"})," ",s.details.form_type]}),s.details.login_status&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Status:"})," ",s.details.login_status]})]})}),("status_changed"===s.action||"status_change"===s.activity_type||"sub_status_change"===s.activity_type)&&e.jsx("div",{className:"mt-2 bg-gray-100 p-2 rounded-md",children:e.jsxs("ul",{className:"list-disc list-inside ml-1 space-y-1",children:["status_change"===s.activity_type&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Status:"}),e.jsx("span",{className:"text-red-600 mx-1",children:s.details?.from_status||"N/A"}),e.jsx("span",{className:"mx-1",children:"â†’"}),e.jsx("span",{className:"text-green-600",children:s.details?.to_status||"N/A"})]}),"sub_status_change"===s.activity_type&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Sub-Status:"}),e.jsx("span",{className:"text-red-600 mx-1",children:s.details?.from_sub_status||"N/A"}),e.jsx("span",{className:"mx-1",children:"â†’"}),e.jsx("span",{className:"text-green-600",children:s.details?.to_sub_status||"N/A"})]}),s.details?.reason&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Reason:"})," ",s.details.reason]})]})}),"question_validation"===s.activity_type&&e.jsx("div",{className:"mt-2 bg-gray-100 p-2 rounded-md",children:e.jsxs("ul",{className:"list-disc list-inside ml-1 space-y-1",children:[s.details?.questions_validated&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Questions Validated:"})," ",s.details.questions_validated]}),s.details?.auto_validated&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Auto Validated:"})," ",s.details.auto_validated?"Yes":"No"]}),s.details?.question_ids&&Array.isArray(s.details.question_ids)&&e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"font-medium",children:"Question IDs:"})," ",s.details.question_ids.length," question(s)"]})]})}),!["document","attachment_uploaded","task_added","task_updated","task_completed","assigned","assignment","transferred","transfer","login_form_updated","file_sent_to_login","status_changed","status_change","sub_status_change","question_validation","updated","update","note","remark_added"].includes(s.action||s.activity_type)&&s.details&&Object.keys(s.details).length>0&&!s.details.changes&&!s.details.comment&&!s.details.note_text&&e.jsx("div",{className:"mt-2 bg-gray-100 p-2 rounded-md",children:e.jsx("ul",{className:"list-disc list-inside ml-1 space-y-1",children:Object.entries(s.details).map(([s,a],t)=>{if(null==a||"object"==typeof a&&0===Object.keys(a).length)return null;if(s.toLowerCase().includes("_id")||s.toLowerCase().includes("id")||"assigned_to"===s||"department"===s||"note_id"===s)return null;const i=s.replace(/_/g," ").replace(/([A-Z])/g," $1").replace(/\s+/g," ").trim();let d=a;return"object"!=typeof a||Array.isArray(a)?Array.isArray(a)&&(d=a.join(", ")):d=JSON.stringify(a).replace(/[{}"]/g,"").replace(/,/g,", "),e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"capitalize font-medium",children:i}),":Â ",e.jsx("span",{children:String(d)})]},t)})})}),("updated"===s.action||"update"===s.activity_type)&&s.details.changes&&Object.keys(s.details.changes).length>0&&e.jsxs("div",{className:"mt-2 bg-gray-100 p-2 rounded-md",children:[e.jsx("strong",{className:"block mb-1 text-gray-700",children:"Changes:"}),e.jsx("ul",{className:"list-disc list-inside ml-1 space-y-1",children:(()=>{const a=[],t=(e,s=[])=>{e&&"object"==typeof e&&Object.entries(e).forEach(([e,i])=>{const d=[...s,e];if(i&&"object"==typeof i&&"from"in i&&"to"in i){const e=i.from,s=i.to;if(JSON.stringify(e)===JSON.stringify(s))return;const t=e=>null==e?"None":Array.isArray(e)?0===e.length?"None":e.every(e=>"object"!=typeof e||null===e)?e.join(", "):`${e.length} items`:"object"==typeof e?0===Object.keys(e).length?"None":JSON.stringify(e).replace(/[{}"]/g,"").replace(/,/g,", "):String(e),l=t(e),n=t(s);if(l!==n){const e=d[d.length-1].replace(/_/g," ").replace(/([A-Z])/g," $1").replace(/\s+/g," ").trim(),s=e.toLowerCase().includes("status")||e.toLowerCase().includes("eligibility");a.push({field:e,from:l,to:n,isStatusField:s,fullPath:d.join(".")})}}else i&&"object"==typeof i&&!Array.isArray(i)&&t(i,d)})};t(s.details.changes);const i=[...a].sort((e,s)=>{const a=e.fullPath.split(".")[0],t=s.fullPath.split(".")[0];return a!==t?a.localeCompare(t):e.isStatusField&&!s.isStatusField?-1:!e.isStatusField&&s.isStatusField?1:e.field.localeCompare(s.field)});return 0===i.length?null:i.map((s,a)=>e.jsxs("li",{className:"py-1",children:[e.jsx("span",{className:"capitalize font-medium",children:s.field}),":Â ",s.isStatusField?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-red-600",children:s.from}),e.jsx("span",{className:"mx-1",children:"â†’"}),e.jsx("span",{className:"text-green-600",children:s.to})]}):e.jsx("span",{className:"text-green-600",children:s.to})]},a))})()})]})]})]},s._id||a))})]},s)))})]},s))})]})}export{l as default};
